<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.21">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ARIMAX, SARIMAX, and VAR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assets/gu-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea1d7ac60288e0f1efdbc993fd8432ae.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-870b6070356b2f6ba798b4fc2bd491a6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>

<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>

<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>



</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./source.html"> 
<span class="menu-text">Data Sources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./visualization.html"> 
<span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./EDA.html"> 
<span class="menu-text">Exploratory Data Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./univariate.html"> 
<span class="menu-text">Univariate TS Models (ARIMA/SARIMA)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./multivariate.html" aria-current="page"> 
<span class="menu-text">Multivariate TS Models (ARIMAX/SARIMAX/VAR)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./financial.html"> 
<span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DL.html"> 
<span class="menu-text">Deep Learning for TS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./other.html"> 
<span class="menu-text">Other-Interrupted TS/ARFIMA/Spectral Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusion.html"> 
<span class="menu-text">Conclusions</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link active" data-scroll-target="#literature-review">Literature Review</a>
  <ul class="collapse">
  <li><a href="#drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy" id="toc-drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy" class="nav-link" data-scroll-target="#drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy">1. Drivers of Energy Transition – The Tripartite Effect of Price, Climate, and Policy</a></li>
  <li><a href="#price-outputinvestment-transmission-mechanism-substitution-and-demand-channels" id="toc-price-outputinvestment-transmission-mechanism-substitution-and-demand-channels" class="nav-link" data-scroll-target="#price-outputinvestment-transmission-mechanism-substitution-and-demand-channels">2. Price-Output/Investment Transmission Mechanism (Substitution and Demand Channels)</a></li>
  <li><a href="#application-of-time-series-and-multivariate-methods-in-energy-research" id="toc-application-of-time-series-and-multivariate-methods-in-energy-research" class="nav-link" data-scroll-target="#application-of-time-series-and-multivariate-methods-in-energy-research">3. Application of Time Series and Multivariate Methods in Energy Research</a></li>
  <li><a href="#financial-market-perspective-etfs-and-energy-transition-signals" id="toc-financial-market-perspective-etfs-and-energy-transition-signals" class="nav-link" data-scroll-target="#financial-market-perspective-etfs-and-energy-transition-signals">4. Financial Market Perspective: ETFs and Energy Transition Signals</a></li>
  </ul></li>
  <li><a href="#key-research-questions" id="toc-key-research-questions" class="nav-link" data-scroll-target="#key-research-questions">Key Research Questions</a></li>
  <li><a href="#arimax-solar-power-generation-temperature-oil-prices-gas-prices" id="toc-arimax-solar-power-generation-temperature-oil-prices-gas-prices" class="nav-link" data-scroll-target="#arimax-solar-power-generation-temperature-oil-prices-gas-prices">(1) ARIMAX: Solar power generation ~ temperature + oil prices + gas prices</a></li>
  <li><a href="#arimax-icln-xle-oil-prices-gas-prices" id="toc-arimax-icln-xle-oil-prices-gas-prices" class="nav-link" data-scroll-target="#arimax-icln-xle-oil-prices-gas-prices">(2) ARIMAX: ICLN ~ XLE + oil prices + gas prices</a></li>
  <li><a href="#var-the-dynamic-relationship-between-clean-and-traditional-energy" id="toc-var-the-dynamic-relationship-between-clean-and-traditional-energy" class="nav-link" data-scroll-target="#var-the-dynamic-relationship-between-clean-and-traditional-energy">(3) VAR: The dynamic relationship between clean and traditional energy</a></li>
  <li><a href="#var-energy-price-linkages-at-the-financial-market-level" id="toc-var-energy-price-linkages-at-the-financial-market-level" class="nav-link" data-scroll-target="#var-energy-price-linkages-at-the-financial-market-level">(4) VAR: Energy price linkages at the financial market level</a></li>
  <li><a href="#arimax-natural-gas-temperature-hh-wti" id="toc-arimax-natural-gas-temperature-hh-wti" class="nav-link" data-scroll-target="#arimax-natural-gas-temperature-hh-wti">(5) ARIMAX: Natural gas ~ temperature + HH + WTI</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ARIMAX, SARIMAX, and VAR</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review">Literature Review</h2>
<section id="drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy" class="level3">
<h3 class="anchored" data-anchor-id="drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy">1. Drivers of Energy Transition – The Tripartite Effect of Price, Climate, and Policy</h3>
<p>Energy transition is both a result of technological evolution and a dynamic process driven by the combined effects of economics, climate, and policy. Numerous studies have shown that fossil fuel prices (such as crude oil and natural gas) have a significant impact on the development of renewable energy: when oil or natural gas prices rise, the relative cost of fossil fuels increases, enhancing the relative competitiveness of clean energy, thereby driving growth in renewable power generation or related investment. Simultaneously, climate and weather variables (temperature, irradiance, degree-days) directly affect the short-term output of renewable power generation: solar power is affected by solar irradiance and temperature (high temperatures may slightly reduce photovoltaic efficiency), while wind power is affected by seasonal wind speeds and extreme weather. Finally, policy (subsidies, feed-in tariffs, carbon prices) is a structural driver: policy shocks typically produce lasting trend changes or step responses.</p>
</section>
<section id="price-outputinvestment-transmission-mechanism-substitution-and-demand-channels" class="level3">
<h3 class="anchored" data-anchor-id="price-outputinvestment-transmission-mechanism-substitution-and-demand-channels">2. Price-Output/Investment Transmission Mechanism (Substitution and Demand Channels)</h3>
<p>Literature divides price transmission into supply-side and demand-side mechanisms: Price increases make renewable energy more attractive by raising the cost of fossil fuel power generation (or the marginal cost of fuel power generation) (substitution effect); another channel is the financial market: oil and gas prices affect the earnings and stock performance of related energy companies, which in turn affects ETFs or capital flows (ICLE, XLE, etc.). These financial variables then feed back into investment and project construction decisions.</p>
</section>
<section id="application-of-time-series-and-multivariate-methods-in-energy-research" class="level3">
<h3 class="anchored" data-anchor-id="application-of-time-series-and-multivariate-methods-in-energy-research">3. Application of Time Series and Multivariate Methods in Energy Research</h3>
<p>In empirical methods, researchers widely use ARIMAX/SARIMAX (modeling a single response variable under exogenous shocks) to characterize the short-term impact of exogenous variables such as weather/prices on power generation or prices; while VAR/VECM/VARMA are used to study the dynamic interactions between several endogenous variables (e.g., how wind, solar, natural gas, and coal power generation interact), and to conduct impact response analysis (IRFs) and variance decomposition to identify shock sources and propagation paths. Model selection typically considers the seasonality, trend, and cointegration of time series data.</p>
</section>
<section id="financial-market-perspective-etfs-and-energy-transition-signals" class="level3">
<h3 class="anchored" data-anchor-id="financial-market-perspective-etfs-and-energy-transition-signals">4. Financial Market Perspective: ETFs and Energy Transition Signals</h3>
<p>ETFs (such as clean energy ETFs vs.&nbsp;traditional energy ETFs) are often used as market signals for the energy transition. Empirical research shows that energy ETFs are sensitive to oil and gas prices, macroeconomic and policy news, and can reflect investors’ expectations for the transition prospects. Therefore, using ETFs as financial indicators can supplement the dimension of market expectations that cannot be directly captured by physical electricity generation sequences.</p>
</section>
</section>
<section id="key-research-questions" class="level2">
<h2 class="anchored" data-anchor-id="key-research-questions">Key Research Questions</h2>
<ol type="1">
<li><strong>Does the price of fossil fuels drive the growth of solar power generation through substitution effects?</strong>
<ul>
<li>What are the immediate or lagged responses of solar power if WTI or HH rises? (Examine the β parameter and impulse response)</li>
</ul></li>
<li><strong>What are the short-term and seasonal effects of weather variables (temp or degree-days) on solar output? Are there nonlinearities (e.g., excessively high temperatures reduce efficiency)?</strong>
<ul>
<li>It is necessary to examine the linear/quadratic terms of temp, as well as the seasonal interaction term.</li>
</ul></li>
<li><strong>Are there substitution or complementarity relationships in the power generation structure (wind, solar, coal, natural gas)? How do shocks (e.g., rising natural gas prices) propagate between different energy sources?</strong>
<ul>
<li>VAR can be used to obtain the impulse response function (IRF) and variance decomposition to answer these questions.</li>
</ul></li>
<li><strong>How do financial markets (ICLE vs XLE) reflect expectations of energy transition? Are these ETFs leading/lagging relationships with actual power generation data or fuel prices?</strong>
<ul>
<li>VAR can be used to test Granger causality and interaction.</li>
</ul></li>
<li><strong>Have policies or structural events altered the long-term relationships between energy variables (e.g., trend abrupt changes or changes in cointegration structures)?</strong>
<ul>
<li>Examine structural breakpoints and incorporate policy dummy variables to quantify policy effects.</li>
</ul></li>
<li><strong>Forecasting: How does the ARIMAX model perform in short-term solar forecasting, considering the uncertainty of exogenous variables? Is it a significant improvement compared to using an autoregressive model alone?</strong></li>
</ol>
<ul>
<li>Test model stability using time series cross-validation (tsCV) and RMSE comparisons.</li>
</ul>
</section>
<section id="arimax-solar-power-generation-temperature-oil-prices-gas-prices" class="level2">
<h2 class="anchored" data-anchor-id="arimax-solar-power-generation-temperature-oil-prices-gas-prices">(1) ARIMAX: Solar power generation ~ temperature + oil prices + gas prices</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seasonal)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prophet)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fma)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/electric.csv"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">str_extract</span>(Description, <span class="st">"(?&lt;=From ).*?(?=,)"</span>),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>solar_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Solar"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Solar =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Solar =</span> <span class="fu">log</span>(<span class="fu">pmax</span>(Solar, .Machine<span class="sc">$</span>double.eps))) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>ts_solar <span class="ot">&lt;-</span> <span class="fu">ts</span>(solar_df<span class="sc">$</span>Solar,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(solar_df<span class="sc">$</span>Year), <span class="fu">min</span>(solar_df<span class="sc">$</span>Month)),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/WTIprice.csv"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> wti <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> observation_date) <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2000-01-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-12-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">WTI =</span> POILWTIUSDM) <span class="sc">%&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WTI =</span> <span class="fu">as.numeric</span>(WTI))<span class="sc">%&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>ts_wti <span class="ot">&lt;-</span> <span class="fu">ts</span>(wti<span class="sc">$</span>WTI,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/naturalgasprice.csv"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> df_n <span class="sc">%&gt;%</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">log</span>(<span class="fu">pmax</span>(HH, .Machine<span class="sc">$</span>double.eps))) <span class="sc">%&gt;%</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>ts_np <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_n<span class="sc">$</span>HH,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(df_n<span class="sc">$</span>Year), <span class="fu">min</span>(df_n<span class="sc">$</span>Month)),</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/Global_Temperature_2000onwards.csv"</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="fu">order</span>(df<span class="sc">$</span>Year, df<span class="sc">$</span>Month), ]</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>df_temp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>ts_anomaly <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_temp<span class="sc">$</span>Monthly_Anomaly,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>),   </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">frequency =</span> <span class="dv">12</span>)     </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">auto.arima()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Manual Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Model Diagnostics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Final Model Fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p><strong>The relationship between temperature (temp) and solar power generation:</strong> Solar power generation is closely related to temperature and irradiance, but extreme high temperatures can reduce the efficiency of photovoltaic panels.</p></li>
<li><p><strong>The substitution effect of fossil fuel prices on clean energy:</strong> When oil prices (WTI) or natural gas prices (HH) rise, clean energy (especially wind and solar power) becomes more economically attractive.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> solar_df <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_temp, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(wti, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_n, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual plots for each variable with y-axis labels</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Solar, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Solar Electricity Generation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Value"</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Monthly_Anomaly, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Global Average Temperature Anomaly"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperature (C)"</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>WTI, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"WTI Oil price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>HH, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Henry Hub Natural Gas price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the individual plots into a single figure with subplots and y-axis labels</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">subplot</span>(p1, p2, p3, p4, <span class="at">nrows =</span> <span class="dv">4</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>, <span class="at">titleX =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Time Series of Solar power generation, temperature, and oil and gas prices"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Value"</span>), </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperature (C)"</span>), </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis3 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis4 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>final_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-014e50814fb4e4761ada" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-014e50814fb4e4761ada">{"x":{"data":[{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[2.2103601489515285,3.051498051459848,3.3089358832358498,3.6071812101294309,4.0020830637957951,4.0639540808980321,4.4122648177344921,4.1949739035040254,4.1222190989880803,3.6928963754718702,2.9948819120991521,2.7296159790167707,1.8718021769015913,2.5311539009533202,3.4499240517523888,3.6573629868961435,4.3951032616854491,4.5124297016863677,4.5217233575309894,4.4461627310994896,4.171351898582885,3.0355777914761144,2.6594900104868331,1.3952541024913625,2.4265710727750367,3.159762560375694,3.7931718995878208,3.8255496654888019,4.0542167711313217,4.5595764079293719,4.4489490308720825,4.3164876132027272,3.9628681994337147,3.4325668414082129,3.3384350599258399,1.4602416060719736,2.5815038797756698,2.8808824318750488,3.9125628596806128,4.099481346327253,4.2189487254466318,4.5073588809761693,4.1336774485709133,4.127005344461649,4.0227948533820248,3.5677282525497858,2.6412691674118589,1.4471542493766532,2.5344901499768282,2.3852704596126535,3.9689513928140383,4.0413304898994458,4.4039838020259241,4.4759267298669334,4.4079745565946808,4.2883476237898934,4.1048228065097279,3.5121721081044499,2.7305941655371044,2.0487245690177756,2.1596380836741127,2.5712372395390211,3.6417092271374569,4.0649672435114237,4.396336261853989,4.4827313287955137,4.2812251552437024,4.3286917840436354,4.1126427905034761,3.6287312812776582,2.5459233515937747,1.0271162869630397,2.5599368156379927,2.9721053429228346,3.5086756532909833,3.9526657838901627,4.2589404999108975,4.2442290117593924,4.1215705484756917,4.4187562668906057,3.9887988442301956,3.4745407758863651,2.7527685947904748,0.99805503367679471,2.5527210493718568,2.9571993238372074,3.881316344648984,3.9975399329509087,4.4330999048578823,4.4362543693769769,4.4519374180840874,4.3196590885970121,4.2226205024506678,3.8965641303656002,3.1905586514864201,1.6867692553704239,2.7904900333754679,3.5791203901211968,4.3121405072097154,4.5447936583937398,4.5925306424416279,4.8533106938192638,4.7084304977608777,4.656642464357053,4.528256743719119,4.0983863830484326,3.3620406664609614,2.9278280949401183,1.9726911717329554,3.4158889304051452,4.3580796815104081,4.5993130665036936,4.7043365574825904,4.6387306795100525,4.7973430588324204,4.7560956704596551,4.5538137317112604,4.2209918973354652,3.6988792886922699,3.0544256198932094,2.2890945028115466,3.4911599551398851,4.3307201823050283,4.7209868451483556,5.0315614729784324,5.1707850860693343,5.0837742254529976,5.0523720700763368,4.9242128345697811,4.3232846146501185,4.341139533867592,3.7932619917070736,3.6834145486828689,4.4461627310994896,4.8064770426931265,5.0999030125208238,5.2505389403990455,5.4061533157904336,5.2528073169162131,5.4344335407446156,5.2242401631517206,5.0680233112049864,4.6762808134460441,4.7929269452719856,4.5572396522305416,4.9070509778396856,5.4434042367317659,5.7643223870025375,6.1368562646920042,6.2673295724754814,6.2334494795555484,6.1342891859409523,6.1270940496597275,6.0670983189228629,5.8501198528416136,5.8544184135832378,5.736004394317229,6.0699129075621006,6.4287496530721873,6.5023986649882737,6.6236760418511027,6.7692802581680853,6.7200355783915615,6.8502236190239332,6.8551758947776067,6.8952099139384364,6.7145976231581841,6.7452610550615297,6.6215640946042145,6.7274221439666357,7.1831830735318656,7.3045811763434001,7.4671739046252092,7.5618112580018098,7.4886845970429148,7.5387514859432088,7.5133060023354892,7.4482890142308422,7.229577874553649,6.9390058532535335,7.0521594728927219,7.302195839472847,7.6363936304367348,7.7744851097454362,7.8257042352419814,7.8468238157622165,7.8736221517793412,7.8963863931716958,7.7039661394910883,7.5546386015722033,7.4556807145331536,7.3587640171249635,7.3037099727929879,7.7149286693794208,7.8699566044676645,7.9654351503669556,8.1389101799258938,8.1529174343446602,8.2801517604204093,8.2863163148747407,8.1983833719057557,8.0681598212447927,7.9255710203554521,7.792977545646834,7.7510390938572717,7.9197920956402355,8.4149577875059087,8.4983524133946986,8.6630283068597542,8.7185620249414715,8.6249898173463961,8.5883107109059491,8.5290112818704742,8.4445521735280078,8.0736364205374631,8.0179683509387001,8.1074112793023314,8.2678119219506065,8.5283780075036155,8.7089248341474512,8.8318596872769657,8.9112153445952877,8.8180198934530516,8.809177197269193,8.6929769231303275,8.5111129441196223,8.2275799220702286,8.0422622428460713,8.1831761782656329,8.2521262580271131,8.6824747214168045,8.8176349122176116,8.8765301689972702,8.9835769016538016,9.0036409960392003,8.9716457775595053,8.8272070431025718,8.7149723285318998,8.3811427429186782,8.1470204173973784,8.4026522195867752,8.6236067724060828,8.7561541848121553,8.9772385260270937,9.1750660854275203,9.1751282377242855,9.269530836468693,9.1394265852838146,8.953164484572314,8.865761263287057,8.6598238845534805,8.5353126382527389,8.6232175866572387,8.7531198100696788,9.1373590572132937,9.295757595645016,9.4300508369876006,9.4089270154917095,9.4085091128859624,9.3898937676115306,9.3249405699967394,9.1343270935710343,8.9612507384316693,8.7145453867425626,8.9646477403139926,9.1079486672570411,9.3668501526498282,9.5031318441856261,9.62378740625266,9.6836094762501261,9.6655774478411516,9.5820660531967672,9.4944762892453678,9.3877751746798754,9.0362861067566485,8.8213098728113977,8.9626537125202539,9.1521377896526026,9.4102408436193823,9.6199064595611503,9.7573656886671696,9.7888452047522829,9.846616203371525,9.7838055837970188,9.6539245610225954,9.5553979347051179,9.2539849392873439,9.1174031444922008,9.1839557387258708,9.4326139449689705,9.6703150666545596,9.8574999998795647,10.008258159231872,10.097969743187607,10.094127457408314,10.088111955742738,9.9165939867601747,9.8794411411128014,9.5380846303667717,9.4682379062099713],"mode":"lines","name":"Solar Electricity Generation","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[0.33900000000000002,0.60099999999999998,0.57199999999999995,0.64400000000000002,0.42399999999999999,0.45000000000000001,0.38800000000000001,0.48699999999999999,0.46200000000000002,0.27900000000000003,0.33800000000000002,0.35699999999999998,0.52200000000000002,0.50600000000000001,0.61199999999999999,0.61699999999999999,0.61099999999999999,0.56599999999999995,0.57599999999999996,0.48799999999999999,0.55500000000000005,0.51100000000000001,0.71099999999999997,0.67800000000000005,0.77900000000000003,0.73399999999999999,0.94599999999999995,0.69499999999999995,0.69999999999999996,0.57399999999999995,0.60199999999999998,0.56999999999999995,0.68899999999999995,0.61599999999999999,0.58399999999999996,0.58099999999999996,0.81200000000000006,0.61899999999999999,0.59899999999999998,0.64600000000000002,0.67000000000000004,0.501,0.56699999999999995,0.66700000000000004,0.69499999999999995,0.747,0.54000000000000004,0.79400000000000004,0.65800000000000003,0.73999999999999999,0.64400000000000002,0.71199999999999997,0.438,0.44400000000000001,0.254,0.47499999999999998,0.55200000000000005,0.63200000000000001,0.70499999999999996,0.55900000000000005,0.80000000000000004,0.69399999999999995,0.78900000000000003,0.76800000000000002,0.70699999999999996,0.69699999999999995,0.61099999999999999,0.64200000000000002,0.749,0.82499999999999996,0.72999999999999998,0.77700000000000002,0.64900000000000002,0.83599999999999997,0.70399999999999996,0.623,0.56699999999999995,0.67400000000000004,0.47299999999999998,0.748,0.64600000000000002,0.70699999999999996,0.70899999999999996,0.85199999999999998,0.997,0.77400000000000002,0.70199999999999996,0.88400000000000001,0.72199999999999998,0.62,0.64300000000000002,0.64400000000000002,0.61499999999999999,0.63900000000000001,0.59899999999999998,0.52700000000000002,0.318,0.373,0.68999999999999995,0.60799999999999998,0.57599999999999996,0.51400000000000001,0.57899999999999996,0.49199999999999999,0.68400000000000005,0.71299999999999997,0.67900000000000005,0.60599999999999998,0.72199999999999998,0.59899999999999998,0.52400000000000002,0.66400000000000003,0.67500000000000004,0.70299999999999996,0.78800000000000003,0.748,0.748,0.72399999999999998,0.78700000000000003,0.79200000000000004,0.83699999999999997,0.91900000000000004,0.93400000000000005,0.98899999999999999,0.82199999999999995,0.70099999999999996,0.61499999999999999,0.70499999999999996,0.68700000000000006,0.751,0.78200000000000003,0.57799999999999996,0.62,0.58099999999999996,0.70399999999999996,0.72499999999999998,0.59499999999999997,0.68799999999999994,0.79100000000000004,0.81999999999999995,0.60299999999999998,0.66800000000000004,0.57199999999999995,0.65000000000000002,0.48699999999999999,0.53900000000000003,0.52400000000000002,0.78300000000000003,0.82399999999999995,0.70299999999999996,0.57999999999999996,0.749,0.78100000000000003,0.85399999999999998,0.81399999999999995,0.61399999999999999,0.747,0.61599999999999999,0.68700000000000006,0.64400000000000002,0.68600000000000005,0.68400000000000005,0.58699999999999997,0.73299999999999998,0.79200000000000004,0.70499999999999996,0.83899999999999997,0.74399999999999999,0.79500000000000004,0.59099999999999997,0.78700000000000003,0.86299999999999999,0.90200000000000002,0.68500000000000005,0.58499999999999996,0.89300000000000002,0.93500000000000005,0.85699999999999998,0.63400000000000001,0.81599999999999995,0.871,0.90200000000000002,0.91800000000000004,0.86799999999999999,0.86699999999999999,0.83299999999999996,0.73899999999999999,0.875,0.89600000000000002,1.0960000000000001,1.0189999999999999,1.1919999999999999,1.2529999999999999,1.3380000000000001,1.329,1.179,1.052,0.84199999999999997,0.84199999999999997,1.0429999999999999,0.92700000000000005,0.96199999999999997,0.96099999999999997,0.97399999999999998,1.0940000000000001,1.181,1.222,1.0449999999999999,0.98699999999999999,0.73299999999999998,0.81399999999999995,0.90100000000000002,0.78600000000000003,0.92600000000000005,0.85699999999999998,0.996,0.878,0.92700000000000005,0.93100000000000005,0.99099999999999999,0.85199999999999998,0.80800000000000005,0.81000000000000005,0.83299999999999996,0.81200000000000006,1.0129999999999999,0.82099999999999995,0.97799999999999998,0.95599999999999996,0.99299999999999999,1.2190000000000001,1.113,0.92900000000000005,0.88800000000000001,0.95699999999999996,1.002,0.94899999999999995,1.109,1.012,1.161,1.2010000000000001,1.2310000000000001,1.1779999999999999,1.2310000000000001,1.046,0.92300000000000004,0.93100000000000005,0.95399999999999996,1.0089999999999999,0.93100000000000005,1.0880000000000001,0.86599999999999999,0.89400000000000002,0.69799999999999995,0.86799999999999999,0.88500000000000001,0.86799999999999999,0.84499999999999997,0.90600000000000003,0.90400000000000003,0.98899999999999999,1.0600000000000001,0.93100000000000005,0.88900000000000001,0.94599999999999995,0.88900000000000001,1.0780000000000001,0.92700000000000005,0.89600000000000002,0.97199999999999998,0.92500000000000004,0.97599999999999998,0.91900000000000004,1.0409999999999999,0.72999999999999998,0.93600000000000005,0.92500000000000004,0.98499999999999999,1.268,1.0860000000000001,1.002,1.1299999999999999,1.266,1.3149999999999999,1.548,1.393,1.3999999999999999,1.427,1.3,1.4259999999999999,1.343,1.3520000000000001,1.2230000000000001,1.23,1.2290000000000001,1.383,1.2709999999999999,1.3680000000000001,1.3129999999999999,1.2889999999999999],"mode":"lines","name":"Global Average Temperature Anomaly","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[27.224285714285699,29.362380952380899,29.8921739130435,25.798999999999999,28.833478260869601,31.859090909090899,29.983809523809501,31.218695652173899,33.859999999999999,33.075000000000003,34.555,28.3880952380952,29.4821739130435,29.583500000000001,27.241363636363602,27.4538095238095,28.610434782608699,27.6009523809524,26.435909090909099,27.467826086956499,26.210999999999999,22.210434782608701,19.5840909090909,19.317619047619001,19.6073913043478,20.775500000000001,24.508095238095201,26.2663636363636,27.003913043478299,25.521000000000001,26.93,28.381363636363599,29.632857142857102,28.8539130434783,26.3247619047619,29.548636363636401,32.911739130434803,35.914999999999999,33.219047619047601,28.357727272727299,28.223636363636398,30.724761904761898,30.747391304347801,31.5919047619048,28.451363636363599,30.330869565217402,30.962499999999999,32.204347826087002,34.146363636363603,34.722000000000001,36.760869565217398,36.719090909090902,40.272857142857099,38.041363636363599,40.685000000000002,44.935909090909099,45.860909090909097,53.1671428571428,48.532272727272698,43.279130434782601,46.991904761904799,47.990499999999997,54.093043478260903,53.036666666666697,49.922272727272698,56.305454545454602,58.705714285714301,64.968260869565199,65.6577272727273,62.370476190476197,58.311363636363602,59.366363636363602,65.232727272727303,61.543999999999997,62.899565217391299,69.673500000000004,70.959130434782594,70.957727272727297,74.361428571428604,73.048695652173905,64.119047619047606,58.878181818181801,59.289090909090902,62.028571428571396,54.780000000000001,59.269500000000001,60.564090909090901,63.974761904761898,63.513478260869597,67.478571428571399,74.046363636363594,72.392173913043493,79.632999999999996,85.926521739130393,94.766363636363593,91.774761904761903,92.982608695652203,95.361428571428604,105.50380952381001,112.336363636364,125.67136363636401,133.92809523809501,133.95826086956501,116.69714285714301,104.443636363636,76.283913043478293,56.968000000000004,40.644347826086999,41.6309090909091,39.078499999999998,47.979999999999997,49.905909090909098,59.257142857142803,69.672272727272698,64.208695652173901,71.064285714285703,69.397727272727295,75.823636363636396,77.972380952381002,74.625652173912997,78.418571428571397,76.308000000000007,81.242173913043501,84.497727272727303,73.842380952380907,75.349090909090904,76.177272727272694,76.618181818181796,75.273636363636399,81.902380952380994,84.148636363636399,89.366956521739098,89.523809523809504,89.414000000000001,102.935652173913,110.147619047619,101.29909090909101,96.2886363636364,97.078095238095202,86.334347826086997,85.648181818181797,86.411904761904793,97.109090909090895,98.566818181818206,100.102272727273,102.297142857143,106.187272727273,103.325714285714,94.534782608695707,82.400476190476198,87.919090909090897,94.118260869565205,94.704499999999996,89.596521739130395,86.720909090909103,88.262857142857101,94.729565217391297,95.3095,93.199047619047604,92.067727272727296,94.766956521739104,95.769499999999994,104.42652173913,106.435454545455,106.395238095238,100.556956521739,93.850952380952407,97.890454545454503,94.9630434782609,100.705,100.568095238095,102.175,101.99636363636399,105.234761904762,102.948260869565,96.317142857142898,93.271818181818205,84.406086956521705,75.707499999999996,59.139565217391301,47.557272727272696,50.856999999999999,47.782272727272698,54.378636363636403,59.388571428571403,59.828636363636399,51.198695652173903,42.912857142857099,45.509999999999998,46.268636363636404,42.585238095238097,37.3960869565217,31.784285714285701,30.377619047619,37.901739130434798,41.031904761904798,46.841818181818198,48.791818181818201,44.896190476190498,44.7517391304348,45.200000000000003,49.809523809523803,45.470909090909103,52.052727272727303,52.561818181818197,53.450000000000003,49.363043478260899,51.173999999999999,48.559565217391302,45.185454545454498,46.581904761904802,48.047826086956498,49.735714285714302,51.573181818181801,56.738181818181801,57.920476190476201,63.584782608695697,62.226999999999997,62.830454545454501,66.313809523809496,69.898695652173899,67.876190476190501,71.0745454545455,67.927391304347793,70.1905,70.753043478260906,56.188181818181803,48.919047619047603,51.227391304347798,54.996000000000002,58.170476190476201,63.870454545454599,60.740000000000002,54.665999999999997,57.376086956521704,54.830454545454501,56.859999999999999,53.960869565217401,56.677619047619103,59.867727272727301,57.7169565217391,50.607999999999997,29.320454545454499,16.975000000000001,28.781428571428599,38.314545454545502,40.7152173913043,42.370952380952403,39.5981818181818,39.405000000000001,41.389047619047602,47.0704347826087,51.849523809523802,59.234499999999997,62.183913043478299,61.417727272727298,65.160952380952395,71.377272727272697,72.591818181818198,67.872272727272701,71.534999999999997,81.3642857142857,79.095454545454601,71.802173913043504,83.277619047618998,91.608000000000004,108.399130434783,101.985238095238,109.71272727272699,114.675909090909,101.91809523809501,93.692608695652197,84.400000000000006,87.286666666666704,84.076363636363595,76.581818181818207,78.251363636363607,77.027500000000003,73.348260869565195,79.126499999999993,71.673478260869601,70.306818181818201,75.766666666666694,81.372608695652204,89.240952380952393,85.469090909090895,77.575454545454505,72.019523809523804,74.003043478260906,77.363809523809493,81.405714285714296,85.347272727272696,79.957391304347894,79.912499999999994,81.947826086956496,76.683181818181794,70.439999999999998,72.164347826086995,69.941428571428602,70.152272727272702],"mode":"lines","name":"WTI Oil price","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y3","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[1.8515994695840721,1.8779371654691073,1.9329696377795786,1.9726911717329554,2.1114245875328868,2.2512917986064953,2.3340837600534168,2.3389170222414357,2.3125354238472138,2.244955980157409,2.149433913499871,2.1471001901536506,2.3145136638593193,2.3282528397426234,2.2874714551839976,2.318458442150336,2.4105422344991378,2.4492794721448492,2.4176979000945504,2.3878449369448691,2.3194422100604686,2.1090003439213802,2.0769384114617173,1.9878743481543455,1.9987736386123811,1.9782390361706734,1.9600947840472698,2.0360119837525001,2.1447610078004784,2.259677591982769,2.3331142980288688,2.3456445824544927,2.3253245799635351,2.1529243184396392,2.0781907597781832,2.0630580624293118,2.1016921506146558,2.149433913499871,2.2793164660546914,2.3204250111223765,2.3786197792700432,2.4915511925066687,2.5455312716044354,2.5525652982618152,2.510411940196362,2.3646204839134985,2.2793164660546914,2.252343876557299,2.2731562823032334,2.2874714551839976,2.3055806019738441,2.355177543113216,2.4535879665305731,2.5710843460290524,2.605648267484129,2.6203112867942031,2.5885156324070202,2.4587337754839771,2.4371159859516518,2.4060438013622756,2.388762789235098,2.3860067011331179,2.3832429960115,2.4748563139344988,2.5447466501440172,2.6239436918052106,2.6986730392896132,2.7414849771884473,2.8069901489571136,2.7997173896280341,2.7498317351171653,2.6810215287142909,2.7027025947756149,2.6376277368056642,2.5779415157551897,2.5855058483441162,2.6679224100114309,2.7127060126384039,2.7549337870010606,2.7837759116303458,2.7542974522675299,2.5265283244788197,2.5217206229107165,2.528125768907977,2.4989739069994359,2.4956817229559589,2.550226115908643,2.5885156324070202,2.6871669901857858,2.7899373605743945,2.8160073426073025,2.8160073426073025,2.7744619666214616,2.6789646202071133,2.5680215564985067,2.5128460184772416,2.5047092770841801,2.5321082512722946,2.5748996883147051,2.6734587563325909,2.7930039069823738,2.9396908826703663,3.0335096378880211,3.0041963519661206,2.9128939952449864,2.7376090033437546,2.6246685921631592,2.5525652982618152,2.5249283241374862,2.5063419305080652,2.4832385926873033,2.4578779774000812,2.5541217188094731,2.65745841498615,2.7258901192305411,2.7479117345273405,2.6946271807700692,2.4664031782234406,2.4406063908914204,2.3437270363252209,2.3570732782781154,2.3693087250369538,2.3969857684155298,2.4824035195698819,2.5741377835159431,2.6986730392896132,2.7856283357475848,2.8124102164264526,2.7491921444333851,2.5930133911138515,2.3878449369448691,2.3005830903233728,2.2925347571405443,2.3164879981630371,2.3446862690126808,2.4221443280516848,2.5257286443082556,2.6878474937846906,2.7813006628418027,2.8136106967627028,2.7491921444333851,2.5533438113412288,2.3776925654808512,2.2854389341590751,2.2638442646776151,2.2481289071979869,2.3427668826268775,2.3924257969938352,2.5344901499768282,2.6518325211039815,2.7166795278002644,2.7612749623395079,2.6892071133007303,2.4578779774000812,2.3015845926604621,2.2823823856765264,2.2137538792874301,2.2224590485147608,2.2353763433005955,2.3446862690126808,2.5344901499768282,2.7093826463359885,2.7911651078127169,2.7991089320491769,2.753023566744941,2.5160822672564502,2.3065771142635829,2.2126603854660587,2.2257040486580881,2.2793164660546914,2.3702437414678603,2.4647039424704809,2.6100697927420065,2.7806808921371173,2.8466520505398383,2.8570447537800976,2.7893229212309465,2.5733752977756086,2.3214068472346332,2.3035845933271291,2.2512917986064953,2.2060741926132019,2.2278615467981093,2.3446862690126808,2.5439614125693151,2.7127060126384039,2.7899373605743945,2.826129489167811,2.7972813348301528,2.5336968139574321,2.3045830956567186,2.2267833795777636,2.1138429683971682,2.1234584270966104,2.2181159363675955,2.2669579153508947,2.4527277514237653,2.6693093727857793,2.8069901489571136,2.8678989020441064,2.8201877010390604,2.6203112867942031,2.3767644911682972,2.2038691200548879,2.2321626286975,2.3035845933271291,2.2884861686145439,2.4283362982996062,2.5839975524322312,2.7763317085186157,2.8825635754483532,2.9025198918318122,2.8284963541780774,2.5945081597030812,2.3164879981630371,2.2289385528257473,2.1860512767380942,2.2648832258100344,2.2782924004250011,2.3075726345050849,2.6041700706148179,2.8015405441895487,2.8820035082256483,2.9210087273580543,2.8466520505398383,2.5030739537434492,2.2428350885882717,2.2638442646776151,2.2364452904895007,2.2407096892759584,2.2428350885882717,2.3841650799864684,2.5463152779166438,2.7472709142554912,2.8758219768814333,2.9107188992270343,2.8684669225081145,2.5257286443082556,2.2332350148592526,2.2300144001592104,2.2438960966453663,2.2181159363675955,2.2823823856765264,2.3437270363252209,2.4672517145492794,2.7298116928837226,2.8616292890305104,2.9052603703899154,2.8243506567983707,2.5063419305080652,2.3969857684155298,2.2772672850097559,2.2638442646776151,2.2278615467981093,2.3485140248824456,2.5071572587228199,2.6440448711262978,2.8758219768814333,2.9861868607104594,3.0378334495726262,3.0022112396517002,2.8564702062204832,2.5733752977756086,2.5710843460290524,2.4882344398806748,2.4973291697865574,2.5603232890727545,2.6369121732688705,2.8724340572094973,3.1095072878128356,3.201526186533088,3.2343553957165869,3.1994891110680106,2.9242362718489212,2.7447035187502458,2.6851226964585053,2.73696154459663,2.7199787719674839,2.631888840136646,2.67827804276854,2.8267217308197088,3.0120976276402551,3.1009927842114839,3.1544439647088121,3.0937660138253564,2.8249439525737094,2.6019486702196644,2.5687881337687024,2.4689466302092709,2.5779415157551897,2.6217658325051976,2.67000213346468,2.8808824318750488,3.0411835364579085,3.1354942159291497,3.1557230098629323,3.1228053561174671,2.924773184613497,2.7020321287766471,2.563409711275944],"mode":"lines","name":"Henry Hub Natural Gas price","type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Year","anchor":"y4"},"yaxis4":{"domain":[0,0.23000000000000001],"automargin":true,"anchor":"x","title":"Price"},"yaxis3":{"domain":[0.27000000000000002,0.47999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis2":{"domain":[0.52000000000000002,0.72999999999999998],"automargin":true,"anchor":"x","title":"Temperature (C)"},"yaxis":{"domain":[0.77000000000000002,1],"automargin":true,"anchor":"x","title":"Value"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Time Series of Solar power generation, temperature, and oil and gas prices"},"attrs":{"46e4f0b68ad":{"x":{},"y":{},"mode":"lines","name":"Solar Electricity Generation","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e4a442977":{"x":{},"y":{},"mode":"lines","name":"Global Average Temperature Anomaly","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e451a652b7":{"x":{},"y":{},"mode":"lines","name":"WTI Oil price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e41d93fe3":{"x":{},"y":{},"mode":"lines","name":"Henry Hub Natural Gas price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fit_auto <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  ts_solar,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">xreg =</span> <span class="fu">cbind</span>(ts_anomaly, ts_wti, ts_np))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_solar 
Regression with ARIMA(0,1,0)(2,0,0)[12] errors 

Coefficients:
        sar1    sar2  ts_anomaly   ts_wti   ts_np
      0.7384  0.0343     -0.2005  -0.0035  0.1222
s.e.  0.0623  0.0655      0.1178   0.0024  0.2867

sigma^2 = 0.0832:  log likelihood = -55.29
AIC=122.58   AICc=122.87   BIC=144.78

Training set error measures:
                      ME      RMSE       MAE        MPE     MAPE      MASE
Training set 0.007005674 0.2855417 0.1738749 -0.5963215 5.174797 0.5206869
                   ACF1
Training set -0.3249882</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,1,0)(2,0,0)[12] errors
Q* = 75.679, df = 22, p-value = 8.212e-08

Model df: 2.   Total lags used: 24</code></pre>
</div>
</div>
<p>The auto.arima() fits a Regression with (0,1,0)(2,0,0)[12] errors. The ACF plot and Ljung–Box test all indicate that the model does not fully capture the seasonal structure.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Solar <span class="sc">~</span> Monthly_Anomaly <span class="sc">+</span> WTI <span class="sc">+</span> HH, <span class="at">data =</span> data_all)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Solar ~ Monthly_Anomaly + WTI + HH, data = data_all)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.4115 -1.0282  0.0462  1.2208  4.0037 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -4.819000   0.880666  -5.472 9.49e-08 ***
Monthly_Anomaly  7.017950   0.397215  17.668  &lt; 2e-16 ***
WTI              0.009648   0.004100   2.353   0.0193 *  
HH               1.839612   0.389946   4.718 3.68e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.585 on 296 degrees of freedom
Multiple R-squared:  0.5961,    Adjusted R-squared:  0.592 
F-statistic: 145.6 on 3 and 296 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>From the regression model, all variables are statistically significant, indicating that WTI oil price, natural gas price and temperature have a meaningful impact on total solar electricity generation. This suggests that changes in these factors directly influence solar electricity generation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(lm_fit))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Moreover, the residuals exhibit a high correlation, indicating significant serial correlation that remains unexplained. This suggests that traditional machine learning models may struggle to fully capture the underlying temporal patterns in these time series variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>res.fit <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">residuals</span>(lm_fit), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(res.fit)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(res.fit)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>first_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(res.fit)  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>seasonal_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(first_diff, <span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">###### Plot ACF and PACF for the Differenced Series ######</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"PACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This series appears closer to weak stationarity. The ACF plot shows clear autocorrelations at lags q = 0,1,2,3 and Q = 1,2.</p>
<p>Additionally, both first-order differencing (d = 1) and seasonal differencing (D = 1) have been applied to the data.</p>
<p>The PACF plot shows clear autocorrelations at lags p = 0,1,2,3 and P = 0,1,2.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Define SARIMA Model Comparison Function ######</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>SARIMA.c <span class="ot">&lt;-</span> <span class="cf">function</span>(p_range, d_range, q_range, P_range, D_range, Q_range, data) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set seasonal period</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize results storage</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over parameter combinations</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p_range) {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> d_range) {</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (q <span class="cf">in</span> q_range) {</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (P <span class="cf">in</span> P_range) {</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (D <span class="cf">in</span> D_range) {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (Q <span class="cf">in</span> Q_range) {</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (p <span class="sc">+</span> d <span class="sc">+</span> q <span class="sc">+</span> P <span class="sc">+</span> D <span class="sc">+</span> Q <span class="sc">&lt;=</span> <span class="dv">10</span>) {</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                  model <span class="ot">&lt;-</span> <span class="fu">Arima</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                    data,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">order =</span> <span class="fu">c</span>(p, d, q),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(P, D, Q), <span class="at">period =</span> s)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">AIC</span>(model),</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">BIC</span>(model),</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>                    model<span class="sc">$</span>aicc)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>                results_list[[<span class="fu">length</span>(results_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> result</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert results to a tidy data frame</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind, results_list))</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(results_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"d"</span>, <span class="st">"q"</span>, <span class="st">"P"</span>, <span class="st">"D"</span>, <span class="st">"Q"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"AICc"</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_df)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="do">###### Run SARIMA Model Comparison ######</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">SARIMA.c</span>(</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_range =</span> <span class="dv">1</span>, <span class="at">D_range =</span> <span class="dv">1</span>, </span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">Q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> res.fit</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="do">###### Identify Models with Minimum AIC and BIC ######</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>minaic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC), ]</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>minbic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC), ]</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="do">###### Display Best Models Based on AIC and BIC ######</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(minaic)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
96 2 1 2 1 1 2 729.6844 758.9602 730.2023</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>The model ARIMA(2,1,2)x(1,1,2)[12] works siginificantly better than ARIMA(0,1,0)x(2,0,0)[12] due to the lower AIC, BIC, and AICc numbers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model_output_1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Function to Extract Model Diagnostics ######</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>extract_model_diagnostics <span class="ot">&lt;-</span> <span class="cf">function</span>(model_output) {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  start_line <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Coefficients"</span>, model_output)  <span class="co"># Find where coefficients start</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  end_line <span class="ot">&lt;-</span> <span class="fu">length</span>(model_output)  <span class="co"># Capture till the last line</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(start_line) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(model_output[start_line<span class="sc">:</span>end_line], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Print coefficient section</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No coefficient details found.</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Handle cases where output format changes</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(2,1,2)x(1,1,2)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(2,1,2)x(1,1,2)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
     Estimate     SE  t.value p.value
ar1   -0.0857 0.1575  -0.5444  0.5866
ar2    0.4865 0.0843   5.7725  0.0000
ma1   -0.3514 0.1644  -2.1372  0.0335
ma2   -0.4945 0.1338  -3.6948  0.0003
sar1  -0.9712 0.0467 -20.7861  0.0000
sma1   0.1310 0.0839   1.5613  0.1196
sma2  -0.7351 0.0832  -8.8318  0.0000

sigma^2 estimated as 0.6651609 on 280 degrees of freedom 
 
AIC = 2.542454  AICc = 2.543853  BIC = 2.644461 
 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model_output_2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(0,1,0)x(2,0,0)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(0,1,0)x(2,0,0)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
sar1       0.1181 0.0579  2.0389  0.0423
sar2       0.1333 0.0592  2.2503  0.0252
constant  -0.0069 0.0691 -0.0993  0.9210

sigma^2 estimated as 0.8323154 on 296 degrees of freedom 
 
AIC = 2.68328  AICc = 2.683552  BIC = 2.732784 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Using corss validation, we can confirm that ARIMA(0,1,0)x(2,0,0)[12] is the better model since is stays at a lower RMSE for the majority of the time in the plot below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(res.fit)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">92</span>   <span class="co"># initial training size</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">52</span>, <span class="dv">4</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">52</span>, <span class="dv">4</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>) {</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># training = first (k+i-1) observations</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> y[<span class="dv">1</span><span class="sc">:</span>(k<span class="sc">+</span>i<span class="dv">-1</span>)]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test = next 4 observations</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  xtest  <span class="ot">&lt;-</span> y[(k<span class="sc">+</span>i)<span class="sc">:</span>(k<span class="sc">+</span>i<span class="sc">+</span><span class="dv">3</span>)]</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit ARIMA models</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ensure xtest length = 4</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(xtest)<span class="sc">==</span><span class="dv">4</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(fcast<span class="sc">$</span>mean)<span class="sc">==</span><span class="dv">4</span>) {</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    rmse1[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    rmse2[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="co"># final RMSE</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse1, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8445689 1.0799366 1.2584144 1.3675548</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse2, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7018249 0.9072551 1.0266301 1.0813421</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### RMSE Plot using Plotly #####</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for RMSE values by quarter</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>qr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Q1"</span>, <span class="st">"Q2"</span>, <span class="st">"Q3"</span>, <span class="st">"Q4"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>rmse11 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>rmse22 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an interactive RMSE comparison plot</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse11, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"blue"</span>), <span class="at">name =</span> <span class="st">"RMSE1: ARIMA(2,1,2)x(1,1,2)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse22, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"RMSE2: ARIMA(0,1,0)x(2,0,0)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cross-Validation RMSE"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Quarter"</span>),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"RMSE"</span>),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Model"</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-dd516c1a42106837b904" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-dd516c1a42106837b904">{"x":{"visdat":{"46e47911b74":["function () ","plotlyVisDat"],"46e42be9699e":["function () ","data"],"46e428ee70a1":["function () ","data"]},"cur_data":"46e428ee70a1","attrs":{"46e42be9699e":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["blue"],"name":"RMSE1: ARIMA(2,1,2)x(1,1,2)[12]","inherit":true},"46e428ee70a1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["red"],"name":"RMSE2: ARIMA(0,1,0)x(2,0,0)[12]","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cross-Validation RMSE","xaxis":{"domain":[0,1],"automargin":true,"title":"Quarter","type":"category","categoryorder":"array","categoryarray":["Q1","Q2","Q3","Q4"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"RMSE"},"legend":{"title":"Model"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Q1","Q2","Q3","Q4"],"y":[0.84456887640759026,1.0799365635760443,1.2584143811724353,1.3675547776115951],"type":"scatter","mode":"lines","name":"RMSE1: ARIMA(2,1,2)x(1,1,2)[12]","marker":{"color":"rgba(0,0,255,1)","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Q1","Q2","Q3","Q4"],"y":[0.70182485873609535,0.90725512418198184,1.0266300836316402,1.081342118432395],"type":"scatter","mode":"lines","name":"RMSE2: ARIMA(0,1,0)x(2,0,0)[12]","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the dependent variable (TotalVehicleSales)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> ts_solar</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define external regressors (all variables except TotalVehicleSales)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>xreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ts_anomaly, ts_wti, ts_np)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,1,0)x(0,0,1)[12] with external regressors</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#fit1 &lt;- Arima(y, order = c(2,1,2), seasonal = list(order = c(1,1,2), period = 12), xreg = xreg)</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y 
Regression with ARIMA(0,1,0)(2,0,0)[12] errors 

Coefficients:
        sar1    sar2  ts_anomaly   ts_wti   ts_np
      0.7384  0.0343     -0.2005  -0.0035  0.1222
s.e.  0.0623  0.0655      0.1178   0.0024  0.2867

sigma^2 = 0.0832:  log likelihood = -55.29
AIC=122.58   AICc=122.87   BIC=144.78

Training set error measures:
                      ME      RMSE       MAE        MPE     MAPE      MASE
Training set 0.007005674 0.2855417 0.1738749 -0.5963215 5.174797 0.5206869
                   ACF1
Training set -0.3249882</code></pre>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<p>This model successfully captured the long-term upward trend in solar power generation and accurately reproduced the monthly seasonal patterns. Short-term forecasts have high reliability, while medium- and long-term forecasts exhibit reasonable confidence interval expansion, reflecting the uncertainties in the energy sector. Although the ARIMA model slightly exaggerates the long-term growth slope, the overall trend direction is highly consistent with the structural changes in the US energy market. Therefore, this forecast can serve as a reliable baseline for future solar power generation growth.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model to each external regressor</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tmp_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_anomaly"</span>])</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(FinR_fit)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ftmp <span class="ot">&lt;-</span> <span class="fu">forecast</span>(tmp_fit, <span class="at">h =</span> <span class="dv">32</span>)  <span class="co"># Forecast next 32 periods</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>wti_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_wti"</span>])</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(Imp_fit)</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>fwti <span class="ot">&lt;-</span> <span class="fu">forecast</span>(wti_fit, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>hh_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_np"</span>])</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(CPI_fit)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>fhh <span class="ot">&lt;-</span> <span class="fu">forecast</span>(hh_fit, <span class="at">h =</span> <span class="dv">32</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create future external regressor matrix using forecasted values</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fxreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Temperature =</span> ftmp<span class="sc">$</span>mean, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">WTI =</span> fwti<span class="sc">$</span>mean, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">HH =</span> fhh<span class="sc">$</span>mean)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,0,2)x(0,0,1)[12] with external regressors</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast TotalVehicleSales using future external regressors</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg =</span> fxreg, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forecast</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Solar Electricity Net Generation Forecast"</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="arimax-icln-xle-oil-prices-gas-prices" class="level2">
<h2 class="anchored" data-anchor-id="arimax-icln-xle-oil-prices-gas-prices">(2) ARIMAX: ICLN ~ XLE + oil prices + gas prices</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>etf_symbols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ICLN"</span>, <span class="st">"XLE"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>etf_data <span class="ot">&lt;-</span> <span class="fu">tq_get</span>(etf_symbols,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">from =</span> <span class="st">"2000-01-01"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="st">"2024-12-01"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">get =</span> <span class="st">"stock.prices"</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>icln_monthly <span class="ot">&lt;-</span> etf_data <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(symbol <span class="sc">==</span> <span class="st">"ICLN"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tq_transmute</span>(<span class="at">select =</span> adjusted,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">mutate_fun =</span> to.monthly,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">indexAt =</span> <span class="st">"lastof"</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_rename =</span> <span class="st">"adjusted"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>ts_icln <span class="ot">&lt;-</span> <span class="fu">ts</span>(icln_monthly<span class="sc">$</span>adjusted,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">year</span>(<span class="fu">min</span>(icln_monthly<span class="sc">$</span>date)), <span class="fu">month</span>(<span class="fu">min</span>(icln_monthly<span class="sc">$</span>date))),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>xle_monthly <span class="ot">&lt;-</span> etf_data <span class="sc">%&gt;%</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(symbol <span class="sc">==</span> <span class="st">"XLE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tq_transmute</span>(<span class="at">select =</span> adjusted,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">mutate_fun =</span> to.monthly,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">indexAt =</span> <span class="st">"lastof"</span>,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_rename =</span> <span class="st">"adjusted"</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>ts_xle <span class="ot">&lt;-</span> <span class="fu">ts</span>(xle_monthly<span class="sc">$</span>adjusted,</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">year</span>(<span class="fu">min</span>(xle_monthly<span class="sc">$</span>date)), <span class="fu">month</span>(<span class="fu">min</span>(xle_monthly<span class="sc">$</span>date))),</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">auto.arima()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Manual Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Model Diagnostics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Final Model Fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<ul>
<li><p><strong>Fuel Prices → Substitution/Competition Channel for Clean Energy:</strong> When fossil fuel prices (especially natural gas or oil) rise, the costs for fossil power generation and related companies increase, making renewable energy (and related listed companies) more economically attractive, thereby boosting their valuations and ETF performance.</p></li>
<li><p><strong>Traditional Energy ETFs (XLE) as a Transmission of Industry Sentiment/Risk Premium:</strong> XLE represents the market performance of the traditional energy sector, reflecting industry prosperity, capital flows, and investor risk appetite. The correlation between ICLN and XLE can capture “sector rotation” or the market transmission of funds from traditional energy to clean energy. If the two move in opposite directions, it indicates a substitution relationship between fund flows and market expectations.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/WTIprice.csv"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> wti <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> observation_date) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2008-01-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-12-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">WTI =</span> POILWTIUSDM) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WTI =</span> <span class="fu">as.numeric</span>(WTI))<span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>ts_wti <span class="ot">&lt;-</span> <span class="fu">ts</span>(wti<span class="sc">$</span>WTI,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">1</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/naturalgasprice.csv"</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> df_n <span class="sc">%&gt;%</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">log</span>(<span class="fu">pmax</span>(HH, .Machine<span class="sc">$</span>double.eps))) <span class="sc">%&gt;%</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>ts_np <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_n<span class="sc">$</span>HH,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(df_n<span class="sc">$</span>Year), <span class="fu">min</span>(df_n<span class="sc">$</span>Month)),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>df_icln <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">time</span>(ts_icln)),   </span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">ICLN =</span> <span class="fu">as.numeric</span>(ts_icln)</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>df_xle <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">time</span>(ts_xle)),  </span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">XLE =</span> <span class="fu">as.numeric</span>(ts_xle)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> df_icln <span class="sc">%&gt;%</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_n, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(wti, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_xle, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_all, Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2008-06-01"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>common_start <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">6</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>common_end   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2024</span>, <span class="dv">11</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>ts_icln <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_icln, <span class="at">start =</span> common_start, <span class="at">end =</span> common_end)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>ts_xle  <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_xle,  <span class="at">start =</span> common_start, <span class="at">end =</span> common_end)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>ts_wti  <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_wti,  <span class="at">start =</span> common_start, <span class="at">end =</span> common_end)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>ts_np   <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_np,   <span class="at">start =</span> common_start, <span class="at">end =</span> common_end)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual plots for each variable with y-axis labels</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>ICLN, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Renewable Energy ETF (ICLN)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>XLE, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Energy Select Sector SPDR Fund (XLE)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>WTI, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"WTI Oil price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>HH, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Henry Hub Natural Gas price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the individual plots into a single figure with subplots and y-axis labels</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">subplot</span>(p2, p3, p4, p1, <span class="at">nrows =</span> <span class="dv">4</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>, <span class="at">titleX =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Time Series of ICLN, XLE, WTI and HH price"</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>), </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>), </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis3 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis4 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>final_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b6741f5a92538b079893" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b6741f5a92538b079893">{"x":{"data":[{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01"],"y":[25.632431030273438,21.553485870361328,21.625905990600586,18.396970748901367,14.938461303710938,14.612953186035156,13.955492973327637,13.707175254821777,12.015686988830566,12.467988967895508,13.442873001098633,15.175352096557617,14.181536674499512,14.94005012512207,15.102377891540527,15.984712600708008,16.378997802734375,16.844432830810547,16.992734909057617,16.244590759277344,16.733417510986328,17.204784393310547,17.919652938842773,15.867763519287109,14.927517890930176,16.177484512329102,15.384234428405762,16.921979904174805,17.881881713867188,18.929315567016602,20.693229675292969,22.178895950317383,23.813138961791992,24.26140022277832,24.483482360839844,23.458276748657227,23.007369995117188,23.343250274658203,20.95854377746582,17.93559455871582,21.368837356567383,21.724418640136719,21.280733108520508,21.760963439941406,23.050792694091797,22.172576904296875,22.014970779418945,19.663291931152344,20.609086990356445,21.627584457397461,22.211360931396484,22.903436660766602,22.438697814941406,22.164213180541992,22.390010833740234,24.249057769775391,24.35563850402832,24.974931716918945,24.647436141967773,25.349662780761719,24.775054931640625,26.078668594360352,25.809720993041992,26.355392456054688,27.461610794067383,27.477508544921875,28.266571044921875,26.628253936767578,27.991922378540039,28.582109451293945,30.084060668945312,30.587923049926758,32.274326324462891,31.155538558959961,31.835844039916992,29.368137359619141,28.331077575683594,25.868066787719727,25.813535690307617,24.636341094970703,25.76788330078125,25.470199584960938,27.144582748413086,25.736133575439453,24.839618682861328,22.929380416870117,21.954444885253906,20.375171661376953,22.649066925048828,22.645736694335938,20.264091491699219,19.555253982543945,19.007665634155273,20.939971923828125,22.838069915771484,22.624914169311523,23.240472793579102,22.947580337524414,23.332426071166992,24.192974090576172,23.511135101318359,25.501810073852539,25.943181991577148,25.109638214111328,24.586090087890625,24.220737457275391,23.506942749023438,22.675327301025391,22.650007247924805,23.243124008178711,21.969673156738281,24.206693649291992,24.005207061767578,24.425857543945312,25.71295166015625,26.634572982788086,23.748722076416016,24.15791130065918,26.451503753662109,27.243505477905273,27.398664474487305,27.824398040771484,26.857473373413086,27.514396667480469,24.397512435913086,24.016075134277344,21.028667449951172,23.386375427246094,23.925382614135742,24.434535980224609,24.430841445922852,21.718358993530273,23.758827209472656,23.382175445556641,21.435529708862305,22.278863906860352,21.812211990356445,22.162202835083008,23.497745513916016,20.914714813232422,17.717231750488281,11.627654075622559,15.204778671264648,15.508874893188477,15.338970184326172,14.601396560668945,14.447403907775879,12.337124824523926,11.830456733703613,15.142322540283203,15.820720672607422,16.413475036621094,20.09941291809082,20.696565628051758,20.835775375366211,22.025428771972656,22.957975387573242,21.04871940612793,20.626802444458008,22.469089508056641,24.789754867553711,23.547460556030273,24.249977111816406,28.802852630615234,30.838985443115234,33.718910217285156,33.149868011474609,38.465324401855469,31.897953033447266,34.980251312255859,35.908061981201172,32.4757080078125,40.583358764648438,41.101921081542969,39.8487548828125,40.969459533691406,38.126693725585938,38.12872314453125,39.187469482421875,35.256294250488281,37.693691253662109,40.623935699462891,41.292636871337891,42.285018920898438,39.852432250976562,39.567066192626953,39.597602844238281,39.394512176513672,40.683895111083984,44.950164794921875,44.526412963867188,44.374065399169922,43.746532440185547,44.735210418701172,43.808921813964844,42.486728668212891,42.869010925292969,46.227302551269531],"mode":"lines","name":"Energy Select Sector SPDR Fund (XLE)","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[133.92809523809501,133.95826086956501,116.69714285714301,104.443636363636,76.283913043478293,56.968000000000004,40.644347826086999,41.6309090909091,39.078499999999998,47.979999999999997,49.905909090909098,59.257142857142803,69.672272727272698,64.208695652173901,71.064285714285703,69.397727272727295,75.823636363636396,77.972380952381002,74.625652173912997,78.418571428571397,76.308000000000007,81.242173913043501,84.497727272727303,73.842380952380907,75.349090909090904,76.177272727272694,76.618181818181796,75.273636363636399,81.902380952380994,84.148636363636399,89.366956521739098,89.523809523809504,89.414000000000001,102.935652173913,110.147619047619,101.29909090909101,96.2886363636364,97.078095238095202,86.334347826086997,85.648181818181797,86.411904761904793,97.109090909090895,98.566818181818206,100.102272727273,102.297142857143,106.187272727273,103.325714285714,94.534782608695707,82.400476190476198,87.919090909090897,94.118260869565205,94.704499999999996,89.596521739130395,86.720909090909103,88.262857142857101,94.729565217391297,95.3095,93.199047619047604,92.067727272727296,94.766956521739104,95.769499999999994,104.42652173913,106.435454545455,106.395238095238,100.556956521739,93.850952380952407,97.890454545454503,94.9630434782609,100.705,100.568095238095,102.175,101.99636363636399,105.234761904762,102.948260869565,96.317142857142898,93.271818181818205,84.406086956521705,75.707499999999996,59.139565217391301,47.557272727272696,50.856999999999999,47.782272727272698,54.378636363636403,59.388571428571403,59.828636363636399,51.198695652173903,42.912857142857099,45.509999999999998,46.268636363636404,42.585238095238097,37.3960869565217,31.784285714285701,30.377619047619,37.901739130434798,41.031904761904798,46.841818181818198,48.791818181818201,44.896190476190498,44.7517391304348,45.200000000000003,49.809523809523803,45.470909090909103,52.052727272727303,52.561818181818197,53.450000000000003,49.363043478260899,51.173999999999999,48.559565217391302,45.185454545454498,46.581904761904802,48.047826086956498,49.735714285714302,51.573181818181801,56.738181818181801,57.920476190476201,63.584782608695697,62.226999999999997,62.830454545454501,66.313809523809496,69.898695652173899,67.876190476190501,71.0745454545455,67.927391304347793,70.1905,70.753043478260906,56.188181818181803,48.919047619047603,51.227391304347798,54.996000000000002,58.170476190476201,63.870454545454599,60.740000000000002,54.665999999999997,57.376086956521704,54.830454545454501,56.859999999999999,53.960869565217401,56.677619047619103,59.867727272727301,57.7169565217391,50.607999999999997,29.320454545454499,16.975000000000001,28.781428571428599,38.314545454545502,40.7152173913043,42.370952380952403,39.5981818181818,39.405000000000001,41.389047619047602,47.0704347826087,51.849523809523802,59.234499999999997,62.183913043478299,61.417727272727298,65.160952380952395,71.377272727272697,72.591818181818198,67.872272727272701,71.534999999999997,81.3642857142857,79.095454545454601,71.802173913043504,83.277619047618998,91.608000000000004,108.399130434783,101.985238095238,109.71272727272699,114.675909090909,101.91809523809501,93.692608695652197,84.400000000000006,87.286666666666704,84.076363636363595,76.581818181818207,78.251363636363607,77.027500000000003,73.348260869565195,79.126499999999993,71.673478260869601,70.306818181818201,75.766666666666694,81.372608695652204,89.240952380952393,85.469090909090895,77.575454545454505,72.019523809523804,74.003043478260906,77.363809523809493,81.405714285714296,85.347272727272696,79.957391304347894,79.912499999999994,81.947826086956496,76.683181818181794,70.439999999999998,72.164347826086995,69.941428571428602,70.152272727272702],"mode":"lines","name":"WTI Oil price","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[2.9396908826703663,3.0335096378880211,3.0041963519661206,2.9128939952449864,2.7376090033437546,2.6246685921631592,2.5525652982618152,2.5249283241374862,2.5063419305080652,2.4832385926873033,2.4578779774000812,2.5541217188094731,2.65745841498615,2.7258901192305411,2.7479117345273405,2.6946271807700692,2.4664031782234406,2.4406063908914204,2.3437270363252209,2.3570732782781154,2.3693087250369538,2.3969857684155298,2.4824035195698819,2.5741377835159431,2.6986730392896132,2.7856283357475848,2.8124102164264526,2.7491921444333851,2.5930133911138515,2.3878449369448691,2.3005830903233728,2.2925347571405443,2.3164879981630371,2.3446862690126808,2.4221443280516848,2.5257286443082556,2.6878474937846906,2.7813006628418027,2.8136106967627028,2.7491921444333851,2.5533438113412288,2.3776925654808512,2.2854389341590751,2.2638442646776151,2.2481289071979869,2.3427668826268775,2.3924257969938352,2.5344901499768282,2.6518325211039815,2.7166795278002644,2.7612749623395079,2.6892071133007303,2.4578779774000812,2.3015845926604621,2.2823823856765264,2.2137538792874301,2.2224590485147608,2.2353763433005955,2.3446862690126808,2.5344901499768282,2.7093826463359885,2.7911651078127169,2.7991089320491769,2.753023566744941,2.5160822672564502,2.3065771142635829,2.2126603854660587,2.2257040486580881,2.2793164660546914,2.3702437414678603,2.4647039424704809,2.6100697927420065,2.7806808921371173,2.8466520505398383,2.8570447537800976,2.7893229212309465,2.5733752977756086,2.3214068472346332,2.3035845933271291,2.2512917986064953,2.2060741926132019,2.2278615467981093,2.3446862690126808,2.5439614125693151,2.7127060126384039,2.7899373605743945,2.826129489167811,2.7972813348301528,2.5336968139574321,2.3045830956567186,2.2267833795777636,2.1138429683971682,2.1234584270966104,2.2181159363675955,2.2669579153508947,2.4527277514237653,2.6693093727857793,2.8069901489571136,2.8678989020441064,2.8201877010390604,2.6203112867942031,2.3767644911682972,2.2038691200548879,2.2321626286975,2.3035845933271291,2.2884861686145439,2.4283362982996062,2.5839975524322312,2.7763317085186157,2.8825635754483532,2.9025198918318122,2.8284963541780774,2.5945081597030812,2.3164879981630371,2.2289385528257473,2.1860512767380942,2.2648832258100344,2.2782924004250011,2.3075726345050849,2.6041700706148179,2.8015405441895487,2.8820035082256483,2.9210087273580543,2.8466520505398383,2.5030739537434492,2.2428350885882717,2.2638442646776151,2.2364452904895007,2.2407096892759584,2.2428350885882717,2.3841650799864684,2.5463152779166438,2.7472709142554912,2.8758219768814333,2.9107188992270343,2.8684669225081145,2.5257286443082556,2.2332350148592526,2.2300144001592104,2.2438960966453663,2.2181159363675955,2.2823823856765264,2.3437270363252209,2.4672517145492794,2.7298116928837226,2.8616292890305104,2.9052603703899154,2.8243506567983707,2.5063419305080652,2.3969857684155298,2.2772672850097559,2.2638442646776151,2.2278615467981093,2.3485140248824456,2.5071572587228199,2.6440448711262978,2.8758219768814333,2.9861868607104594,3.0378334495726262,3.0022112396517002,2.8564702062204832,2.5733752977756086,2.5710843460290524,2.4882344398806748,2.4973291697865574,2.5603232890727545,2.6369121732688705,2.8724340572094973,3.1095072878128356,3.201526186533088,3.2343553957165869,3.1994891110680106,2.9242362718489212,2.7447035187502458,2.6851226964585053,2.73696154459663,2.7199787719674839,2.631888840136646,2.67827804276854,2.8267217308197088,3.0120976276402551,3.1009927842114839,3.1544439647088121,3.0937660138253564,2.8249439525737094,2.6019486702196644,2.5687881337687024,2.4689466302092709,2.5779415157551897,2.6217658325051976,2.67000213346468,2.8808824318750488,3.0411835364579085,3.1354942159291497,3.1557230098629323,3.1228053561174671,2.924773184613497,2.7020321287766471,2.563409711275944],"mode":"lines","name":"Henry Hub Natural Gas price","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y3","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01"],"y":[35.355644226074219,34.433929443359375,35.278236389160156,25.667140960693359,15.472048759460449,13.4879150390625,15.049897193908691,14.261866569519043,10.715747833251953,12.312912940979004,14.810669898986816,16.654092788696289,16.126113891601562,16.515119552612305,14.959086418151855,16.444387435913086,14.449846267700195,15.270293235778809,15.867925643920898,13.71513557434082,12.745665550231934,13.430000305175781,13.11634635925293,10.842374801635742,10.507543563842773,11.695039749145508,11.176861763000488,12.429132461547852,12.206024169921875,10.701862335205078,11.506366729736328,11.978528022766113,12.479758262634277,13.692862510681152,13.344186782836914,12.363528251647949,11.899580001831055,10.775731086730957,9.7106456756591797,6.8092060089111328,7.1985125541687012,6.8532781600952148,6.4460978507995605,7.0046610832214355,7.2084589004516602,6.8687949180603027,6.4385499954223633,5.3214278221130371,5.5643510818481445,4.8630275726318359,5.1790084838867188,5.2791972160339355,5.0171651840209961,5.12506103515625,5.6224808692932129,5.7401046752929688,5.7165803909301758,5.7714729309082031,6.6654238700866699,7.0575065612792969,6.9339814186096191,7.3941307067871094,7.0688519477844238,8.1240224838256836,8.4016990661621094,8.3937664031982422,8.383793830871582,8.3115224838256836,8.9700174331665039,8.9941091537475586,8.5925846099853516,8.945927619934082,9.6037435531616211,9.0612049102783203,9.5389623641967773,8.8020792007446289,8.4619836807250977,8.2838354110717773,7.9815182685852051,8.2288789749145508,9.0121927261352539,9.7790098190307617,10.298465728759766,10.018125534057617,9.2910585403442383,8.7730350494384766,7.8873748779296875,7.5698761940002441,8.1881647109985352,7.8706626892089844,8.2852563858032227,7.3253774642944336,7.0811967849731445,7.8642539978027344,7.7463765144348145,7.3422179222106934,7.5314741134643555,7.8059706687927246,7.8831734657287598,7.8574395179748535,7.6000986099243164,6.896702766418457,6.8855161666870117,7.2088208198547363,7.5233869552612305,7.4796981811523438,7.4097952842712402,7.5932912826538086,7.606473445892334,8.0241174697875977,8.1129779815673828,7.9796867370605469,8.2729291915893555,7.9174857139587402,8.3635215759277344,8.587864875793457,8.3994150161743164,8.5429964065551758,8.8391284942626953,8.7134971618652344,7.9421758651733398,8.2878828048706055,7.9330787658691406,7.8239083290100098,7.3781256675720215,8.1787109375,7.6080222129821777,8.7409334182739258,8.9343595504760742,8.9896240234375,9.3580503463745117,9.2014675140380859,9.8740777969360352,9.9575986862182617,10.087517738342285,10.115360260009766,9.8926362991333008,10.217443466186523,10.983314514160156,11.329171180725098,11.740464210510254,8.9268636703491211,10.057910919189453,11.142221450805664,11.754646301269531,13.519721031188965,16.092218399047852,17.35969352722168,18.364284515380859,22.091592788696289,26.560819625854492,28.02806282043457,24.312932968139648,22.855096817016602,21.858123779296875,21.557151794433594,22.188030242919922,21.47869873046875,22.065080642700195,20.476173400878906,23.899900436401367,22.216405868530273,20.137134552001953,17.835205078125,19.699577331542969,20.470058441162109,17.920812606811523,18.910070419311523,18.244497299194336,21.347499847412109,21.242153167724609,18.282806396484375,18.091266632080078,20.265279769897461,19.043680191040039,19.897527694702148,18.420085906982422,18.976524353027344,17.949987411499023,17.59501838684082,17.771306991577148,17.655410766601562,15.530577659606934,14.120463371276855,12.565474510192871,13.724472045898438,15.158291816711426,13.444830894470215,13.542186737060547,13.610334396362305,12.880167007446289,14.57415771484375,13.052566528320312,13.865902900695801,14.003091812133789,14.395060539245605,12.836984634399414,12.141240119934082],"mode":"lines","name":"Renewable Energy ETF (ICLN)","type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Year","anchor":"y4"},"yaxis4":{"domain":[0,0.23000000000000001],"automargin":true,"anchor":"x","title":"Price"},"yaxis3":{"domain":[0.27000000000000002,0.47999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis2":{"domain":[0.52000000000000002,0.72999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis":{"domain":[0.77000000000000002,1],"automargin":true,"anchor":"x","title":"Price"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Time Series of ICLN, XLE, WTI and HH price"},"attrs":{"46e44325aa8":{"x":{},"y":{},"mode":"lines","name":"Energy Select Sector SPDR Fund (XLE)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e434434eec":{"x":{},"y":{},"mode":"lines","name":"WTI Oil price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e4d35597f":{"x":{},"y":{},"mode":"lines","name":"Henry Hub Natural Gas price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e421f71854":{"x":{},"y":{},"mode":"lines","name":"Renewable Energy ETF (ICLN)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fit_auto <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  ts_icln,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">xreg =</span> <span class="fu">cbind</span>(ts_xle, ts_wti, ts_np)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_icln 
Regression with ARIMA(0,1,1)(2,0,0)[12] errors 

Coefficients:
         ma1     sar1     sar2  ts_xle  ts_wti   ts_np
      0.3556  -0.0975  -0.0040  0.2960  0.0094  1.4393
s.e.  0.0688   0.0940   0.0955  0.0512  0.0180  0.8832

sigma^2 = 1.837:  log likelihood = -336.51
AIC=687.02   AICc=687.62   BIC=710.01

Training set error measures:
                     ME     RMSE       MAE       MPE     MAPE      MASE
Training set -0.1154506 1.331195 0.8690742 -0.841352 6.832762 0.2816484
                    ACF1
Training set 0.002875956</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,1,1)(2,0,0)[12] errors
Q* = 24.12, df = 21, p-value = 0.2873

Model df: 3.   Total lags used: 24</code></pre>
</div>
</div>
<p>The auto.arima() fits a Regression with ARIMA(0,1,1)(2,0,0)[12] errors. It shows well-behaved residuals. - The residual time series fluctuates randomly around zero with no noticeable pattern. - The ACF plot does not exhibit significant autocorrelation, and most spikes remain within the 95% confidence bounds, indicating that the model successfully captures the serial dependence in the data. - The Ljung–Box test (p = 0.2873) confirms that we cannot reject the null hypothesis of no autocorrelation, meaning the residuals are consistent with white noise. - Therefore, this ARIMA model adequately accounts for the strong temporal dependence in the series</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(ICLN <span class="sc">~</span> XLE <span class="sc">+</span> WTI <span class="sc">+</span> HH, <span class="at">data =</span> data_all)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ICLN ~ XLE + WTI + HH, data = data_all)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.3476 -3.9395 -0.8801  2.4945 18.6202 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -9.38426    3.69562  -2.539   0.0119 *  
XLE         -0.05777    0.05382  -1.073   0.2844    
WTI          0.03615    0.01855   1.948   0.0528 .  
HH           7.89197    1.52241   5.184 5.43e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.357 on 194 degrees of freedom
  (1 observation deleted due to missingness)
Multiple R-squared:  0.1566,    Adjusted R-squared:  0.1436 
F-statistic: 12.01 on 3 and 194 DF,  p-value: 3.026e-07</code></pre>
</div>
</div>
<p>Only HH (natural gas price) has a stable and significant effect on ICLN.</p>
<p>XLE has no significant effect at all; WTI has only a weak correlation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(lm_fit))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Moreover, the residuals exhibit a high correlation, indicating significant serial correlation that remains unexplained. This suggests that traditional machine learning models may struggle to fully capture the underlying temporal patterns in these time series variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>res.fit <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">residuals</span>(lm_fit), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(res.fit)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(res.fit)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>first_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(res.fit)  </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>seasonal_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(first_diff, <span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="do">###### Plot ACF and PACF for the Differenced Series ######</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"PACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Define SARIMA Model Comparison Function ######</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>SARIMA.c <span class="ot">&lt;-</span> <span class="cf">function</span>(p_range, d_range, q_range, P_range, D_range, Q_range, data) {</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set seasonal period</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize results storage</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over parameter combinations</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p_range) {</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> d_range) {</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (q <span class="cf">in</span> q_range) {</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (P <span class="cf">in</span> P_range) {</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (D <span class="cf">in</span> D_range) {</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (Q <span class="cf">in</span> Q_range) {</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (p <span class="sc">+</span> d <span class="sc">+</span> q <span class="sc">+</span> P <span class="sc">+</span> D <span class="sc">+</span> Q <span class="sc">&lt;=</span> <span class="dv">10</span>) {</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>                result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>                  model <span class="ot">&lt;-</span> <span class="fu">Arima</span>(</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>                    data,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">order =</span> <span class="fu">c</span>(p, d, q),</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(P, D, Q), <span class="at">period =</span> s)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q,</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">AIC</span>(model),</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">BIC</span>(model),</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>                    model<span class="sc">$</span>aicc)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>                }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>                results_list[[<span class="fu">length</span>(results_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> result</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert results to a tidy data frame</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind, results_list))</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(results_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"d"</span>, <span class="st">"q"</span>, <span class="st">"P"</span>, <span class="st">"D"</span>, <span class="st">"Q"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"AICc"</span>)</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_df)</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a><span class="do">###### Run SARIMA Model Comparison ######</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">SARIMA.c</span>(</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_range =</span> <span class="dv">1</span>, <span class="at">D_range =</span> <span class="dv">1</span>, </span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">Q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> res.fit</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="do">###### Identify Models with Minimum AIC and BIC ######</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>minaic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC), ]</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>minbic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC), ]</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a><span class="do">###### Display Best Models Based on AIC and BIC ######</span></span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(minaic)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    p d q P D Q      AIC      BIC     AICc
101 3 1 2 0 1 1 698.2813 720.8238 698.9141</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>The model ARIMA(3,1,2)x(0,1,1)[12] works siginificantly better than ARIMA(0,1,1)x(2,0,0)[12] due to the lower AIC, BIC, and AICc numbers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>model_output_1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Function to Extract Model Diagnostics ######</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>extract_model_diagnostics <span class="ot">&lt;-</span> <span class="cf">function</span>(model_output) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  start_line <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Coefficients"</span>, model_output)  <span class="co"># Find where coefficients start</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  end_line <span class="ot">&lt;-</span> <span class="fu">length</span>(model_output)  <span class="co"># Capture till the last line</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(start_line) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(model_output[start_line<span class="sc">:</span>end_line], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Print coefficient section</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No coefficient details found.</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Handle cases where output format changes</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(3,1,2)x(0,1,1)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(3,1,2)x(0,1,1)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
     Estimate     SE  t.value p.value
ar1    0.9859 0.0710  13.8851       0
ar2   -1.1419 0.0560 -20.3824       0
ar3    0.3433 0.0736   4.6612       0
ma1   -0.8266 0.0208 -39.6974       0
ma2    1.0000 0.0320  31.2942       0
sma1  -0.7952 0.0752 -10.5762       0

sigma^2 estimated as 2.125079 on 179 degrees of freedom 
 
AIC = 3.774493  AICc = 3.777044  BIC = 3.896345 
 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model_output_2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(0,1,1)x(2,0,0)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(0,1,1)x(2,0,0)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
ma1        0.2613 0.0752  3.4767  0.0006
sar1       0.2153 0.0838  2.5676  0.0110
sar2       0.2064 0.0865  2.3857  0.0180
constant  -0.1597 0.2338 -0.6830  0.4954

sigma^2 estimated as 2.540721 on 193 degrees of freedom 
 
AIC = 3.831405  AICc = 3.832463  BIC = 3.914735 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>Using corss validation, we can find that ARIMA(3,1,2)x(0,1,1)[12] is the better model since is stays at a lower RMSE for the majority of the time in the plot below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(res.fit)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">90</span>   <span class="co"># initial training size</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">27</span>, <span class="dv">4</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">27</span>, <span class="dv">4</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>) {</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># training = first (k+i-1) observations</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> y[<span class="dv">1</span><span class="sc">:</span>(k<span class="sc">+</span>i<span class="dv">-1</span>)]</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test = next 4 observations</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  xtest  <span class="ot">&lt;-</span> y[(k<span class="sc">+</span>i)<span class="sc">:</span>(k<span class="sc">+</span>i<span class="sc">+</span><span class="dv">3</span>)]</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit ARIMA models</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ensure xtest length = 4</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(xtest)<span class="sc">==</span><span class="dv">4</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(fcast<span class="sc">$</span>mean)<span class="sc">==</span><span class="dv">4</span>) {</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>    rmse1[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>    rmse2[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="co"># final RMSE</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse1, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4349659 0.6892734 0.7957192 0.9767644</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse2, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6071023 1.2748308 1.8310820 2.4632184</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### RMSE Plot using Plotly #####</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for RMSE values by quarter</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>qr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Q1"</span>, <span class="st">"Q2"</span>, <span class="st">"Q3"</span>, <span class="st">"Q4"</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>rmse11 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>rmse22 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an interactive RMSE comparison plot</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse11, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"blue"</span>), <span class="at">name =</span> <span class="st">"RMSE1: ARIMA(3,1,2)x(0,1,1)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse22, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"RMSE2: ARIMA(0,1,1)x(2,0,0)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cross-Validation RMSE"</span>,</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Quarter"</span>),</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"RMSE"</span>),</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Model"</span>)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-23a23e61291ba7fb199f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-23a23e61291ba7fb199f">{"x":{"visdat":{"46e4281f2361":["function () ","plotlyVisDat"],"46e451795287":["function () ","data"],"46e42c8a4968":["function () ","data"]},"cur_data":"46e42c8a4968","attrs":{"46e451795287":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["blue"],"name":"RMSE1: ARIMA(3,1,2)x(0,1,1)[12]","inherit":true},"46e42c8a4968":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["red"],"name":"RMSE2: ARIMA(0,1,1)x(2,0,0)[12]","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cross-Validation RMSE","xaxis":{"domain":[0,1],"automargin":true,"title":"Quarter","type":"category","categoryorder":"array","categoryarray":["Q1","Q2","Q3","Q4"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"RMSE"},"legend":{"title":"Model"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Q1","Q2","Q3","Q4"],"y":[0.43496588506477674,0.68927344777388766,0.79571922986072607,0.97676444850212452],"type":"scatter","mode":"lines","name":"RMSE1: ARIMA(3,1,2)x(0,1,1)[12]","marker":{"color":"rgba(0,0,255,1)","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Q1","Q2","Q3","Q4"],"y":[0.60710232131929009,1.2748308166852749,1.8310820187100665,2.4632184238358743],"type":"scatter","mode":"lines","name":"RMSE2: ARIMA(0,1,1)x(2,0,0)[12]","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the dependent variable (TotalVehicleSales)</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> ts_icln</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define external regressors (all variables except TotalVehicleSales)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>xreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ts_xle, ts_wti, ts_np)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,1,0)x(0,0,1)[12] with external regressors</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">#fit1 &lt;- Arima(y, order = c(2,1,2), seasonal = list(order = c(2,0,1), period = 12), xreg = xreg)</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y 
Regression with ARIMA(3,1,2)(0,1,1)[12] errors 

Coefficients:
         ar1      ar2     ar3      ma1     ma2     sma1  ts_xle  ts_wti   ts_np
      1.0823  -1.2256  0.4413  -0.8236  0.9999  -0.7606  0.2426  0.0155  3.8612
s.e.  0.0701   0.0558  0.0748   0.0382  0.0754   0.0864  0.0452  0.0116  1.7681

sigma^2 = 1.781:  log likelihood = -320.74
AIC=661.49   AICc=662.75   BIC=693.69

Training set error measures:
                    ME     RMSE       MAE      MPE     MAPE      MASE
Training set 0.1085876 1.258076 0.8648417 1.402574 7.687605 0.2802767
                   ACF1
Training set 0.00117064</code></pre>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<p>The ARIMAX model suggests a mild downward trend in future ICLN values, driven largely by the projected behavior of the external energy market indicators (XLE, WTI, and HH).</p>
<p>Although the short-term forecast remains relatively tight, the confidence bands expand substantially over longer horizons, reflecting the inherently high volatility of renewable-energy equities and the uncertainty in future energy-market conditions.</p>
<p>Overall, the model produces a smooth and stable forecast trajectory without unrealistic jumps, indicating a reasonable and well-behaved dynamic specification.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model to each external regressor</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>xle_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_xle"</span>])</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(FinR_fit)</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>fxle <span class="ot">&lt;-</span> <span class="fu">forecast</span>(xle_fit, <span class="at">h =</span> <span class="dv">32</span>)  <span class="co"># Forecast next 32 periods</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>wti_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_wti"</span>])</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(Imp_fit)</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>fwti <span class="ot">&lt;-</span> <span class="fu">forecast</span>(wti_fit, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>hh_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_np"</span>])</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(CPI_fit)</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>fhh <span class="ot">&lt;-</span> <span class="fu">forecast</span>(hh_fit, <span class="at">h =</span> <span class="dv">32</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create future external regressor matrix using forecasted values</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>fxreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">XLE =</span> fxle<span class="sc">$</span>mean, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">WTI =</span> fwti<span class="sc">$</span>mean, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">HH =</span> fhh<span class="sc">$</span>mean)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,0,2)x(0,0,1)[12] with external regressors</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast TotalVehicleSales using future external regressors</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg =</span> fxreg, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forecast</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ICLN Prices Forecast"</span>) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="var-the-dynamic-relationship-between-clean-and-traditional-energy" class="level2">
<h2 class="anchored" data-anchor-id="var-the-dynamic-relationship-between-clean-and-traditional-energy">(3) VAR: The dynamic relationship between clean and traditional energy</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/electric.csv"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">str_extract</span>(Description, <span class="st">"(?&lt;=From ).*?(?=,)"</span>),</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>wind_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Wind"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>ts_wind <span class="ot">&lt;-</span> <span class="fu">ts</span>(wind_df<span class="sc">$</span>Value,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(wind_df<span class="sc">$</span>Year), <span class="fu">min</span>(wind_df<span class="sc">$</span>Month)),</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>solar_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Solar"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>ts_solar <span class="ot">&lt;-</span> <span class="fu">ts</span>(solar_df<span class="sc">$</span>Value,</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(solar_df<span class="sc">$</span>Year), <span class="fu">min</span>(solar_df<span class="sc">$</span>Month)),</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>coal_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Coal"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>ts_coal <span class="ot">&lt;-</span> <span class="fu">ts</span>(coal_df<span class="sc">$</span>Value,</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(coal_df<span class="sc">$</span>Year), <span class="fu">min</span>(coal_df<span class="sc">$</span>Month)),</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)     </span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>n_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Natural Gas"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>ts_n <span class="ot">&lt;-</span> <span class="fu">ts</span>(n_df<span class="sc">$</span>Value,</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(n_df<span class="sc">$</span>Year), <span class="fu">min</span>(n_df<span class="sc">$</span>Month)),</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)        </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">VARselect</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Initial selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>From a time series perspective:</p>
<ul>
<li>The rise of clean energy is accompanied by the decline of traditional energy;</li>
<li>There are potential substitution and synergistic relationships among different energy sources;</li>
<li>Their mutual influences can be further analyzed using a VAR model.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> n_df<span class="sc">$</span>Date, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">solar =</span> <span class="fu">log</span>(solar_df<span class="sc">$</span>Value), </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">wind =</span> <span class="fu">log</span>(wind_df<span class="sc">$</span>Value),</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coal =</span> <span class="fu">log</span>(coal_df<span class="sc">$</span>Value),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">natural_gas =</span> <span class="fu">log</span>(n_df<span class="sc">$</span>Value)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>plot_1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df1, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>solar, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Solar'</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>plot_2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df1, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>wind, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Wind'</span>) </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>plot_3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df1, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>coal, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Coal'</span>) </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>plot_4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(df1, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>natural_gas, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">'Natural Gas'</span>) </span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="fu">subplot</span>(plot_1, plot_2, plot_3, plot_4, <span class="at">nrows =</span> <span class="dv">4</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Trend of Power Generation"</span>, <span class="at">showlegend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Date'</span>),</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Solar'</span>),</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Wind'</span>),</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis3 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Coal'</span>),</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis4 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Natural Gas'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-6ab297589c8cfbea282e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6ab297589c8cfbea282e">{"x":{"data":[{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01","2025-02-01","2025-03-01","2025-04-01","2025-05-01","2025-06-01"],"y":[2.2103601489515285,3.051498051459848,3.3089358832358498,3.6071812101294309,4.0020830637957951,4.0639540808980321,4.4122648177344921,4.1949739035040254,4.1222190989880803,3.6928963754718702,2.9948819120991521,2.7296159790167707,1.8718021769015913,2.5311539009533202,3.4499240517523888,3.6573629868961435,4.3951032616854491,4.5124297016863677,4.5217233575309894,4.4461627310994896,4.171351898582885,3.0355777914761144,2.6594900104868331,1.3952541024913625,2.4265710727750367,3.159762560375694,3.7931718995878208,3.8255496654888019,4.0542167711313217,4.5595764079293719,4.4489490308720825,4.3164876132027272,3.9628681994337147,3.4325668414082129,3.3384350599258399,1.4602416060719736,2.5815038797756698,2.8808824318750488,3.9125628596806128,4.099481346327253,4.2189487254466318,4.5073588809761693,4.1336774485709133,4.127005344461649,4.0227948533820248,3.5677282525497858,2.6412691674118589,1.4471542493766532,2.5344901499768282,2.3852704596126535,3.9689513928140383,4.0413304898994458,4.4039838020259241,4.4759267298669334,4.4079745565946808,4.2883476237898934,4.1048228065097279,3.5121721081044499,2.7305941655371044,2.0487245690177756,2.1596380836741127,2.5712372395390211,3.6417092271374569,4.0649672435114237,4.396336261853989,4.4827313287955137,4.2812251552437024,4.3286917840436354,4.1126427905034761,3.6287312812776582,2.5459233515937747,1.0271162869630397,2.5599368156379927,2.9721053429228346,3.5086756532909833,3.9526657838901627,4.2589404999108975,4.2442290117593924,4.1215705484756917,4.4187562668906057,3.9887988442301956,3.4745407758863651,2.7527685947904748,0.99805503367679471,2.5527210493718568,2.9571993238372074,3.881316344648984,3.9975399329509087,4.4330999048578823,4.4362543693769769,4.4519374180840874,4.3196590885970121,4.2226205024506678,3.8965641303656002,3.1905586514864201,1.6867692553704239,2.7904900333754679,3.5791203901211968,4.3121405072097154,4.5447936583937398,4.5925306424416279,4.8533106938192638,4.7084304977608777,4.656642464357053,4.528256743719119,4.0983863830484326,3.3620406664609614,2.9278280949401183,1.9726911717329554,3.4158889304051452,4.3580796815104081,4.5993130665036936,4.7043365574825904,4.6387306795100525,4.7973430588324204,4.7560956704596551,4.5538137317112604,4.2209918973354652,3.6988792886922699,3.0544256198932094,2.2890945028115466,3.4911599551398851,4.3307201823050283,4.7209868451483556,5.0315614729784324,5.1707850860693343,5.0837742254529976,5.0523720700763368,4.9242128345697811,4.3232846146501185,4.341139533867592,3.7932619917070736,3.6834145486828689,4.4461627310994896,4.8064770426931265,5.0999030125208238,5.2505389403990455,5.4061533157904336,5.2528073169162131,5.4344335407446156,5.2242401631517206,5.0680233112049864,4.6762808134460441,4.7929269452719856,4.5572396522305416,4.9070509778396856,5.4434042367317659,5.7643223870025375,6.1368562646920042,6.2673295724754814,6.2334494795555484,6.1342891859409523,6.1270940496597275,6.0670983189228629,5.8501198528416136,5.8544184135832378,5.736004394317229,6.0699129075621006,6.4287496530721873,6.5023986649882737,6.6236760418511027,6.7692802581680853,6.7200355783915615,6.8502236190239332,6.8551758947776067,6.8952099139384364,6.7145976231581841,6.7452610550615297,6.6215640946042145,6.7274221439666357,7.1831830735318656,7.3045811763434001,7.4671739046252092,7.5618112580018098,7.4886845970429148,7.5387514859432088,7.5133060023354892,7.4482890142308422,7.229577874553649,6.9390058532535335,7.0521594728927219,7.302195839472847,7.6363936304367348,7.7744851097454362,7.8257042352419814,7.8468238157622165,7.8736221517793412,7.8963863931716958,7.7039661394910883,7.5546386015722033,7.4556807145331536,7.3587640171249635,7.3037099727929879,7.7149286693794208,7.8699566044676645,7.9654351503669556,8.1389101799258938,8.1529174343446602,8.2801517604204093,8.2863163148747407,8.1983833719057557,8.0681598212447927,7.9255710203554521,7.792977545646834,7.7510390938572717,7.9197920956402355,8.4149577875059087,8.4983524133946986,8.6630283068597542,8.7185620249414715,8.6249898173463961,8.5883107109059491,8.5290112818704742,8.4445521735280078,8.0736364205374631,8.0179683509387001,8.1074112793023314,8.2678119219506065,8.5283780075036155,8.7089248341474512,8.8318596872769657,8.9112153445952877,8.8180198934530516,8.809177197269193,8.6929769231303275,8.5111129441196223,8.2275799220702286,8.0422622428460713,8.1831761782656329,8.2521262580271131,8.6824747214168045,8.8176349122176116,8.8765301689972702,8.9835769016538016,9.0036409960392003,8.9716457775595053,8.8272070431025718,8.7149723285318998,8.3811427429186782,8.1470204173973784,8.4026522195867752,8.6236067724060828,8.7561541848121553,8.9772385260270937,9.1750660854275203,9.1751282377242855,9.269530836468693,9.1394265852838146,8.953164484572314,8.865761263287057,8.6598238845534805,8.5353126382527389,8.6232175866572387,8.7531198100696788,9.1373590572132937,9.295757595645016,9.4300508369876006,9.4089270154917095,9.4085091128859624,9.3898937676115306,9.3249405699967394,9.1343270935710343,8.9612507384316693,8.7145453867425626,8.9646477403139926,9.1079486672570411,9.3668501526498282,9.5031318441856261,9.62378740625266,9.6836094762501261,9.6655774478411516,9.5820660531967672,9.4944762892453678,9.3877751746798754,9.0362861067566485,8.8213098728113977,8.9626537125202539,9.1521377896526026,9.4102408436193823,9.6199064595611503,9.7573656886671696,9.7888452047522829,9.846616203371525,9.7838055837970188,9.6539245610225954,9.5553979347051179,9.2539849392873439,9.1174031444922008,9.1839557387258708,9.4326139449689705,9.6703150666545596,9.8574999998795647,10.008258159231872,10.097969743187607,10.094127457408314,10.088111955742738,9.9165939867601747,9.8794411411128014,9.5380846303667717,9.4682379062099713,9.6392261947244471,9.7034685557833456,10.046175557637364,10.189104819743994,10.295398111392332,10.361272840937325],"mode":"lines","name":"Solar","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01","2025-02-01","2025-03-01","2025-04-01","2025-05-01","2025-06-01"],"y":[6.4696936293709442,6.5594792509103756,5.8579874387243294,5.7993168717461936,6.0114999904376605,6.1025742544462105,5.940005449502153,5.9306975714097137,5.8063992296429641,6.0196121599151811,6.7129962970785444,5.949735891694929,5.9642218107141076,6.0666694174488649,6.2768690278157049,6.5289734836321198,6.4536706671412203,6.5067312944692128,6.4536124003881339,6.3581992218560828,6.19487262887088,6.4082470380265235,6.1536854321949335,6.4226899902708876,6.6987636156448325,6.5707863190143065,6.7477062379735102,6.9318789492677197,6.9825296718853576,7.0267074087593731,6.7917325680446634,6.8841703277084063,6.6009977547779428,6.5989925629191175,6.4860799929972579,6.6269746698844756,6.449425642744937,6.6138874474432701,6.9432228038814667,6.9964673755945936,6.9141179939116144,6.9538226922080106,6.8600303472511204,6.7037143551194118,6.7968840516502915,6.7992353331323869,6.8684248798135643,7.0074929158449279,6.9072001249126291,6.9290949597003673,7.1633458847035358,7.1661555433259565,7.4393542352281372,7.242229807226348,7.059935447197411,6.9572299707138709,6.9935797018203143,6.9362193074201866,6.8375506021269832,7.0664746492883603,7.0313604442130009,6.8736626745742857,7.3528423018027551,7.4369142158365547,7.4653289832833352,7.4938315931791246,7.2590753109375612,7.0370557337988391,7.2918925572638491,7.2766877910440089,7.3837975140926213,7.5108759962901113,7.7759614576848568,7.5610997370542217,7.7658370689343075,7.8126865356253745,7.8073811197132823,7.6264561647004463,7.5781782084565261,7.4116692723647244,7.5385716329858194,7.8006258883069499,7.8401118611680856,7.8126574061830318,7.8047877553628924,7.8319320342744172,8.0219429721629716,8.0620239465929515,7.9903536939541793,7.8710883627771047,7.6771095127970712,7.9007718391468629,7.9609244957127832,8.1246067955314292,8.0375548167150228,8.1577234886317651,8.360114729815642,8.2562826098396016,8.4726183303600049,8.5612640466684802,8.5830341140606468,8.5448815075247246,8.2961476876602429,8.0908330956034469,8.0428447772471827,8.4672465688064431,8.5159215832651789,8.7972309705652343,8.6912851443900809,8.6745686659991108,8.8677180824893718,8.9170017983097054,8.7422486738247969,8.6304186571105657,8.5081405395287177,8.6060231471220625,8.4447747450558346,8.8266797097172063,8.8356735403623325,8.8401542764087342,8.8326368695946655,8.6000365275124508,9.0582465586812155,9.1865041325935799,9.0707937814111581,8.9933057481100835,8.8134222838081779,8.8077493796374871,8.8686246925039764,8.9801480362486394,9.1847783290407605,9.111546802207485,9.0537444549918131,9.2545067199070896,9.2633735219368578,9.4271967604372655,9.3734927857803978,9.3042922660916556,8.9211410156979127,8.9191312869215746,8.8347780360713255,9.2615494178149245,9.4285560411996947,9.2738572776923842,9.5200913253598074,9.3103408080392747,9.5487639178403221,9.450068279463796,9.4367046511737076,9.3903392334004927,9.0851266344089581,9.0442171902520307,9.0813546321995062,9.4442973271334498,9.3629324377954326,9.5835245455335301,9.5982186680552974,9.5521974414691702,9.6649545004920974,9.7685994685934165,9.6951526844130331,9.5286563481523956,9.314124906427752,9.173041746428451,9.3651263642354685,9.5203966154108315,9.667971526846058,9.5444569075397077,9.7931822761188201,9.5474309887895199,9.7833451545220207,9.8328262721716477,9.6551138176036293,9.6676903427941827,9.408157253728378,9.2272487168356516,9.3518197951582032,9.5824507443947926,9.8451658800201365,9.5963677182166798,9.6265572059063871,9.6105614206754044,9.6361262084371102,9.7907190542950477,9.7498316419570425,9.5045957428869663,9.5233574603891959,9.4788417656816808,9.5447796148939723,9.7038187383566061,9.8874453619269218,9.9083941454972901,9.8237082518345957,9.9103751782905025,9.9960397963652259,9.9426747555125647,9.8441567277782127,9.6991314688099557,9.776696648831452,9.5170399106246482,9.7052585404042748,9.9201179969132554,9.8733191275123691,10.049556736293013,9.9426491774052703,10.002930498866085,10.155436884778407,10.141635689914461,10.046186005228421,9.9105499053110115,9.6878157679216308,9.5381212334981882,9.7932135967883518,10.101054924029381,10.026362800842252,10.007878243065557,10.150301613783903,10.051454394646726,10.183529412754819,10.182287432346957,10.083854199738889,10.114674143462086,9.7078724670256324,9.8957797737822997,9.8265887434635442,9.9614685890403649,9.9995126585379879,10.098490196720256,10.098291298330302,10.026711448718947,10.157070217533168,10.272126353278843,10.157330498087898,10.018866367034276,10.00336555665546,9.9023884987977695,10.106977959780984,10.226459026903761,10.13397840619812,10.190313258410701,10.244286522475125,10.278854041060914,10.286017754881794,10.300659332536833,10.25335203282541,10.316007880612919,10.037415029209006,10.044523986749248,10.051302978381454,10.268917266395134,10.408176535579392,10.373823782714041,10.310966331846888,10.19299923772529,10.576565894368775,10.495648165543107,10.427816830183287,10.191352133332249,9.985783964862275,10.206222829846924,10.274975347478092,10.380190907166682,10.484336065139022,10.59285329245288,10.529862278586368,10.535945487316555,10.669665561052504,10.74002259387672,10.648365759165131,10.427254998476995,10.291296979010044,10.115303831848662,10.215781770926291,10.396494380310713,10.626165549509125,10.563065850217923,10.55471779038044,10.631622195790241,10.682439722275799,10.663019369426371,10.380565505889557,10.223647971887956,10.240122668748883,10.253939403133925,10.25249979784466,10.4918258708051,10.503569898117318,10.546350482084561,10.461114421024767,10.634938439388591,10.728557792420705,10.765973755300067,10.563403258592668,10.549553922149641,10.238907056657451,10.266878563125697,10.274885784958522,10.5979794036213,10.620364467633976,10.605174862161148,10.683502122636675,10.582028809017187,10.833518947621915,10.730542245603644,10.516143318518649,10.487136697473177],"mode":"lines","name":"Wind","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01","2025-02-01","2025-03-01","2025-04-01","2025-05-01","2025-06-01"],"y":[12.090380390792308,11.978563095850708,11.963269236977654,11.864518672731743,11.954600971315346,12.036869970662963,12.069885529592165,12.108800458748323,11.99570868625918,11.977490519442213,11.955052438247739,12.058766327032675,12.085525793424329,11.91662557638772,11.952914446405114,11.854176649919864,11.928954009673191,11.999145666944619,12.09547851392081,12.117875509442374,11.945735385799802,11.911237154949037,11.878380734781082,11.966560544968345,12.009802370113807,11.870941256570822,11.928246186574727,11.865725067464068,11.92772289121886,12.011684758494559,12.118304811590024,12.100464582568375,12.015918346748302,11.977283783140699,11.957955169404769,12.056352432507827,12.107980942373993,11.963889498487141,11.951191847448717,11.863300472919905,11.920142218052193,11.997107054009584,12.110950202602179,12.129903140646556,12.013155161650642,11.978688503105504,11.971761935452911,12.079893995122971,12.104357815167422,11.992279566972412,11.946578980446986,11.859849717046604,11.964105390992227,12.029585471575901,12.108965868310777,12.090557091568039,12.009162732231127,11.967847784563558,11.966774267348539,12.082521009068465,12.083983579090926,11.956444028328075,12.005257328499717,11.871181830801937,11.944434870105601,12.071780946803347,12.133989774551122,12.141927401715604,12.053249005629143,11.998044238931127,11.975385254626053,12.089343192161001,12.039049948101695,11.974242657374656,11.991176955650523,11.859533545646155,11.964063216158184,12.041749017955778,12.143243979090879,12.151906438805444,11.992819732693517,11.991576962133404,11.979419925529353,12.06398446781639,12.076757711138724,12.00519689737949,11.981747609037143,11.893069626627639,11.967265057502296,12.064007134977954,12.128401807747997,12.155488657420175,12.039966542753794,11.996797210811398,11.979061970271431,12.0658323182472,12.116560894299489,12.023749218734471,11.987563607001784,11.898072376099002,11.950637674461193,12.049671897029274,12.137437510048066,12.103909750917541,11.991370533551802,11.930587322736777,11.946532177394428,12.030443027682661,12.054814486661119,11.855917721420276,11.816950717135517,11.74352096541314,11.788077295809188,11.905553671485642,11.971829401161546,12.00310225947212,11.82879147263678,11.849080344096022,11.826345274411272,12.022354329722354,12.062895804771022,11.938481779646601,11.880381514375296,11.751563435388087,11.872503648427676,12.01667504649502,12.098490213242814,12.088107018204946,11.909993227186266,11.792599319570915,11.814399822567506,12.027293323608054,12.048264245225308,11.837261186850196,11.811882962721896,11.731966669153227,11.828477280510784,11.970699700332982,12.081562269477489,12.051058040960713,11.856097699253061,11.749000822870858,11.707362589307861,11.797568293595857,11.768272783539439,11.642830702283101,11.566708354243046,11.475072402556171,11.661195864070493,11.784943260728548,11.985739285676578,11.932826242286323,11.740766828265741,11.70354036175404,11.765449674503939,11.806183771291336,11.835768248273942,11.724375351106662,11.780151430654621,11.624777015207336,11.691176247393702,11.837059150924503,11.937322579664258,11.914556920681177,11.798934416034699,11.703516014217199,11.703047601312722,11.862593573270138,11.964621076808758,11.872657141338593,11.823659299675418,11.601674092066665,11.685077158565553,11.831938472391885,11.915901197151648,11.908014413106207,11.744912873835593,11.619948220341831,11.687949115038618,11.733025316927503,11.793964428252313,11.751759923602378,11.594390597440857,11.396269652508998,11.557750894240703,11.741439481485767,11.842947436142579,11.810584914939117,11.678318133322257,11.479973503670172,11.376270754147228,11.401938852468295,11.639200166384754,11.437175616444106,11.186814740002305,11.185987698486676,11.310742081527847,11.661641839959715,11.82273418268343,11.817720764757244,11.645161488966959,11.504832243022339,11.372978818538325,11.684749127859059,11.655577210448083,11.371617513138077,11.400480133391413,11.306335555474947,11.437949095868998,11.585323537507037,11.757421970614148,11.690974448977082,11.494782329156061,11.405067655891507,11.418464653350599,11.576326154648031,11.689263447502173,11.315086314675435,11.297572277320077,11.202943330827527,11.353077084028282,11.527847840440801,11.655954898061228,11.653812478563173,11.477754059095012,11.376689011250408,11.43840226508294,11.516106400426468,11.521931825671256,11.288899136623005,11.26896192402223,11.00080667208803,11.182817682177578,11.271357012858685,11.520603761260976,11.451472376319897,11.358686187885015,11.109117448127636,11.232541218489878,11.192454821250228,11.084290379099709,10.936698156537076,10.834285109746876,10.613373898270359,10.747780029851928,11.086489548508007,11.404331761522567,11.420211433255226,11.133226709859997,10.998837676124861,11.021611347697496,11.271969574172394,11.30516029535581,11.379056872643133,11.033339495394506,10.895926662091565,11.064647632152692,11.376700184228048,11.528173983133513,11.531301575274687,11.275642927622133,11.044075458046306,10.958258483964824,11.002509690537858,11.380401872915499,11.169961494567799,11.018936866295629,10.921054884224395,11.043429610784914,11.204538572769019,11.36691621524465,11.35292864639279,11.082116687004897,10.900961086544459,10.939815896597876,11.203418853736181,11.024465080895515,10.744497686538143,10.821688518750372,10.602433015519605,10.68747263168815,10.964250853471981,11.275977279133309,11.265895298974549,11.001414022751183,10.838261276665143,10.843677528708707,10.939600554968656,11.234414224922151,10.693264314834007,10.555542129047696,10.527349068749476,10.734497394718,11.025049358250111,11.180054850713653,11.139510615952622,10.908303791193299,10.756994702465718,10.714299717340218,11.049118119049533,11.328396577814086,11.039113071582342,10.802306986253262,10.732894702890828,10.794338171511155,11.073434062923631],"mode":"lines","name":"Coal","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y3","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01","2025-01-01","2025-02-01","2025-03-01","2025-04-01","2025-05-01","2025-06-01"],"y":[10.575579443045408,10.470416618855499,10.659327685030526,10.687127463968251,10.986210657389247,10.987634436562077,11.155366816393832,11.245599396085497,10.92752517042006,10.680483917704581,10.528418577744175,10.571724021723892,10.654636223391616,10.544470717635667,10.700192940571812,10.732972253608409,10.838289980774352,10.961332602129321,11.198627539018673,11.269704249540681,11.005114293175104,10.939806637453913,10.703033704372173,10.769344851814548,10.787520181532518,10.698930231383448,10.843777251606253,10.802559060851216,10.825267948592851,11.091803698546618,11.33758669964265,11.344233024389199,11.129629754675388,10.900451316464585,10.717986371486422,10.738576732202384,10.823287041516144,10.68158628802475,10.751478586908439,10.718750236711518,10.80715826591018,10.905092305038611,11.250758794979664,11.329599720148202,10.986815985862322,10.855611902443151,10.721678413032304,10.69273771218834,10.784220990335582,10.826155407269487,10.815794098070052,10.85556981694643,11.03524134411602,11.077294956727213,11.280867573728885,11.262162587414396,11.125113513936704,10.954812791791596,10.81362004129546,10.845632466020518,10.84617923208693,10.712474036483785,10.857015743753665,10.859312140836783,10.911919885931908,11.233680936121418,11.480602769692842,11.520761225059996,11.203072531970307,10.932050715648741,10.808519663318535,10.896602297639998,10.687547097580318,10.766567131053732,10.913664578242678,10.93472808357331,11.091111514876975,11.302947490852519,11.590752001827228,11.576760607545086,11.193729993830567,11.165352387372819,10.886309063433547,10.935393389580412,11.026378254204664,10.961660950373725,10.936740022894456,11.004644068577857,11.104501498755614,11.308498792426807,11.487429959147331,11.706338837838832,11.39111499884241,11.269043654793103,11.01265723198366,11.10957553828778,11.192718837175594,11.002799796178589,11.03763717647835,11.051621452087003,11.039242226257306,11.345925652470665,11.516129107822069,11.509655052998065,11.278923549415289,11.202088563266292,11.026047444636875,11.072304249594989,11.103303423775321,11.037126724456758,11.130240062964102,11.021226978970818,11.129402561276883,11.34101174227966,11.531686697261637,11.601298492825737,11.43091919243103,11.192757748317337,11.055405699026696,11.178705188781644,11.214151922279992,11.100406738483356,11.057702619744864,11.076650959201954,11.207289012959658,11.432457335984543,11.649414247702472,11.704795200808055,11.440399685105286,11.261103812358522,11.145139882996515,11.258978832620588,11.215251425331832,11.096257584481336,11.096608487745373,11.15666470667335,11.22847545709935,11.415214637916778,11.69210535021149,11.694044574113686,11.42670363075511,11.274911989800135,11.231110122885728,11.363515831931739,11.415983678819902,11.41431745529775,11.432264640468507,11.459826288326855,11.583866682531029,11.657869634641102,11.841242034365692,11.788554166529536,11.590000397768604,11.426554293914132,11.291897935801224,11.338442271781963,11.391424840134377,11.293314093158758,11.347169053419533,11.264931073548334,11.336374331215284,11.50906867711624,11.701651312114629,11.704837527161864,11.533347831560883,11.391744936867017,11.341980370135731,11.439669494375462,11.419301165271103,11.237767438227293,11.266440881331896,11.248762621027938,11.397747841029158,11.497502703244173,11.653412761603674,11.714641109737183,11.576685683308737,11.489500193214097,11.342799522433671,11.41905655603588,11.529693817035207,11.423440146673459,11.508416766045777,11.43880029574556,11.529041875135979,11.7082275013007,11.858224671866905,11.843781136750987,11.7208402936798,11.609232901893787,11.536337667942052,11.60725428157699,11.60863326571287,11.499720653936816,11.551502923202493,11.502610437523341,11.612938505333622,11.786936997439136,11.929766712066384,11.950703023912988,11.741521731177601,11.54149334923021,11.450526871220612,11.476428116091766,11.468568552900944,11.324629798667027,11.463884369320125,11.391462328542051,11.493478757527063,11.672928923822864,11.898472199483869,11.85869596699656,11.679555425089911,11.579604184872702,11.462393007388727,11.622257657069124,11.61224561227929,11.499589798930698,11.578170136724756,11.499552291368692,11.657585288769592,11.783606762219751,12.014157775704604,11.99535552778711,11.86418205812293,11.722217087768115,11.592337315233529,11.607827352343632,11.710203587614076,11.629793940321578,11.66185521945456,11.555492802692532,11.672461466458564,11.835642234595765,12.056885887532028,12.074084336025997,11.917978034662788,11.783817708786669,11.67809006259961,11.790355878274031,11.821026004461725,11.759925595593918,11.745516884290627,11.61334814455668,11.671514674221717,11.870987407581438,12.109385870653481,12.064764906777166,11.859330033697059,11.786097111044374,11.606513981744749,11.758716002397165,11.748231536066115,11.618932006908134,11.580758967315093,11.584466920722248,11.649864225916343,11.914218923836717,12.044666996106109,12.059403934999928,11.836561446820028,11.789432941036528,11.715321336006332,11.756549296275098,11.812641322613722,11.652212755585627,11.630506417987068,11.566521652163475,11.752658825257521,11.954510303664092,12.14972551780275,12.148759526194535,11.963668946376194,11.801793264170122,11.756055461979098,11.85449866239877,11.838644774100885,11.736354207613525,11.80334935769514,11.695343950399785,11.830605085633472,11.995236255709132,12.203677489432515,12.202169186938846,12.021614766423824,11.855272170206485,11.816957719233805,11.905164540099726,11.983775642043218,11.782854169858069,11.77992760400533,11.70587449953924,11.874911078308063,12.039469362876874,12.2439335788325,12.221330180111584,12.03997933553881,11.893740883733471,11.828038443802988,11.887003189266812,11.960981964492294,11.793126413466821,11.686205722116926,11.661003816904113,11.814278936505595,12.014366846144853],"mode":"lines","name":"Natural Gas","type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Date","anchor":"y4"},"yaxis4":{"domain":[0,0.23000000000000001],"automargin":true,"anchor":"x","title":"Natural Gas"},"yaxis3":{"domain":[0.27000000000000002,0.47999999999999998],"automargin":true,"anchor":"x","title":"Coal"},"yaxis2":{"domain":[0.52000000000000002,0.72999999999999998],"automargin":true,"anchor":"x","title":"Wind"},"yaxis":{"domain":[0.77000000000000002,1],"automargin":true,"anchor":"x","title":"Solar"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":false,"title":"Trend of Power Generation"},"attrs":{"46e4633b1870":{"x":{},"y":{},"mode":"lines","name":"Solar","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e440c05477":{"x":{},"y":{},"mode":"lines","name":"Wind","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e461232ed":{"x":{},"y":{},"mode":"lines","name":"Coal","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e4f8717a9":{"x":{},"y":{},"mode":"lines","name":"Natural Gas","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>p-values are 8 and 10.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>df_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(df1[,<span class="sc">-</span><span class="dv">1</span>],  <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(df_ts, <span class="at">lag.max=</span><span class="dv">10</span>,<span class="at">type=</span><span class="st">"both"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
    10     10      6     10 

$criteria
                   1             2             3             4             5
AIC(n) -1.428807e+01 -1.530477e+01 -1.565413e+01 -1.589603e+01 -1.610793e+01
HQ(n)  -1.416827e+01 -1.510510e+01 -1.537460e+01 -1.553663e+01 -1.566866e+01
SC(n)  -1.398885e+01 -1.480607e+01 -1.495596e+01 -1.499837e+01 -1.501080e+01
FPE(n)  6.234172e-07  2.255628e-07  1.590812e-07  1.249405e-07  1.011326e-07
                   6             7             8             9            10
AIC(n) -1.631663e+01 -1.646116e+01 -1.654623e+01 -1.678099e+01 -1.696547e+01
HQ(n)  -1.579750e+01 -1.586215e+01 -1.586735e+01 -1.602225e+01 -1.612686e+01
SC(n)  -1.502002e+01 -1.496507e+01 -1.485065e+01 -1.488594e+01 -1.487094e+01
FPE(n)  8.214183e-08  7.115796e-08  6.543872e-08  5.183015e-08  4.318574e-08</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>The two VAR models (p=6 and p=10) showed almost identical fitting results. The log-likelihood of p=10 was slightly higher, but the improvement was limited, while the degrees of freedom were lower. The major significant lags were consistent in both models, indicating that lag order 6 was sufficient to capture the dynamic relationships between variables.</p>
<p>There is a certain degree of complementarity between renewable energy sources (wind–solar), while the relationship with fossil fuels (coal, gas) is more of a substitution relationship. The trend term indicates a long-term upward trend for renewable energy and gas-fired power, while the trend for coal-fired power may be a remnant of structural changes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">6</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: solar, wind, coal, natural_gas 
Deterministic variables: both 
Sample size: 300 
Log Likelihood: 846.733 
Roots of the characteristic polynomial:
0.9857 0.9745 0.9745 0.9587 0.9587 0.9485 0.8707 0.7832 0.7832 0.7822 0.7822 0.7719 0.7719 0.732 0.732 0.6747 0.6747 0.5963 0.5963 0.5845 0.5845 0.4804 0.4804 0.2438
Call:
vars::VAR(y = df_ts, p = 6, type = "both")


Estimation results for equation solar: 
====================================== 
solar = solar.l1 + wind.l1 + coal.l1 + natural_gas.l1 + solar.l2 + wind.l2 + coal.l2 + natural_gas.l2 + solar.l3 + wind.l3 + coal.l3 + natural_gas.l3 + solar.l4 + wind.l4 + coal.l4 + natural_gas.l4 + solar.l5 + wind.l5 + coal.l5 + natural_gas.l5 + solar.l6 + wind.l6 + coal.l6 + natural_gas.l6 + const + trend 

                Estimate Std. Error t value Pr(&gt;|t|)    
solar.l1        0.666376   0.059479  11.204  &lt; 2e-16 ***
wind.l1         0.604561   0.144261   4.191 3.75e-05 ***
coal.l1        -0.730183   0.218940  -3.335 0.000970 ***
natural_gas.l1  0.722294   0.237444   3.042 0.002578 ** 
solar.l2        0.296316   0.070905   4.179 3.94e-05 ***
wind.l2        -0.309613   0.161675  -1.915 0.056529 .  
coal.l2         0.133999   0.283950   0.472 0.637367    
natural_gas.l2 -0.007811   0.307132  -0.025 0.979730    
solar.l3       -0.141620   0.067057  -2.112 0.035597 *  
wind.l3        -0.225049   0.162553  -1.384 0.167342    
coal.l3         0.283589   0.285437   0.994 0.321330    
natural_gas.l3 -0.415407   0.306987  -1.353 0.177115    
solar.l4       -0.026099   0.066529  -0.392 0.695145    
wind.l4         0.113789   0.152737   0.745 0.456912    
coal.l4         0.200854   0.293784   0.684 0.494756    
natural_gas.l4 -2.086730   0.305552  -6.829 5.49e-11 ***
solar.l5        0.069203   0.066179   1.046 0.296625    
wind.l5        -0.079408   0.148268  -0.536 0.592690    
coal.l5         0.210534   0.289020   0.728 0.466966    
natural_gas.l5  0.083061   0.324333   0.256 0.798066    
solar.l6        0.064954   0.051313   1.266 0.206645    
wind.l6         0.054643   0.126214   0.433 0.665399    
coal.l6        -0.493583   0.227259  -2.172 0.030721 *  
natural_gas.l6  1.014926   0.268695   3.777 0.000195 ***
const          11.393589   3.698070   3.081 0.002273 ** 
trend           0.000760   0.002220   0.342 0.732380    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.2995 on 274 degrees of freedom
Multiple R-Squared: 0.9869, Adjusted R-squared: 0.9857 
F-statistic: 827.8 on 25 and 274 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation wind: 
===================================== 
wind = solar.l1 + wind.l1 + coal.l1 + natural_gas.l1 + solar.l2 + wind.l2 + coal.l2 + natural_gas.l2 + solar.l3 + wind.l3 + coal.l3 + natural_gas.l3 + solar.l4 + wind.l4 + coal.l4 + natural_gas.l4 + solar.l5 + wind.l5 + coal.l5 + natural_gas.l5 + solar.l6 + wind.l6 + coal.l6 + natural_gas.l6 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
solar.l1        0.0513208  0.0251019   2.045  0.04186 *  
wind.l1         0.5018787  0.0608825   8.243 7.01e-15 ***
coal.l1        -0.0776504  0.0923993  -0.840  0.40143    
natural_gas.l1 -0.2133073  0.1002086  -2.129  0.03418 *  
solar.l2        0.0080013  0.0299241   0.267  0.78937    
wind.l2         0.1545745  0.0682317   2.265  0.02427 *  
coal.l2         0.1224636  0.1198355   1.022  0.30772    
natural_gas.l2  0.0853286  0.1296190   0.658  0.51090    
solar.l3       -0.0609314  0.0282999  -2.153  0.03219 *  
wind.l3         0.0970459  0.0686022   1.415  0.15832    
coal.l3         0.3557968  0.1204633   2.954  0.00341 ** 
natural_gas.l3  0.3052957  0.1295581   2.356  0.01916 *  
solar.l4       -0.0376490  0.0280773  -1.341  0.18106    
wind.l4         0.0122900  0.0644596   0.191  0.84893    
coal.l4        -0.1795007  0.1239860  -1.448  0.14883    
natural_gas.l4 -0.1050877  0.1289523  -0.815  0.41582    
solar.l5       -0.0293746  0.0279296  -1.052  0.29385    
wind.l5         0.0581405  0.0625735   0.929  0.35363    
coal.l5         0.1522347  0.1219755   1.248  0.21307    
natural_gas.l5  0.1376406  0.1368783   1.006  0.31551    
solar.l6        0.0451076  0.0216557   2.083  0.03818 *  
wind.l6         0.0091771  0.0532663   0.172  0.86334    
coal.l6        -0.0488526  0.0959105  -0.509  0.61091    
natural_gas.l6  0.1837023  0.1133977   1.620  0.10639    
const          -7.0422660  1.5606993  -4.512 9.53e-06 ***
trend           0.0027848  0.0009371   2.972  0.00322 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.1264 on 274 degrees of freedom
Multiple R-Squared: 0.9925, Adjusted R-squared: 0.9918 
F-statistic:  1441 on 25 and 274 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation coal: 
===================================== 
coal = solar.l1 + wind.l1 + coal.l1 + natural_gas.l1 + solar.l2 + wind.l2 + coal.l2 + natural_gas.l2 + solar.l3 + wind.l3 + coal.l3 + natural_gas.l3 + solar.l4 + wind.l4 + coal.l4 + natural_gas.l4 + solar.l5 + wind.l5 + coal.l5 + natural_gas.l5 + solar.l6 + wind.l6 + coal.l6 + natural_gas.l6 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
solar.l1        0.0241314  0.0183068   1.318 0.188547    
wind.l1        -0.1061129  0.0444015  -2.390 0.017531 *  
coal.l1         0.8041752  0.0673867  11.934  &lt; 2e-16 ***
natural_gas.l1 -0.0525133  0.0730820  -0.719 0.473029    
solar.l2        0.0019566  0.0218236   0.090 0.928627    
wind.l2         0.0413746  0.0497613   0.831 0.406437    
coal.l2        -0.0911333  0.0873959  -1.043 0.297977    
natural_gas.l2 -0.1579287  0.0945310  -1.671 0.095932 .  
solar.l3       -0.0270749  0.0206391  -1.312 0.190677    
wind.l3         0.0022171  0.0500315   0.044 0.964687    
coal.l3        -0.2643752  0.0878537  -3.009 0.002863 ** 
natural_gas.l3 -0.0290466  0.0944866  -0.307 0.758761    
solar.l4        0.0404143  0.0204767   1.974 0.049424 *  
wind.l4         0.0009972  0.0470103   0.021 0.983092    
coal.l4         0.0937670  0.0904229   1.037 0.300658    
natural_gas.l4  0.0296592  0.0940448   0.315 0.752718    
solar.l5        0.0024752  0.0203691   0.122 0.903371    
wind.l5         0.0499362  0.0456348   1.094 0.274804    
coal.l5         0.1151827  0.0889566   1.295 0.196473    
natural_gas.l5  0.3103275  0.0998252   3.109 0.002077 ** 
solar.l6       -0.0504031  0.0157935  -3.191 0.001581 ** 
wind.l6         0.0774704  0.0388471   1.994 0.047117 *  
coal.l6         0.1138153  0.0699474   1.627 0.104854    
natural_gas.l6 -0.2903186  0.0827008  -3.510 0.000523 ***
const           4.4583973  1.1382163   3.917 0.000113 ***
trend          -0.0010678  0.0006834  -1.562 0.119326    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.09218 on 274 degrees of freedom
Multiple R-Squared: 0.9544, Adjusted R-squared: 0.9503 
F-statistic: 229.5 on 25 and 274 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation natural_gas: 
============================================ 
natural_gas = solar.l1 + wind.l1 + coal.l1 + natural_gas.l1 + solar.l2 + wind.l2 + coal.l2 + natural_gas.l2 + solar.l3 + wind.l3 + coal.l3 + natural_gas.l3 + solar.l4 + wind.l4 + coal.l4 + natural_gas.l4 + solar.l5 + wind.l5 + coal.l5 + natural_gas.l5 + solar.l6 + wind.l6 + coal.l6 + natural_gas.l6 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
solar.l1        0.0391879  0.0159229   2.461  0.01447 *  
wind.l1        -0.0543635  0.0386198  -1.408  0.16037    
coal.l1        -0.0901123  0.0586119  -1.537  0.12534    
natural_gas.l1  0.7444838  0.0635656  11.712  &lt; 2e-16 ***
solar.l2        0.0080173  0.0189819   0.422  0.67309    
wind.l2         0.0844389  0.0432816   1.951  0.05209 .  
coal.l2         0.0903476  0.0760156   1.189  0.23565    
natural_gas.l2 -0.2487026  0.0822216  -3.025  0.00272 ** 
solar.l3       -0.0357514  0.0179516  -1.992  0.04741 *  
wind.l3         0.0019920  0.0435167   0.046  0.96352    
coal.l3        -0.3080615  0.0764138  -4.031 7.19e-05 ***
natural_gas.l3 -0.0444770  0.0821830  -0.541  0.58881    
solar.l4        0.0502018  0.0178103   2.819  0.00517 ** 
wind.l4        -0.0350946  0.0408889  -0.858  0.39148    
coal.l4         0.0736715  0.0786484   0.937  0.34973    
natural_gas.l4 -0.0941891  0.0817987  -1.151  0.25054    
solar.l5        0.0271030  0.0177167   1.530  0.12722    
wind.l5         0.0056901  0.0396924   0.143  0.88612    
coal.l5        -0.0072301  0.0773731  -0.093  0.92562    
natural_gas.l5  0.1930333  0.0868264   2.223  0.02702 *  
solar.l6       -0.0943319  0.0137369  -6.867 4.39e-11 ***
wind.l6         0.0691229  0.0337886   2.046  0.04174 *  
coal.l6         0.0837026  0.0608392   1.376  0.17001    
natural_gas.l6 -0.1845832  0.0719319  -2.566  0.01082 *  
const           8.3283793  0.9900033   8.412 2.24e-15 ***
trend           0.0008903  0.0005944   1.498  0.13534    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.08018 on 274 degrees of freedom
Multiple R-Squared: 0.9623, Adjusted R-squared: 0.9589 
F-statistic: 279.9 on 25 and 274 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                 solar       wind       coal natural_gas
solar        0.0896971  0.0058168 -0.0004646   0.0007948
wind         0.0058168  0.0159760 -0.0010936  -0.0002216
coal        -0.0004646 -0.0010936  0.0084972   0.0033860
natural_gas  0.0007948 -0.0002216  0.0033860   0.0064284

Correlation matrix of residuals:
               solar     wind     coal natural_gas
solar        1.00000  0.15366 -0.01683     0.03310
wind         0.15366  1.00000 -0.09387    -0.02186
coal        -0.01683 -0.09387  1.00000     0.45814
natural_gas  0.03310 -0.02186  0.45814     1.00000</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: solar, wind, coal, natural_gas 
Deterministic variables: both 
Sample size: 296 
Log Likelihood: 998.866 
Roots of the characteristic polynomial:
0.9939 0.9939 0.9926 0.9926 0.9921 0.9921 0.9443 0.9443 0.9359 0.9359 0.9124 0.9124 0.8925 0.8925 0.8921 0.8921 0.8917 0.8917 0.8822 0.8634 0.8634 0.8366 0.8366 0.8351 0.8351 0.8343 0.8343 0.831 0.831 0.8309 0.8309 0.8208 0.8208 0.8188 0.8188 0.8081 0.8081 0.7883 0.5552 0.3708
Call:
vars::VAR(y = df_ts, p = 10, type = "both")


Estimation results for equation solar: 
====================================== 
solar = solar.l1 + wind.l1 + coal.l1 + natural_gas.l1 + solar.l2 + wind.l2 + coal.l2 + natural_gas.l2 + solar.l3 + wind.l3 + coal.l3 + natural_gas.l3 + solar.l4 + wind.l4 + coal.l4 + natural_gas.l4 + solar.l5 + wind.l5 + coal.l5 + natural_gas.l5 + solar.l6 + wind.l6 + coal.l6 + natural_gas.l6 + solar.l7 + wind.l7 + coal.l7 + natural_gas.l7 + solar.l8 + wind.l8 + coal.l8 + natural_gas.l8 + solar.l9 + wind.l9 + coal.l9 + natural_gas.l9 + solar.l10 + wind.l10 + coal.l10 + natural_gas.l10 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
solar.l1         0.469411   0.060173   7.801 1.60e-13 ***
wind.l1          0.323931   0.140364   2.308  0.02182 *  
coal.l1         -0.464254   0.213822  -2.171  0.03084 *  
natural_gas.l1   0.738487   0.259765   2.843  0.00483 ** 
solar.l2         0.213910   0.066494   3.217  0.00146 ** 
wind.l2         -0.267078   0.147515  -1.811  0.07140 .  
coal.l2         -0.087561   0.269046  -0.325  0.74511    
natural_gas.l2   0.521518   0.309049   1.687  0.09274 .  
solar.l3        -0.088878   0.067732  -1.312  0.19064    
wind.l3         -0.111252   0.151190  -0.736  0.46251    
coal.l3          0.164302   0.266014   0.618  0.53736    
natural_gas.l3   0.038453   0.302931   0.127  0.89909    
solar.l4         0.047979   0.067931   0.706  0.48066    
wind.l4          0.161359   0.152118   1.061  0.28981    
coal.l4          0.376810   0.273585   1.377  0.16963    
natural_gas.l4  -1.706834   0.298169  -5.724 2.92e-08 ***
solar.l5         0.056757   0.067317   0.843  0.39995    
wind.l5         -0.153677   0.151872  -1.012  0.31255    
coal.l5          0.183843   0.273730   0.672  0.50243    
natural_gas.l5  -0.135382   0.314156  -0.431  0.66688    
solar.l6        -0.031568   0.067423  -0.468  0.64003    
wind.l6          0.061584   0.151662   0.406  0.68504    
coal.l6          0.029804   0.273205   0.109  0.91322    
natural_gas.l6   0.110254   0.308885   0.357  0.72143    
solar.l7         0.033123   0.063451   0.522  0.60210    
wind.l7          0.015921   0.149322   0.107  0.91517    
coal.l7         -0.341113   0.275121  -1.240  0.21617    
natural_gas.l7   0.554164   0.309629   1.790  0.07468 .  
solar.l8         0.035558   0.064749   0.549  0.58337    
wind.l8         -0.158211   0.138608  -1.141  0.25477    
coal.l8          0.074260   0.277765   0.267  0.78942    
natural_gas.l8   0.107379   0.309601   0.347  0.72900    
solar.l9         0.042633   0.063000   0.677  0.49920    
wind.l9         -0.028429   0.134240  -0.212  0.83245    
coal.l9         -0.238635   0.279204  -0.855  0.39352    
natural_gas.l9  -0.240185   0.304766  -0.788  0.43137    
solar.l10        0.171275   0.059230   2.892  0.00416 ** 
wind.l10         0.340164   0.124616   2.730  0.00678 ** 
coal.l10         0.047831   0.219320   0.218  0.82754    
natural_gas.l10  0.702195   0.261208   2.688  0.00766 ** 
const           -5.326201   5.730715  -0.929  0.35356    
trend           -0.005101   0.002366  -2.156  0.03202 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.2659 on 254 degrees of freedom
Multiple R-Squared: 0.9904, Adjusted R-squared: 0.9888 
F-statistic: 636.3 on 41 and 254 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation wind: 
===================================== 
wind = solar.l1 + wind.l1 + coal.l1 + natural_gas.l1 + solar.l2 + wind.l2 + coal.l2 + natural_gas.l2 + solar.l3 + wind.l3 + coal.l3 + natural_gas.l3 + solar.l4 + wind.l4 + coal.l4 + natural_gas.l4 + solar.l5 + wind.l5 + coal.l5 + natural_gas.l5 + solar.l6 + wind.l6 + coal.l6 + natural_gas.l6 + solar.l7 + wind.l7 + coal.l7 + natural_gas.l7 + solar.l8 + wind.l8 + coal.l8 + natural_gas.l8 + solar.l9 + wind.l9 + coal.l9 + natural_gas.l9 + solar.l10 + wind.l10 + coal.l10 + natural_gas.l10 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
solar.l1         0.0346609  0.0265190   1.307  0.19239    
wind.l1          0.3769181  0.0618598   6.093 4.08e-09 ***
coal.l1         -0.1446995  0.0942333  -1.536  0.12589    
natural_gas.l1  -0.1688214  0.1144809  -1.475  0.14154    
solar.l2        -0.0049925  0.0293045  -0.170  0.86486    
wind.l2          0.1590953  0.0650111   2.447  0.01508 *  
coal.l2          0.0745632  0.1185710   0.629  0.53001    
natural_gas.l2   0.0605277  0.1362007   0.444  0.65713    
solar.l3        -0.0721746  0.0298502  -2.418  0.01632 *  
wind.l3          0.1504433  0.0666310   2.258  0.02480 *  
coal.l3          0.2658778  0.1172350   2.268  0.02418 *  
natural_gas.l3   0.3352673  0.1335047   2.511  0.01265 *  
solar.l4        -0.0206060  0.0299378  -0.688  0.49189    
wind.l4         -0.0020331  0.0670400  -0.030  0.97583    
coal.l4         -0.1640865  0.1205716  -1.361  0.17475    
natural_gas.l4   0.0327527  0.1314059   0.249  0.80337    
solar.l5        -0.0222273  0.0296671  -0.749  0.45442    
wind.l5         -0.0032179  0.0669313  -0.048  0.96169    
coal.l5          0.1363260  0.1206356   1.130  0.25951    
natural_gas.l5   0.0805770  0.1384515   0.582  0.56109    
solar.l6         0.0294412  0.0297140   0.991  0.32272    
wind.l6         -0.1007812  0.0668390  -1.508  0.13284    
coal.l6         -0.1085726  0.1204040  -0.902  0.36805    
natural_gas.l6   0.1222314  0.1361288   0.898  0.37008    
solar.l7         0.0224951  0.0279632   0.804  0.42189    
wind.l7         -0.0560930  0.0658078  -0.852  0.39481    
coal.l7          0.1258760  0.1212485   1.038  0.30018    
natural_gas.l7  -0.2776574  0.1364562  -2.035  0.04291 *  
solar.l8         0.0113736  0.0285356   0.399  0.69054    
wind.l8         -0.0291424  0.0610860  -0.477  0.63372    
coal.l8          0.0006783  0.1224135   0.006  0.99558    
natural_gas.l8   0.0596030  0.1364440   0.437  0.66260    
solar.l9        -0.0042397  0.0277646  -0.153  0.87875    
wind.l9          0.2487077  0.0591610   4.204 3.64e-05 ***
coal.l9          0.2169155  0.1230480   1.763  0.07913 .  
natural_gas.l9  -0.0730627  0.1343133  -0.544  0.58694    
solar.l10        0.0001728  0.0261034   0.007  0.99472    
wind.l10         0.1343605  0.0549197   2.446  0.01510 *  
coal.l10        -0.1713540  0.0966564  -1.773  0.07746 .  
natural_gas.l10  0.3021616  0.1151168   2.625  0.00919 ** 
const           -6.9893989  2.5255803  -2.767  0.00607 ** 
trend            0.0012874  0.0010427   1.235  0.21807    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.1172 on 254 degrees of freedom
Multiple R-Squared: 0.9936, Adjusted R-squared: 0.9925 
F-statistic: 958.6 on 41 and 254 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation coal: 
===================================== 
coal = solar.l1 + wind.l1 + coal.l1 + natural_gas.l1 + solar.l2 + wind.l2 + coal.l2 + natural_gas.l2 + solar.l3 + wind.l3 + coal.l3 + natural_gas.l3 + solar.l4 + wind.l4 + coal.l4 + natural_gas.l4 + solar.l5 + wind.l5 + coal.l5 + natural_gas.l5 + solar.l6 + wind.l6 + coal.l6 + natural_gas.l6 + solar.l7 + wind.l7 + coal.l7 + natural_gas.l7 + solar.l8 + wind.l8 + coal.l8 + natural_gas.l8 + solar.l9 + wind.l9 + coal.l9 + natural_gas.l9 + solar.l10 + wind.l10 + coal.l10 + natural_gas.l10 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
solar.l1         0.041145   0.018768   2.192 0.029268 *  
wind.l1         -0.078729   0.043780  -1.798 0.073319 .  
coal.l1          0.716246   0.066692  10.740  &lt; 2e-16 ***
natural_gas.l1  -0.133934   0.081022  -1.653 0.099556 .  
solar.l2         0.009747   0.020740   0.470 0.638789    
wind.l2          0.039820   0.046011   0.865 0.387607    
coal.l2          0.025867   0.083917   0.308 0.758144    
natural_gas.l2  -0.126521   0.096394  -1.313 0.190524    
solar.l3        -0.035307   0.021126  -1.671 0.095903 .  
wind.l3          0.007904   0.047157   0.168 0.867032    
coal.l3         -0.131040   0.082971  -1.579 0.115501    
natural_gas.l3  -0.110102   0.094486  -1.165 0.244999    
solar.l4        -0.007382   0.021188  -0.348 0.727810    
wind.l4          0.007310   0.047447   0.154 0.877679    
coal.l4          0.014748   0.085333   0.173 0.862927    
natural_gas.l4  -0.018410   0.093000  -0.198 0.843240    
solar.l5         0.011418   0.020996   0.544 0.587048    
wind.l5          0.065613   0.047370   1.385 0.167227    
coal.l5         -0.045973   0.085378  -0.538 0.590731    
natural_gas.l5   0.301875   0.097987   3.081 0.002292 ** 
solar.l6         0.022132   0.021030   1.052 0.293612    
wind.l6          0.010934   0.047304   0.231 0.817398    
coal.l6          0.157183   0.085214   1.845 0.066265 .  
natural_gas.l6  -0.212096   0.096343  -2.201 0.028602 *  
solar.l7        -0.016025   0.019790  -0.810 0.418862    
wind.l7         -0.049185   0.046574  -1.056 0.291945    
coal.l7          0.024609   0.085812   0.287 0.774513    
natural_gas.l7   0.034114   0.096575   0.353 0.724203    
solar.l8        -0.023104   0.020196  -1.144 0.253701    
wind.l8          0.053080   0.043233   1.228 0.220665    
coal.l8         -0.089738   0.086636  -1.036 0.301277    
natural_gas.l8  -0.193973   0.096566  -2.009 0.045626 *  
solar.l9        -0.006326   0.019650  -0.322 0.747749    
wind.l9          0.100817   0.041870   2.408 0.016760 *  
coal.l9         -0.214833   0.087085  -2.467 0.014288 *  
natural_gas.l9  -0.001866   0.095058  -0.020 0.984351    
solar.l10       -0.007164   0.018474  -0.388 0.698517    
wind.l10        -0.067694   0.038869  -1.742 0.082787 .  
coal.l10         0.248041   0.068407   3.626 0.000348 ***
natural_gas.l10  0.140542   0.081472   1.725 0.085737 .  
const            6.532264   1.787440   3.655 0.000313 ***
trend           -0.001141   0.000738  -1.546 0.123423    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.08292 on 254 degrees of freedom
Multiple R-Squared: 0.9654, Adjusted R-squared: 0.9598 
F-statistic: 172.7 on 41 and 254 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation natural_gas: 
============================================ 
natural_gas = solar.l1 + wind.l1 + coal.l1 + natural_gas.l1 + solar.l2 + wind.l2 + coal.l2 + natural_gas.l2 + solar.l3 + wind.l3 + coal.l3 + natural_gas.l3 + solar.l4 + wind.l4 + coal.l4 + natural_gas.l4 + solar.l5 + wind.l5 + coal.l5 + natural_gas.l5 + solar.l6 + wind.l6 + coal.l6 + natural_gas.l6 + solar.l7 + wind.l7 + coal.l7 + natural_gas.l7 + solar.l8 + wind.l8 + coal.l8 + natural_gas.l8 + solar.l9 + wind.l9 + coal.l9 + natural_gas.l9 + solar.l10 + wind.l10 + coal.l10 + natural_gas.l10 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
solar.l1         0.0242368  0.0154327   1.570 0.117547    
wind.l1         -0.0407070  0.0359993  -1.131 0.259218    
coal.l1         -0.0842802  0.0548389  -1.537 0.125570    
natural_gas.l1   0.6172913  0.0666220   9.266  &lt; 2e-16 ***
solar.l2         0.0125585  0.0170537   0.736 0.462162    
wind.l2          0.0504080  0.0378331   1.332 0.183931    
coal.l2          0.0895845  0.0690022   1.298 0.195367    
natural_gas.l2  -0.0657777  0.0792618  -0.830 0.407386    
solar.l3        -0.0273168  0.0173713  -1.573 0.117074    
wind.l3          0.0342071  0.0387758   0.882 0.378516    
coal.l3         -0.2346600  0.0682248  -3.440 0.000681 ***
natural_gas.l3   0.0351877  0.0776929   0.453 0.651002    
solar.l4         0.0001672  0.0174223   0.010 0.992351    
wind.l4         -0.0330999  0.0390139  -0.848 0.397007    
coal.l4          0.0599139  0.0701665   0.854 0.393975    
natural_gas.l4  -0.1092753  0.0764715  -1.429 0.154242    
solar.l5         0.0302523  0.0172647   1.752 0.080936 .  
wind.l5          0.0264953  0.0389506   0.680 0.496978    
coal.l5         -0.0685202  0.0702037  -0.976 0.329983    
natural_gas.l5   0.1393994  0.0805717   1.730 0.084822 .  
solar.l6        -0.0231582  0.0172920  -1.339 0.181690    
wind.l6         -0.0108757  0.0388969  -0.280 0.780010    
coal.l6          0.0356564  0.0700689   0.509 0.611281    
natural_gas.l6  -0.0977455  0.0792200  -1.234 0.218399    
solar.l7        -0.0604071  0.0162732  -3.712 0.000253 ***
wind.l7          0.0228370  0.0382968   0.596 0.551495    
coal.l7          0.1620386  0.0705604   2.296 0.022464 *  
natural_gas.l7  -0.0088772  0.0794105  -0.112 0.911080    
solar.l8        -0.0478720  0.0166063  -2.883 0.004279 ** 
wind.l8          0.0416738  0.0355489   1.172 0.242177    
coal.l8         -0.1719853  0.0712384  -2.414 0.016476 *  
natural_gas.l8  -0.0523176  0.0794034  -0.659 0.510567    
solar.l9         0.0764474  0.0161576   4.731 3.70e-06 ***
wind.l9          0.0829468  0.0344287   2.409 0.016698 *  
coal.l9         -0.0377725  0.0716076  -0.527 0.598312    
natural_gas.l9  -0.0285686  0.0781635  -0.365 0.715044    
solar.l10        0.0174055  0.0151908   1.146 0.252961    
wind.l10        -0.1109546  0.0319604  -3.472 0.000608 ***
coal.l10         0.1435523  0.0562491   2.552 0.011294 *  
natural_gas.l10  0.0523465  0.0669921   0.781 0.435305    
const            6.4917664  1.4697581   4.417 1.48e-05 ***
trend            0.0005725  0.0006068   0.943 0.346373    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.06818 on 254 degrees of freedom
Multiple R-Squared: 0.9743, Adjusted R-squared: 0.9701 
F-statistic: 234.4 on 41 and 254 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                solar       wind       coal natural_gas
solar       7.068e-02  0.0028203  0.0005356   9.979e-05
wind        2.820e-03  0.0137278 -0.0009531  -4.704e-04
coal        5.356e-04 -0.0009531  0.0068761   2.297e-03
natural_gas 9.979e-05 -0.0004704  0.0022966   4.649e-03

Correlation matrix of residuals:
               solar     wind    coal natural_gas
solar       1.000000  0.09054  0.0243    0.005505
wind        0.090543  1.00000 -0.0981   -0.058881
coal        0.024296 -0.09810  1.0000    0.406193
natural_gas 0.005505 -0.05888  0.4062    1.000000</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>The cross-validation results are very similar. Considering the principle of parsimony, we select VAR(6) as the best model.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df_ts <span class="ot">&lt;-</span> df_ts  </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> df_ts  </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df_ts)        <span class="co"># total observations, here 198</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">4</span>                  <span class="co"># forecast horizon = 4 months</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">60</span>                 <span class="co"># choose rolling steps (e.g., 60 months)</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> n <span class="sc">-</span> h <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> R      <span class="co"># initial training size</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Initial training size k ="</span>, k, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Initial training size k = 243 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rolling steps R ="</span>, R, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rolling steps R = 60 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE matrices: R rows × 4 forecast horizons × 4 variables</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>vars_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(df_ts)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>rmse_VAR1 <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(R, h, <span class="dv">4</span>),</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">paste0</span>(<span class="st">"h"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), vars_names))</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>rmse_VAR2 <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(R, h, <span class="dv">4</span>),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">paste0</span>(<span class="st">"h"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), vars_names))</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Rolling Forecast Loop</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- training index ----</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  train_end <span class="ot">&lt;-</span> k <span class="sc">+</span> i <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> y[<span class="dv">1</span><span class="sc">:</span>train_end, ]</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- test index (next 4 months) ----</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> y[(train_end <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(train_end <span class="sc">+</span> h), ]</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># VAR(8)</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(xtrain, <span class="at">p =</span> <span class="dv">6</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  fc1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit1, <span class="at">n.ahead =</span> h)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract forecasts as matrix h × 4</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  f1mat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fc1<span class="sc">$</span>fcst, <span class="cf">function</span>(x) x[,<span class="dv">1</span>])</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># RMSE for each horizon and variable</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  rmse_VAR1[i, , ] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((f1mat <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># VAR(10)</span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(xtrain, <span class="at">p =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>  fc2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> h)</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>  f2mat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fc2<span class="sc">$</span>fcst, <span class="cf">function</span>(x) x[,<span class="dv">1</span>])</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  rmse_VAR2[i, , ] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((f2mat <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Compute Average RMSE</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>avg_rmse_VAR1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(rmse_VAR1, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>avg_rmse_VAR2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(rmse_VAR2, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Average RMSE (VAR(6)):"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Average RMSE (VAR(6)):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_rmse_VAR1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       solar       wind      coal natural_gas
h1 0.1493868 0.08318428 0.1120144  0.06989166
h2 0.1970542 0.10701716 0.1405784  0.08671152
h3 0.2727443 0.12534061 0.1516071  0.09050176
h4 0.3368442 0.14079293 0.1532020  0.10128942</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Average RMSE (VAR(10)):"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Average RMSE (VAR(10)):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_rmse_VAR2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       solar       wind       coal natural_gas
h1 0.1480441 0.08535715 0.09818861  0.06331787
h2 0.1618971 0.09587652 0.11827855  0.06666412
h3 0.1477134 0.09768411 0.12491933  0.06388455
h4 0.1504287 0.10479596 0.12307859  0.06669400</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Example Plot: Solar RMSE</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">step =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>R, <span class="dv">2</span>),</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rmse =</span> <span class="fu">c</span>(rmse_VAR1[,<span class="dv">1</span>,<span class="st">"solar"</span>], rmse_VAR2[,<span class="dv">1</span>,<span class="st">"solar"</span>]),</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"VAR(6)"</span>, <span class="st">"VAR(10)"</span>), <span class="at">each =</span> R)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> rmse, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"1-step-ahead RMSE for Solar (Rolling Forecast)"</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Rolling step"</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"RMSE"</span>) <span class="sc">+</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<p>The prediction results based on the VAR(6) model indicate that the proportion of electricity generated by traditional fossil energy (coal and natural gas) is expected to continue to decline, while clean energy (solar and wind) is showing a significant growth trend, reflecting the long-term transformation of the energy structure towards low-carbon and renewable directions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">VAR</span>(df_ts, <span class="at">p =</span> <span class="dv">6</span>, <span class="at">type =</span> <span class="st">"both"</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">32</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="var-energy-price-linkages-at-the-financial-market-level" class="level2">
<h2 class="anchored" data-anchor-id="var-energy-price-linkages-at-the-financial-market-level">(4) VAR: Energy price linkages at the financial market level</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">VARselect</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Initial selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<ul>
<li>ICLN exhibits greater volatility, showing distinct cyclical upward trends and pullbacks; XLE shows a more stable trend and a clearer correlation with oil prices.</li>
<li>WTI displays sudden shocks and structural volatility; HH has strong seasonal characteristics.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual plots for each variable with y-axis labels</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>ICLN, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Renewable Energy ETF (ICLN)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>XLE, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Energy Select Sector SPDR Fund (XLE)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>WTI, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"WTI Oil price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>HH, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Henry Hub Natural Gas price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the individual plots into a single figure with subplots and y-axis labels</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">subplot</span>(p1, p2, p3, p4, <span class="at">nrows =</span> <span class="dv">4</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>, <span class="at">titleX =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Time Series of ICLN, XLE, WTI and HH price"</span>,</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>), </span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>), </span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis3 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis4 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>)</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>final_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7c6cbef5e668fe87d1ab" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7c6cbef5e668fe87d1ab">{"x":{"data":[{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01"],"y":[35.355644226074219,34.433929443359375,35.278236389160156,25.667140960693359,15.472048759460449,13.4879150390625,15.049897193908691,14.261866569519043,10.715747833251953,12.312912940979004,14.810669898986816,16.654092788696289,16.126113891601562,16.515119552612305,14.959086418151855,16.444387435913086,14.449846267700195,15.270293235778809,15.867925643920898,13.71513557434082,12.745665550231934,13.430000305175781,13.11634635925293,10.842374801635742,10.507543563842773,11.695039749145508,11.176861763000488,12.429132461547852,12.206024169921875,10.701862335205078,11.506366729736328,11.978528022766113,12.479758262634277,13.692862510681152,13.344186782836914,12.363528251647949,11.899580001831055,10.775731086730957,9.7106456756591797,6.8092060089111328,7.1985125541687012,6.8532781600952148,6.4460978507995605,7.0046610832214355,7.2084589004516602,6.8687949180603027,6.4385499954223633,5.3214278221130371,5.5643510818481445,4.8630275726318359,5.1790084838867188,5.2791972160339355,5.0171651840209961,5.12506103515625,5.6224808692932129,5.7401046752929688,5.7165803909301758,5.7714729309082031,6.6654238700866699,7.0575065612792969,6.9339814186096191,7.3941307067871094,7.0688519477844238,8.1240224838256836,8.4016990661621094,8.3937664031982422,8.383793830871582,8.3115224838256836,8.9700174331665039,8.9941091537475586,8.5925846099853516,8.945927619934082,9.6037435531616211,9.0612049102783203,9.5389623641967773,8.8020792007446289,8.4619836807250977,8.2838354110717773,7.9815182685852051,8.2288789749145508,9.0121927261352539,9.7790098190307617,10.298465728759766,10.018125534057617,9.2910585403442383,8.7730350494384766,7.8873748779296875,7.5698761940002441,8.1881647109985352,7.8706626892089844,8.2852563858032227,7.3253774642944336,7.0811967849731445,7.8642539978027344,7.7463765144348145,7.3422179222106934,7.5314741134643555,7.8059706687927246,7.8831734657287598,7.8574395179748535,7.6000986099243164,6.896702766418457,6.8855161666870117,7.2088208198547363,7.5233869552612305,7.4796981811523438,7.4097952842712402,7.5932912826538086,7.606473445892334,8.0241174697875977,8.1129779815673828,7.9796867370605469,8.2729291915893555,7.9174857139587402,8.3635215759277344,8.587864875793457,8.3994150161743164,8.5429964065551758,8.8391284942626953,8.7134971618652344,7.9421758651733398,8.2878828048706055,7.9330787658691406,7.8239083290100098,7.3781256675720215,8.1787109375,7.6080222129821777,8.7409334182739258,8.9343595504760742,8.9896240234375,9.3580503463745117,9.2014675140380859,9.8740777969360352,9.9575986862182617,10.087517738342285,10.115360260009766,9.8926362991333008,10.217443466186523,10.983314514160156,11.329171180725098,11.740464210510254,8.9268636703491211,10.057910919189453,11.142221450805664,11.754646301269531,13.519721031188965,16.092218399047852,17.35969352722168,18.364284515380859,22.091592788696289,26.560819625854492,28.02806282043457,24.312932968139648,22.855096817016602,21.858123779296875,21.557151794433594,22.188030242919922,21.47869873046875,22.065080642700195,20.476173400878906,23.899900436401367,22.216405868530273,20.137134552001953,17.835205078125,19.699577331542969,20.470058441162109,17.920812606811523,18.910070419311523,18.244497299194336,21.347499847412109,21.242153167724609,18.282806396484375,18.091266632080078,20.265279769897461,19.043680191040039,19.897527694702148,18.420085906982422,18.976524353027344,17.949987411499023,17.59501838684082,17.771306991577148,17.655410766601562,15.530577659606934,14.120463371276855,12.565474510192871,13.724472045898438,15.158291816711426,13.444830894470215,13.542186737060547,13.610334396362305,12.880167007446289,14.57415771484375,13.052566528320312,13.865902900695801,14.003091812133789,14.395060539245605,12.836984634399414,12.141240119934082],"mode":"lines","name":"Renewable Energy ETF (ICLN)","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01"],"y":[25.632431030273438,21.553485870361328,21.625905990600586,18.396970748901367,14.938461303710938,14.612953186035156,13.955492973327637,13.707175254821777,12.015686988830566,12.467988967895508,13.442873001098633,15.175352096557617,14.181536674499512,14.94005012512207,15.102377891540527,15.984712600708008,16.378997802734375,16.844432830810547,16.992734909057617,16.244590759277344,16.733417510986328,17.204784393310547,17.919652938842773,15.867763519287109,14.927517890930176,16.177484512329102,15.384234428405762,16.921979904174805,17.881881713867188,18.929315567016602,20.693229675292969,22.178895950317383,23.813138961791992,24.26140022277832,24.483482360839844,23.458276748657227,23.007369995117188,23.343250274658203,20.95854377746582,17.93559455871582,21.368837356567383,21.724418640136719,21.280733108520508,21.760963439941406,23.050792694091797,22.172576904296875,22.014970779418945,19.663291931152344,20.609086990356445,21.627584457397461,22.211360931396484,22.903436660766602,22.438697814941406,22.164213180541992,22.390010833740234,24.249057769775391,24.35563850402832,24.974931716918945,24.647436141967773,25.349662780761719,24.775054931640625,26.078668594360352,25.809720993041992,26.355392456054688,27.461610794067383,27.477508544921875,28.266571044921875,26.628253936767578,27.991922378540039,28.582109451293945,30.084060668945312,30.587923049926758,32.274326324462891,31.155538558959961,31.835844039916992,29.368137359619141,28.331077575683594,25.868066787719727,25.813535690307617,24.636341094970703,25.76788330078125,25.470199584960938,27.144582748413086,25.736133575439453,24.839618682861328,22.929380416870117,21.954444885253906,20.375171661376953,22.649066925048828,22.645736694335938,20.264091491699219,19.555253982543945,19.007665634155273,20.939971923828125,22.838069915771484,22.624914169311523,23.240472793579102,22.947580337524414,23.332426071166992,24.192974090576172,23.511135101318359,25.501810073852539,25.943181991577148,25.109638214111328,24.586090087890625,24.220737457275391,23.506942749023438,22.675327301025391,22.650007247924805,23.243124008178711,21.969673156738281,24.206693649291992,24.005207061767578,24.425857543945312,25.71295166015625,26.634572982788086,23.748722076416016,24.15791130065918,26.451503753662109,27.243505477905273,27.398664474487305,27.824398040771484,26.857473373413086,27.514396667480469,24.397512435913086,24.016075134277344,21.028667449951172,23.386375427246094,23.925382614135742,24.434535980224609,24.430841445922852,21.718358993530273,23.758827209472656,23.382175445556641,21.435529708862305,22.278863906860352,21.812211990356445,22.162202835083008,23.497745513916016,20.914714813232422,17.717231750488281,11.627654075622559,15.204778671264648,15.508874893188477,15.338970184326172,14.601396560668945,14.447403907775879,12.337124824523926,11.830456733703613,15.142322540283203,15.820720672607422,16.413475036621094,20.09941291809082,20.696565628051758,20.835775375366211,22.025428771972656,22.957975387573242,21.04871940612793,20.626802444458008,22.469089508056641,24.789754867553711,23.547460556030273,24.249977111816406,28.802852630615234,30.838985443115234,33.718910217285156,33.149868011474609,38.465324401855469,31.897953033447266,34.980251312255859,35.908061981201172,32.4757080078125,40.583358764648438,41.101921081542969,39.8487548828125,40.969459533691406,38.126693725585938,38.12872314453125,39.187469482421875,35.256294250488281,37.693691253662109,40.623935699462891,41.292636871337891,42.285018920898438,39.852432250976562,39.567066192626953,39.597602844238281,39.394512176513672,40.683895111083984,44.950164794921875,44.526412963867188,44.374065399169922,43.746532440185547,44.735210418701172,43.808921813964844,42.486728668212891,42.869010925292969,46.227302551269531],"mode":"lines","name":"Energy Select Sector SPDR Fund (XLE)","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[133.92809523809501,133.95826086956501,116.69714285714301,104.443636363636,76.283913043478293,56.968000000000004,40.644347826086999,41.6309090909091,39.078499999999998,47.979999999999997,49.905909090909098,59.257142857142803,69.672272727272698,64.208695652173901,71.064285714285703,69.397727272727295,75.823636363636396,77.972380952381002,74.625652173912997,78.418571428571397,76.308000000000007,81.242173913043501,84.497727272727303,73.842380952380907,75.349090909090904,76.177272727272694,76.618181818181796,75.273636363636399,81.902380952380994,84.148636363636399,89.366956521739098,89.523809523809504,89.414000000000001,102.935652173913,110.147619047619,101.29909090909101,96.2886363636364,97.078095238095202,86.334347826086997,85.648181818181797,86.411904761904793,97.109090909090895,98.566818181818206,100.102272727273,102.297142857143,106.187272727273,103.325714285714,94.534782608695707,82.400476190476198,87.919090909090897,94.118260869565205,94.704499999999996,89.596521739130395,86.720909090909103,88.262857142857101,94.729565217391297,95.3095,93.199047619047604,92.067727272727296,94.766956521739104,95.769499999999994,104.42652173913,106.435454545455,106.395238095238,100.556956521739,93.850952380952407,97.890454545454503,94.9630434782609,100.705,100.568095238095,102.175,101.99636363636399,105.234761904762,102.948260869565,96.317142857142898,93.271818181818205,84.406086956521705,75.707499999999996,59.139565217391301,47.557272727272696,50.856999999999999,47.782272727272698,54.378636363636403,59.388571428571403,59.828636363636399,51.198695652173903,42.912857142857099,45.509999999999998,46.268636363636404,42.585238095238097,37.3960869565217,31.784285714285701,30.377619047619,37.901739130434798,41.031904761904798,46.841818181818198,48.791818181818201,44.896190476190498,44.7517391304348,45.200000000000003,49.809523809523803,45.470909090909103,52.052727272727303,52.561818181818197,53.450000000000003,49.363043478260899,51.173999999999999,48.559565217391302,45.185454545454498,46.581904761904802,48.047826086956498,49.735714285714302,51.573181818181801,56.738181818181801,57.920476190476201,63.584782608695697,62.226999999999997,62.830454545454501,66.313809523809496,69.898695652173899,67.876190476190501,71.0745454545455,67.927391304347793,70.1905,70.753043478260906,56.188181818181803,48.919047619047603,51.227391304347798,54.996000000000002,58.170476190476201,63.870454545454599,60.740000000000002,54.665999999999997,57.376086956521704,54.830454545454501,56.859999999999999,53.960869565217401,56.677619047619103,59.867727272727301,57.7169565217391,50.607999999999997,29.320454545454499,16.975000000000001,28.781428571428599,38.314545454545502,40.7152173913043,42.370952380952403,39.5981818181818,39.405000000000001,41.389047619047602,47.0704347826087,51.849523809523802,59.234499999999997,62.183913043478299,61.417727272727298,65.160952380952395,71.377272727272697,72.591818181818198,67.872272727272701,71.534999999999997,81.3642857142857,79.095454545454601,71.802173913043504,83.277619047618998,91.608000000000004,108.399130434783,101.985238095238,109.71272727272699,114.675909090909,101.91809523809501,93.692608695652197,84.400000000000006,87.286666666666704,84.076363636363595,76.581818181818207,78.251363636363607,77.027500000000003,73.348260869565195,79.126499999999993,71.673478260869601,70.306818181818201,75.766666666666694,81.372608695652204,89.240952380952393,85.469090909090895,77.575454545454505,72.019523809523804,74.003043478260906,77.363809523809493,81.405714285714296,85.347272727272696,79.957391304347894,79.912499999999994,81.947826086956496,76.683181818181794,70.439999999999998,72.164347826086995,69.941428571428602,70.152272727272702],"mode":"lines","name":"WTI Oil price","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y3","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[2.9396908826703663,3.0335096378880211,3.0041963519661206,2.9128939952449864,2.7376090033437546,2.6246685921631592,2.5525652982618152,2.5249283241374862,2.5063419305080652,2.4832385926873033,2.4578779774000812,2.5541217188094731,2.65745841498615,2.7258901192305411,2.7479117345273405,2.6946271807700692,2.4664031782234406,2.4406063908914204,2.3437270363252209,2.3570732782781154,2.3693087250369538,2.3969857684155298,2.4824035195698819,2.5741377835159431,2.6986730392896132,2.7856283357475848,2.8124102164264526,2.7491921444333851,2.5930133911138515,2.3878449369448691,2.3005830903233728,2.2925347571405443,2.3164879981630371,2.3446862690126808,2.4221443280516848,2.5257286443082556,2.6878474937846906,2.7813006628418027,2.8136106967627028,2.7491921444333851,2.5533438113412288,2.3776925654808512,2.2854389341590751,2.2638442646776151,2.2481289071979869,2.3427668826268775,2.3924257969938352,2.5344901499768282,2.6518325211039815,2.7166795278002644,2.7612749623395079,2.6892071133007303,2.4578779774000812,2.3015845926604621,2.2823823856765264,2.2137538792874301,2.2224590485147608,2.2353763433005955,2.3446862690126808,2.5344901499768282,2.7093826463359885,2.7911651078127169,2.7991089320491769,2.753023566744941,2.5160822672564502,2.3065771142635829,2.2126603854660587,2.2257040486580881,2.2793164660546914,2.3702437414678603,2.4647039424704809,2.6100697927420065,2.7806808921371173,2.8466520505398383,2.8570447537800976,2.7893229212309465,2.5733752977756086,2.3214068472346332,2.3035845933271291,2.2512917986064953,2.2060741926132019,2.2278615467981093,2.3446862690126808,2.5439614125693151,2.7127060126384039,2.7899373605743945,2.826129489167811,2.7972813348301528,2.5336968139574321,2.3045830956567186,2.2267833795777636,2.1138429683971682,2.1234584270966104,2.2181159363675955,2.2669579153508947,2.4527277514237653,2.6693093727857793,2.8069901489571136,2.8678989020441064,2.8201877010390604,2.6203112867942031,2.3767644911682972,2.2038691200548879,2.2321626286975,2.3035845933271291,2.2884861686145439,2.4283362982996062,2.5839975524322312,2.7763317085186157,2.8825635754483532,2.9025198918318122,2.8284963541780774,2.5945081597030812,2.3164879981630371,2.2289385528257473,2.1860512767380942,2.2648832258100344,2.2782924004250011,2.3075726345050849,2.6041700706148179,2.8015405441895487,2.8820035082256483,2.9210087273580543,2.8466520505398383,2.5030739537434492,2.2428350885882717,2.2638442646776151,2.2364452904895007,2.2407096892759584,2.2428350885882717,2.3841650799864684,2.5463152779166438,2.7472709142554912,2.8758219768814333,2.9107188992270343,2.8684669225081145,2.5257286443082556,2.2332350148592526,2.2300144001592104,2.2438960966453663,2.2181159363675955,2.2823823856765264,2.3437270363252209,2.4672517145492794,2.7298116928837226,2.8616292890305104,2.9052603703899154,2.8243506567983707,2.5063419305080652,2.3969857684155298,2.2772672850097559,2.2638442646776151,2.2278615467981093,2.3485140248824456,2.5071572587228199,2.6440448711262978,2.8758219768814333,2.9861868607104594,3.0378334495726262,3.0022112396517002,2.8564702062204832,2.5733752977756086,2.5710843460290524,2.4882344398806748,2.4973291697865574,2.5603232890727545,2.6369121732688705,2.8724340572094973,3.1095072878128356,3.201526186533088,3.2343553957165869,3.1994891110680106,2.9242362718489212,2.7447035187502458,2.6851226964585053,2.73696154459663,2.7199787719674839,2.631888840136646,2.67827804276854,2.8267217308197088,3.0120976276402551,3.1009927842114839,3.1544439647088121,3.0937660138253564,2.8249439525737094,2.6019486702196644,2.5687881337687024,2.4689466302092709,2.5779415157551897,2.6217658325051976,2.67000213346468,2.8808824318750488,3.0411835364579085,3.1354942159291497,3.1557230098629323,3.1228053561174671,2.924773184613497,2.7020321287766471,2.563409711275944],"mode":"lines","name":"Henry Hub Natural Gas price","type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Year","anchor":"y4"},"yaxis4":{"domain":[0,0.23000000000000001],"automargin":true,"anchor":"x","title":"Price"},"yaxis3":{"domain":[0.27000000000000002,0.47999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis2":{"domain":[0.52000000000000002,0.72999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis":{"domain":[0.77000000000000002,1],"automargin":true,"anchor":"x","title":"Price"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Time Series of ICLN, XLE, WTI and HH price"},"attrs":{"46e48d32a4d":{"x":{},"y":{},"mode":"lines","name":"Renewable Energy ETF (ICLN)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e42d422aa6":{"x":{},"y":{},"mode":"lines","name":"Energy Select Sector SPDR Fund (XLE)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e42a61636a":{"x":{},"y":{},"mode":"lines","name":"WTI Oil price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e46fd24386":{"x":{},"y":{},"mode":"lines","name":"Henry Hub Natural Gas price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> data_all<span class="sc">$</span>Date, </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ICLN =</span> data_all<span class="sc">$</span>ICLN, </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">XLE =</span> data_all<span class="sc">$</span>XLE,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">WTI =</span> data_all<span class="sc">$</span>WTI,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">HH =</span> data_all<span class="sc">$</span>HH</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>                  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>p-values are 2 and 10.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>df2_clean <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df2)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>df_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2_clean[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(df_ts, <span class="at">lag.max=</span><span class="dv">10</span>,<span class="at">type=</span><span class="st">"both"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
    10      2      2     10 

$criteria
               1          2          3          4          5          6
AIC(n) 0.5614624 -0.9098566 -0.8807057 -1.0232522 -0.9651822 -0.9714135
HQ(n)  0.7288604 -0.6308599 -0.4901104 -0.5210582 -0.3513894 -0.2460221
SC(n)  0.9746252 -0.2212519  0.0833408  0.2162362  0.5497481  0.8189587
FPE(n) 1.7533866  0.4027438  0.4149485  0.3602710  0.3825586  0.3812585
                7           8          9          10
AIC(n) -0.9585381 -0.91491251 -0.9414515 -1.07408790
HQ(n)  -0.1215480  0.03367629  0.1187360  0.09769826
SC(n)   1.1072759  1.42634338  1.6752462  1.81805173
FPE(n)  0.3876960  0.40704892  0.3989680  0.35224399</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p><strong>VAR(2) clearly outperforms VAR(10)</strong>. Although VAR(10) offers marginally better in-sample fit, its many insignificant coefficients indicate noise-fitting rather than meaningful dynamics, leading to substantial overfitting risk. Its eigenvalues lying close to the unit circle further suggest weak stability and unreliable forecasts. By contrast, VAR(2) features a compact structure, statistically coherent coefficients, and stable roots. It captures the essential interactions among energy prices and energy equity indices without unnecessary complexity, making it superior in robustness, interpretability, and economic relevance.</p>
<p><strong>ICLN shows strong persistence and is positively influenced by lagged WTI, while lagged XLE exerts a mild competitive effect</strong>—highlighting both clean–traditional energy divergence and shared macroeconomic drivers. XLE is dominated by its own lag, reflecting high inertia with limited cross-impact from other markets. WTI responds significantly to both its own lag and XLE, indicating tight commodity–equity linkage and feedback. Henry Hub prices are largely self-driven, with minimal spillovers from other variables. Overall, short-run transmission exists primarily between oil and traditional energy stocks, while clean energy exhibits weaker but still meaningful sensitivity—illustrating both coupling and differentiation between the two energy systems in financial markets.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: ICLN, XLE, WTI, HH 
Deterministic variables: both 
Sample size: 196 
Log Likelihood: -1028.767 
Roots of the characteristic polynomial:
0.9378 0.9378 0.905 0.905 0.8874 0.2624 0.2624 0.234
Call:
vars::VAR(y = df_ts, p = 2, type = "both")


Estimation results for equation ICLN: 
===================================== 
ICLN = ICLN.l1 + XLE.l1 + WTI.l1 + HH.l1 + ICLN.l2 + XLE.l2 + WTI.l2 + HH.l2 + const + trend 

        Estimate Std. Error t value Pr(&gt;|t|)    
ICLN.l1  1.07540    0.07510  14.319  &lt; 2e-16 ***
XLE.l1  -0.12400    0.06316  -1.963 0.051084 .  
WTI.l1   0.04514    0.01740   2.594 0.010242 *  
HH.l1   -0.55413    0.78660  -0.704 0.482027    
ICLN.l2 -0.18209    0.07092  -2.567 0.011031 *  
XLE.l2   0.05863    0.06461   0.907 0.365345    
WTI.l2  -0.04044    0.01749  -2.312 0.021874 *  
HH.l2    0.67786    0.78030   0.869 0.386122    
const    0.99769    1.00057   0.997 0.320005    
trend    0.01176    0.00333   3.533 0.000519 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.355 on 186 degrees of freedom
Multiple R-Squared: 0.9385, Adjusted R-squared: 0.9356 
F-statistic: 315.6 on 9 and 186 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation XLE: 
==================================== 
XLE = ICLN.l1 + XLE.l1 + WTI.l1 + HH.l1 + ICLN.l2 + XLE.l2 + WTI.l2 + HH.l2 + const + trend 

         Estimate Std. Error t value Pr(&gt;|t|)    
ICLN.l1 -0.126882   0.099339  -1.277   0.2031    
XLE.l1   0.862452   0.083539  10.324   &lt;2e-16 ***
WTI.l1   0.026898   0.023016   1.169   0.2440    
HH.l1   -0.812479   1.040471  -0.781   0.4359    
ICLN.l2  0.114596   0.093813   1.222   0.2234    
XLE.l2   0.083290   0.085458   0.975   0.3310    
WTI.l2  -0.017567   0.023136  -0.759   0.4486    
HH.l2    0.590042   1.032139   0.572   0.5682    
const    0.561589   1.323508   0.424   0.6718    
trend    0.009591   0.004405   2.177   0.0307 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.793 on 186 degrees of freedom
Multiple R-Squared: 0.9521, Adjusted R-squared: 0.9497 
F-statistic: 410.5 on 9 and 186 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation WTI: 
==================================== 
WTI = ICLN.l1 + XLE.l1 + WTI.l1 + HH.l1 + ICLN.l2 + XLE.l2 + WTI.l2 + HH.l2 + const + trend 

         Estimate Std. Error t value Pr(&gt;|t|)    
ICLN.l1  0.300734   0.301768   0.997   0.3203    
XLE.l1   1.282107   0.253773   5.052 1.04e-06 ***
WTI.l1   1.103209   0.069919  15.778  &lt; 2e-16 ***
HH.l1    4.076954   3.160712   1.290   0.1987    
ICLN.l2 -0.376341   0.284983  -1.321   0.1883    
XLE.l2  -1.341722   0.259603  -5.168 6.06e-07 ***
WTI.l2  -0.156827   0.070283  -2.231   0.0269 *  
HH.l2   -5.902979   3.135403  -1.883   0.0613 .  
const    9.859958   4.020516   2.452   0.0151 *  
trend    0.007527   0.013381   0.563   0.5745    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 5.446 on 186 degrees of freedom
Multiple R-Squared: 0.938,  Adjusted R-squared: 0.935 
F-statistic: 312.5 on 9 and 186 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation HH: 
=================================== 
HH = ICLN.l1 + XLE.l1 + WTI.l1 + HH.l1 + ICLN.l2 + XLE.l2 + WTI.l2 + HH.l2 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
ICLN.l1 -2.617e-03  4.105e-03  -0.638   0.5246    
XLE.l1   7.719e-03  3.452e-03   2.236   0.0265 *  
WTI.l1  -1.103e-03  9.511e-04  -1.160   0.2476    
HH.l1    1.535e+00  4.300e-02  35.702   &lt;2e-16 ***
ICLN.l2  6.178e-03  3.877e-03   1.593   0.1128    
XLE.l2  -4.754e-03  3.532e-03  -1.346   0.1799    
WTI.l2   1.083e-03  9.561e-04   1.133   0.2589    
HH.l2   -8.238e-01  4.265e-02 -19.313   &lt;2e-16 ***
const    6.222e-01  5.469e-02  11.377   &lt;2e-16 ***
trend    5.087e-05  1.820e-04   0.279   0.7802    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.07409 on 186 degrees of freedom
Multiple R-Squared: 0.9277, Adjusted R-squared: 0.9242 
F-statistic: 265.1 on 9 and 186 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
        ICLN      XLE       WTI        HH
ICLN 1.83691  0.92471  1.619222  0.019137
XLE  0.92471  3.21397  5.571406 -0.006080
WTI  1.61922  5.57141 29.658738 -0.007012
HH   0.01914 -0.00608 -0.007012  0.005489

Correlation matrix of residuals:
       ICLN      XLE      WTI       HH
ICLN 1.0000  0.38057  0.21937  0.19058
XLE  0.3806  1.00000  0.57065 -0.04578
WTI  0.2194  0.57065  1.00000 -0.01738
HH   0.1906 -0.04578 -0.01738  1.00000</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: ICLN, XLE, WTI, HH 
Deterministic variables: both 
Sample size: 188 
Log Likelihood: -798.078 
Roots of the characteristic polynomial:
0.9976 0.9976 0.9914 0.9914 0.9352 0.9352 0.9096 0.9096 0.9041 0.9041 0.8793 0.8755 0.8755 0.8703 0.8703 0.8644 0.8644 0.8562 0.8562 0.8459 0.8459 0.8427 0.8427 0.824 0.824 0.8237 0.8237 0.8171 0.8171 0.8098 0.8098 0.8012 0.8012 0.7983 0.7983 0.7276 0.7276 0.7182 0.7182 0.4225
Call:
vars::VAR(y = df_ts, p = 10, type = "both")


Estimation results for equation ICLN: 
===================================== 
ICLN = ICLN.l1 + XLE.l1 + WTI.l1 + HH.l1 + ICLN.l2 + XLE.l2 + WTI.l2 + HH.l2 + ICLN.l3 + XLE.l3 + WTI.l3 + HH.l3 + ICLN.l4 + XLE.l4 + WTI.l4 + HH.l4 + ICLN.l5 + XLE.l5 + WTI.l5 + HH.l5 + ICLN.l6 + XLE.l6 + WTI.l6 + HH.l6 + ICLN.l7 + XLE.l7 + WTI.l7 + HH.l7 + ICLN.l8 + XLE.l8 + WTI.l8 + HH.l8 + ICLN.l9 + XLE.l9 + WTI.l9 + HH.l9 + ICLN.l10 + XLE.l10 + WTI.l10 + HH.l10 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
ICLN.l1   0.960815   0.085696  11.212  &lt; 2e-16 ***
XLE.l1   -0.089903   0.061533  -1.461  0.14615    
WTI.l1    0.036279   0.020365   1.781  0.07691 .  
HH.l1    -0.962577   1.401036  -0.687  0.49314    
ICLN.l2  -0.117140   0.122245  -0.958  0.33953    
XLE.l2    0.039658   0.081561   0.486  0.62753    
WTI.l2   -0.057129   0.027918  -2.046  0.04252 *  
HH.l2     1.677313   2.061402   0.814  0.41716    
ICLN.l3   0.078355   0.126047   0.622  0.53515    
XLE.l3    0.046899   0.084020   0.558  0.57757    
WTI.l3   -0.001051   0.027921  -0.038  0.97002    
HH.l3    -2.028533   2.213714  -0.916  0.36100    
ICLN.l4   0.051802   0.129262   0.401  0.68919    
XLE.l4    0.015596   0.086265   0.181  0.85679    
WTI.l4    0.014945   0.027217   0.549  0.58376    
HH.l4     2.482475   2.241790   1.107  0.26996    
ICLN.l5  -0.018815   0.132024  -0.143  0.88687    
XLE.l5   -0.040018   0.085370  -0.469  0.63994    
WTI.l5    0.006144   0.027340   0.225  0.82251    
HH.l5     1.441489   2.316019   0.622  0.53465    
ICLN.l6  -0.111398   0.130599  -0.853  0.39507    
XLE.l6   -0.051979   0.085256  -0.610  0.54302    
WTI.l6    0.003298   0.027065   0.122  0.90317    
HH.l6    -1.989874   2.325571  -0.856  0.39359    
ICLN.l7  -0.009801   0.130216  -0.075  0.94010    
XLE.l7   -0.031555   0.083255  -0.379  0.70522    
WTI.l7   -0.015983   0.026089  -0.613  0.54106    
HH.l7     2.201162   2.286229   0.963  0.33724    
ICLN.l8  -0.030785   0.124203  -0.248  0.80459    
XLE.l8    0.120003   0.081290   1.476  0.14203    
WTI.l8    0.022604   0.026069   0.867  0.38733    
HH.l8    -2.273989   2.267702  -1.003  0.31763    
ICLN.l9   0.184292   0.115481   1.596  0.11268    
XLE.l9   -0.243959   0.077047  -3.166  0.00188 ** 
WTI.l9   -0.014611   0.024679  -0.592  0.55473    
HH.l9    -0.019610   2.073943  -0.009  0.99247    
ICLN.l10 -0.114429   0.074358  -1.539  0.12600    
XLE.l10   0.098519   0.063576   1.550  0.12340    
WTI.l10   0.019693   0.015155   1.299  0.19583    
HH.l10    2.601908   1.338409   1.944  0.05381 .  
const    -5.755148   4.714494  -1.221  0.22415    
trend     0.014612   0.003447   4.239 3.96e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.038 on 146 degrees of freedom
Multiple R-Squared: 0.9671, Adjusted R-squared: 0.9579 
F-statistic: 104.7 on 41 and 146 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation XLE: 
==================================== 
XLE = ICLN.l1 + XLE.l1 + WTI.l1 + HH.l1 + ICLN.l2 + XLE.l2 + WTI.l2 + HH.l2 + ICLN.l3 + XLE.l3 + WTI.l3 + HH.l3 + ICLN.l4 + XLE.l4 + WTI.l4 + HH.l4 + ICLN.l5 + XLE.l5 + WTI.l5 + HH.l5 + ICLN.l6 + XLE.l6 + WTI.l6 + HH.l6 + ICLN.l7 + XLE.l7 + WTI.l7 + HH.l7 + ICLN.l8 + XLE.l8 + WTI.l8 + HH.l8 + ICLN.l9 + XLE.l9 + WTI.l9 + HH.l9 + ICLN.l10 + XLE.l10 + WTI.l10 + HH.l10 + const + trend 

           Estimate Std. Error t value Pr(&gt;|t|)    
ICLN.l1  -3.842e-01  1.427e-01  -2.691  0.00794 ** 
XLE.l1    8.723e-01  1.025e-01   8.511  1.9e-14 ***
WTI.l1    2.421e-02  3.392e-02   0.714  0.47659    
HH.l1     1.007e-01  2.334e+00   0.043  0.96564    
ICLN.l2   4.191e-01  2.036e-01   2.059  0.04131 *  
XLE.l2    3.623e-02  1.358e-01   0.267  0.79009    
WTI.l2   -3.450e-02  4.650e-02  -0.742  0.45926    
HH.l2     8.305e-01  3.433e+00   0.242  0.80922    
ICLN.l3   1.290e-01  2.099e-01   0.614  0.53991    
XLE.l3    1.373e-01  1.399e-01   0.981  0.32803    
WTI.l3   -4.143e-02  4.651e-02  -0.891  0.37452    
HH.l3     1.129e+00  3.687e+00   0.306  0.75997    
ICLN.l4  -2.339e-01  2.153e-01  -1.086  0.27911    
XLE.l4   -1.740e-01  1.437e-01  -1.211  0.22794    
WTI.l4    8.547e-02  4.533e-02   1.885  0.06137 .  
HH.l4    -8.429e-01  3.734e+00  -0.226  0.82172    
ICLN.l5   2.376e-01  2.199e-01   1.081  0.28163    
XLE.l5   -1.092e-01  1.422e-01  -0.768  0.44389    
WTI.l5   -4.163e-04  4.554e-02  -0.009  0.99272    
HH.l5     3.978e+00  3.858e+00   1.031  0.30411    
ICLN.l6  -2.979e-01  2.175e-01  -1.369  0.17301    
XLE.l6    5.766e-02  1.420e-01   0.406  0.68528    
WTI.l6   -5.933e-03  4.508e-02  -0.132  0.89546    
HH.l6    -4.646e+00  3.873e+00  -1.199  0.23234    
ICLN.l7   1.625e-02  2.169e-01   0.075  0.94037    
XLE.l7   -1.312e-05  1.387e-01   0.000  0.99992    
WTI.l7   -1.379e-03  4.345e-02  -0.032  0.97472    
HH.l7     5.924e+00  3.808e+00   1.556  0.12194    
ICLN.l8  -9.578e-02  2.069e-01  -0.463  0.64407    
XLE.l8    2.501e-01  1.354e-01   1.847  0.06680 .  
WTI.l8   -4.175e-02  4.342e-02  -0.961  0.33791    
HH.l8    -1.949e+00  3.777e+00  -0.516  0.60657    
ICLN.l9   2.540e-01  1.923e-01   1.321  0.18867    
XLE.l9   -1.889e-01  1.283e-01  -1.472  0.14322    
WTI.l9    4.840e-02  4.111e-02   1.178  0.24090    
HH.l9    -7.533e-01  3.454e+00  -0.218  0.82768    
ICLN.l10 -1.228e-01  1.239e-01  -0.991  0.32314    
XLE.l10  -2.121e-02  1.059e-01  -0.200  0.84151    
WTI.l10  -2.138e-02  2.524e-02  -0.847  0.39841    
HH.l10    3.291e+00  2.229e+00   1.476  0.14204    
const    -1.515e+01  7.852e+00  -1.929  0.05570 .  
trend     7.506e-03  5.741e-03   1.307  0.19310    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.729 on 146 degrees of freedom
Multiple R-Squared: 0.9624, Adjusted R-squared: 0.9518 
F-statistic: 91.08 on 41 and 146 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation WTI: 
==================================== 
WTI = ICLN.l1 + XLE.l1 + WTI.l1 + HH.l1 + ICLN.l2 + XLE.l2 + WTI.l2 + HH.l2 + ICLN.l3 + XLE.l3 + WTI.l3 + HH.l3 + ICLN.l4 + XLE.l4 + WTI.l4 + HH.l4 + ICLN.l5 + XLE.l5 + WTI.l5 + HH.l5 + ICLN.l6 + XLE.l6 + WTI.l6 + HH.l6 + ICLN.l7 + XLE.l7 + WTI.l7 + HH.l7 + ICLN.l8 + XLE.l8 + WTI.l8 + HH.l8 + ICLN.l9 + XLE.l9 + WTI.l9 + HH.l9 + ICLN.l10 + XLE.l10 + WTI.l10 + HH.l10 + const + trend 

           Estimate Std. Error t value Pr(&gt;|t|)    
ICLN.l1  -3.482e-01  4.045e-01  -0.861   0.3908    
XLE.l1    1.682e+00  2.905e-01   5.791 4.14e-08 ***
WTI.l1    9.581e-01  9.613e-02   9.966  &lt; 2e-16 ***
HH.l1     1.100e+01  6.613e+00   1.664   0.0983 .  
ICLN.l2  -2.188e-02  5.770e-01  -0.038   0.9698    
XLE.l2   -1.003e+00  3.850e-01  -2.606   0.0101 *  
WTI.l2   -1.643e-01  1.318e-01  -1.247   0.2146    
HH.l2    -3.659e+00  9.731e+00  -0.376   0.7075    
ICLN.l3   9.158e-01  5.950e-01   1.539   0.1259    
XLE.l3   -7.161e-01  3.966e-01  -1.805   0.0731 .  
WTI.l3    1.218e-01  1.318e-01   0.924   0.3571    
HH.l3    -2.661e+00  1.045e+01  -0.255   0.7993    
ICLN.l4  -1.564e+00  6.102e-01  -2.563   0.0114 *  
XLE.l4   -4.399e-01  4.072e-01  -1.080   0.2818    
WTI.l4    5.062e-02  1.285e-01   0.394   0.6941    
HH.l4    -2.012e-02  1.058e+01  -0.002   0.9985    
ICLN.l5   7.253e-01  6.232e-01   1.164   0.2464    
XLE.l5    1.951e-01  4.030e-01   0.484   0.6290    
WTI.l5    1.187e-01  1.291e-01   0.919   0.3594    
HH.l5     1.536e+01  1.093e+01   1.405   0.1622    
ICLN.l6  -1.466e-01  6.165e-01  -0.238   0.8124    
XLE.l6   -2.924e-02  4.024e-01  -0.073   0.9422    
WTI.l6   -2.368e-01  1.278e-01  -1.854   0.0658 .  
HH.l6    -1.928e+01  1.098e+01  -1.756   0.0812 .  
ICLN.l7   7.020e-01  6.147e-01   1.142   0.2553    
XLE.l7   -4.243e-01  3.930e-01  -1.080   0.2821    
WTI.l7    1.397e-01  1.232e-01   1.135   0.2584    
HH.l7     2.007e+01  1.079e+01   1.859   0.0650 .  
ICLN.l8  -8.375e-01  5.863e-01  -1.428   0.1553    
XLE.l8    5.812e-01  3.837e-01   1.515   0.1320    
WTI.l8   -8.948e-02  1.231e-01  -0.727   0.4683    
HH.l8    -7.699e+00  1.070e+01  -0.719   0.4731    
ICLN.l9   1.188e+00  5.451e-01   2.179   0.0310 *  
XLE.l9   -3.150e-01  3.637e-01  -0.866   0.3878    
WTI.l9    4.160e-02  1.165e-01   0.357   0.7215    
HH.l9     6.964e+00  9.790e+00   0.711   0.4780    
ICLN.l10 -8.508e-01  3.510e-01  -2.424   0.0166 *  
XLE.l10   1.039e-01  3.001e-01   0.346   0.7297    
WTI.l10   1.979e-02  7.154e-02   0.277   0.7825    
HH.l10   -3.556e-01  6.318e+00  -0.056   0.9552    
const    -3.616e+01  2.225e+01  -1.625   0.1063    
trend     9.121e-04  1.627e-02   0.056   0.9554    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.901 on 146 degrees of freedom
Multiple R-Squared: 0.9573, Adjusted R-squared: 0.9453 
F-statistic:  79.8 on 41 and 146 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation HH: 
=================================== 
HH = ICLN.l1 + XLE.l1 + WTI.l1 + HH.l1 + ICLN.l2 + XLE.l2 + WTI.l2 + HH.l2 + ICLN.l3 + XLE.l3 + WTI.l3 + HH.l3 + ICLN.l4 + XLE.l4 + WTI.l4 + HH.l4 + ICLN.l5 + XLE.l5 + WTI.l5 + HH.l5 + ICLN.l6 + XLE.l6 + WTI.l6 + HH.l6 + ICLN.l7 + XLE.l7 + WTI.l7 + HH.l7 + ICLN.l8 + XLE.l8 + WTI.l8 + HH.l8 + ICLN.l9 + XLE.l9 + WTI.l9 + HH.l9 + ICLN.l10 + XLE.l10 + WTI.l10 + HH.l10 + const + trend 

           Estimate Std. Error t value Pr(&gt;|t|)    
ICLN.l1  -0.0062481  0.0047561  -1.314  0.19101    
XLE.l1    0.0104391  0.0034151   3.057  0.00266 ** 
WTI.l1   -0.0026226  0.0011302  -2.320  0.02170 *  
HH.l1     1.0305326  0.0777577  13.253  &lt; 2e-16 ***
ICLN.l2   0.0177071  0.0067846   2.610  0.01000 *  
XLE.l2   -0.0002379  0.0045267  -0.053  0.95816    
WTI.l2    0.0018559  0.0015494   1.198  0.23295    
HH.l2    -0.5624245  0.1144082  -4.916 2.35e-06 ***
ICLN.l3  -0.0156439  0.0069956  -2.236  0.02685 *  
XLE.l3   -0.0005743  0.0046631  -0.123  0.90216    
WTI.l3    0.0001514  0.0015496   0.098  0.92232    
HH.l3     0.2452325  0.1228615   1.996  0.04779 *  
ICLN.l4   0.0114585  0.0071741   1.597  0.11238    
XLE.l4   -0.0057886  0.0047877  -1.209  0.22860    
WTI.l4    0.0006823  0.0015105   0.452  0.65214    
HH.l4    -0.3544027  0.1244197  -2.848  0.00503 ** 
ICLN.l5  -0.0112593  0.0073273  -1.537  0.12655    
XLE.l5    0.0033003  0.0047380   0.697  0.48719    
WTI.l5    0.0000999  0.0015174   0.066  0.94759    
HH.l5     0.1099939  0.1285395   0.856  0.39355    
ICLN.l6   0.0041498  0.0072483   0.573  0.56785    
XLE.l6   -0.0029047  0.0047317  -0.614  0.54025    
WTI.l6    0.0001271  0.0015021   0.085  0.93267    
HH.l6    -0.0103274  0.1290696  -0.080  0.93634    
ICLN.l7   0.0056376  0.0072270   0.780  0.43661    
XLE.l7    0.0015062  0.0046206   0.326  0.74491    
WTI.l7   -0.0014474  0.0014479  -1.000  0.31915    
HH.l7    -0.1567315  0.1268861  -1.235  0.21873    
ICLN.l8  -0.0073996  0.0068933  -1.073  0.28484    
XLE.l8    0.0024944  0.0045116   0.553  0.58118    
WTI.l8    0.0022716  0.0014468   1.570  0.11858    
HH.l8     0.0233959  0.1258579   0.186  0.85279    
ICLN.l9   0.0115103  0.0064092   1.796  0.07458 .  
XLE.l9   -0.0057153  0.0042761  -1.337  0.18344    
WTI.l9   -0.0022826  0.0013697  -1.666  0.09776 .  
HH.l9    -0.2175255  0.1151042  -1.890  0.06077 .  
ICLN.l10 -0.0022518  0.0041269  -0.546  0.58615    
XLE.l10   0.0008807  0.0035285   0.250  0.80325    
WTI.l10   0.0014048  0.0008411   1.670  0.09702 .  
HH.l10    0.3350675  0.0742819   4.511 1.32e-05 ***
const     1.1941263  0.2616552   4.564 1.06e-05 ***
trend     0.0003923  0.0001913   2.051  0.04208 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.05762 on 146 degrees of freedom
Multiple R-Squared: 0.9648, Adjusted R-squared: 0.9549 
F-statistic: 97.66 on 41 and 146 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
         ICLN       XLE      WTI        HH
ICLN 1.077943  0.569269  0.68140  0.007008
XLE  0.569269  2.990428  4.59490 -0.008051
WTI  0.681398  4.594904 24.01910  0.003550
HH   0.007008 -0.008051  0.00355  0.003320

Correlation matrix of residuals:
       ICLN     XLE     WTI       HH
ICLN 1.0000  0.3171 0.13391  0.11714
XLE  0.3171  1.0000 0.54216 -0.08080
WTI  0.1339  0.5422 1.00000  0.01257
HH   0.1171 -0.0808 0.01257  1.00000</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<p>The cross-validation results are very similar. Considering the principle of parsimony, we select VAR(2) as the best model.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>df_ts <span class="ot">&lt;-</span> df_ts  </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> df_ts  </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df_ts)        <span class="co"># total observations, here 198</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">4</span>                  <span class="co"># forecast horizon = 4 months</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">60</span>                 <span class="co"># choose rolling steps (e.g., 60 months)</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> n <span class="sc">-</span> h <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> R      <span class="co"># initial training size</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Initial training size k ="</span>, k, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Initial training size k = 135 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rolling steps R ="</span>, R, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rolling steps R = 60 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE matrices: R rows × 4 forecast horizons × 4 variables</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>vars_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(df_ts)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>rmse_VAR1 <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(R, h, <span class="dv">4</span>),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">paste0</span>(<span class="st">"h"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), vars_names))</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>rmse_VAR2 <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(R, h, <span class="dv">4</span>),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">paste0</span>(<span class="st">"h"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), vars_names))</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Rolling Forecast Loop</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- training index ----</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  train_end <span class="ot">&lt;-</span> k <span class="sc">+</span> i <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> y[<span class="dv">1</span><span class="sc">:</span>train_end, ]</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- test index (next 4 months) ----</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> y[(train_end <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(train_end <span class="sc">+</span> h), ]</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># VAR(8)</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(xtrain, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>  fc1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit1, <span class="at">n.ahead =</span> h)</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract forecasts as matrix h × 4</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>  f1mat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fc1<span class="sc">$</span>fcst, <span class="cf">function</span>(x) x[,<span class="dv">1</span>])</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># RMSE for each horizon and variable</span></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>  rmse_VAR1[i, , ] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((f1mat <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># VAR(10)</span></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(xtrain, <span class="at">p =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a>  fc2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> h)</span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>  f2mat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fc2<span class="sc">$</span>fcst, <span class="cf">function</span>(x) x[,<span class="dv">1</span>])</span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a>  rmse_VAR2[i, , ] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((f2mat <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Compute Average RMSE</span></span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a>avg_rmse_VAR1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(rmse_VAR1, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a>avg_rmse_VAR2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(rmse_VAR2, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Average RMSE (VAR(2)):"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Average RMSE (VAR(2)):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_rmse_VAR1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       ICLN      XLE       WTI         HH
h1 1.482565 2.053367  5.407625 0.07474277
h2 2.377303 2.905445 10.324143 0.13671566
h3 3.238259 3.759653 13.775922 0.16297526
h4 3.837131 4.700796 16.916775 0.17890289</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Average RMSE (VAR(10)):"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Average RMSE (VAR(10)):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_rmse_VAR2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       ICLN      XLE       WTI         HH
h1 1.607588 2.198545  5.477483 0.07843172
h2 2.461865 3.245926 10.171812 0.09307699
h3 3.080793 4.066069 12.977369 0.10449711
h4 3.768308 5.100467 16.209512 0.11204263</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Example Plot: Solar RMSE</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">step =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>R, <span class="dv">2</span>),</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rmse =</span> <span class="fu">c</span>(rmse_VAR1[,<span class="dv">1</span>,<span class="st">"ICLN"</span>], rmse_VAR2[,<span class="dv">1</span>,<span class="st">"ICLN"</span>]),</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"VAR(2)"</span>, <span class="st">"VAR(10)"</span>), <span class="at">each =</span> R)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> rmse, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"1-step-ahead RMSE for ICLN (Rolling Forecast)"</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Rolling step"</span>,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"RMSE"</span>) <span class="sc">+</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<ul>
<li><p>The <strong>HH</strong> forecast maintains strong seasonality and shows slight mean reversion, with widening confidence intervals indicating uncertainty in future volatility.</p></li>
<li><p>The <strong>ICLN</strong> forecast tends to be stable, with no significant upward or downward trend, reflecting the recent lack of directional drivers for clean energy stocks.</p></li>
<li><p>The <strong>WTI</strong> forecast is flat, not continuing the large fluctuations seen historically, suggesting that oil prices are returning to their long-term equilibrium level within the model framework.</p></li>
<li><p>The <strong>XLE</strong> forecast also converges, indicating that the energy stock index is strongly dominated by its own lagged terms rather than external shocks.</p></li>
</ul>
<p>Overall, the gradually expanding prediction intervals and stable central path show that the VAR(2) model provides a robust but conservative short-term outlook, emphasizing mean reversion rather than structural trend identification.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">VAR</span>(df_ts, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"both"</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">32</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="arimax-natural-gas-temperature-hh-wti" class="level2">
<h2 class="anchored" data-anchor-id="arimax-natural-gas-temperature-hh-wti">(5) ARIMAX: Natural gas ~ temperature + HH + WTI</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">auto.arima()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Manual Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Model Diagnostics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false">Final Model Fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Temperature primarily represents seasonal demand shocks, HH prices reflect the supply and demand balance within the natural gas market itself, and WTI influences substitution and co-production activities across energy markets. Together, these factors constitute the core economic structure of natural gas demand and price dynamics.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/electric.csv"</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">str_extract</span>(Description, <span class="st">"(?&lt;=From ).*?(?=,)"</span>),</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>n_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Natural Gas"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Natural_gas =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>ts_n <span class="ot">&lt;-</span> <span class="fu">ts</span>(n_df<span class="sc">$</span>Value,</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(solar_df<span class="sc">$</span>Year), <span class="fu">min</span>(solar_df<span class="sc">$</span>Month)),</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/WTIprice.csv"</span>)</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> wti <span class="sc">%&gt;%</span></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> observation_date) <span class="sc">%&gt;%</span></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2000-01-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-12-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">WTI =</span> POILWTIUSDM) <span class="sc">%&gt;%</span></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WTI =</span> <span class="fu">as.numeric</span>(WTI))<span class="sc">%&gt;%</span></span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a>ts_wti <span class="ot">&lt;-</span> <span class="fu">ts</span>(wti<span class="sc">$</span>WTI,</span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>),</span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/naturalgasprice.csv"</span>)</span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> df_n <span class="sc">%&gt;%</span></span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb112-45"><a href="#cb112-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb112-46"><a href="#cb112-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-47"><a href="#cb112-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-48"><a href="#cb112-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-49"><a href="#cb112-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb112-50"><a href="#cb112-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb112-51"><a href="#cb112-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">log</span>(<span class="fu">pmax</span>(HH, .Machine<span class="sc">$</span>double.eps))) <span class="sc">%&gt;%</span></span>
<span id="cb112-52"><a href="#cb112-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb112-53"><a href="#cb112-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-54"><a href="#cb112-54" aria-hidden="true" tabindex="-1"></a>ts_np <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_n<span class="sc">$</span>HH,</span>
<span id="cb112-55"><a href="#cb112-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(df_n<span class="sc">$</span>Year), <span class="fu">min</span>(df_n<span class="sc">$</span>Month)),</span>
<span id="cb112-56"><a href="#cb112-56" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb112-57"><a href="#cb112-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-58"><a href="#cb112-58" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/Global_Temperature_2000onwards.csv"</span>)</span>
<span id="cb112-59"><a href="#cb112-59" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="fu">order</span>(df<span class="sc">$</span>Year, df<span class="sc">$</span>Month), ]</span>
<span id="cb112-60"><a href="#cb112-60" aria-hidden="true" tabindex="-1"></a>df_temp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb112-61"><a href="#cb112-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span>
<span id="cb112-62"><a href="#cb112-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-63"><a href="#cb112-63" aria-hidden="true" tabindex="-1"></a>ts_anomaly <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_temp<span class="sc">$</span>Monthly_Anomaly,</span>
<span id="cb112-64"><a href="#cb112-64" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>),   </span>
<span id="cb112-65"><a href="#cb112-65" aria-hidden="true" tabindex="-1"></a>                 <span class="at">frequency =</span> <span class="dv">12</span>)     </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>data_all2 <span class="ot">&lt;-</span> n_df <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_temp, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(wti, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_n, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual plots for each variable with y-axis labels</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all2, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Natural_gas, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Natural Gas Electricity Generation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Value"</span>))</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all2, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Monthly_Anomaly, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Global Average Temperature Anomaly"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperature (C)"</span>))</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all2, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>WTI, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"WTI Oil price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all2, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>HH, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Henry Hub Natural Gas price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the individual plots into a single figure with subplots and y-axis labels</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">subplot</span>(p1, p2, p3, p4, <span class="at">nrows =</span> <span class="dv">4</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>, <span class="at">titleX =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Time Series of Natural gas power generation, temperature, and oil and gas prices"</span>,</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Value"</span>), </span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperature (C)"</span>), </span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis3 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis4 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>)</span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a>final_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-464871684f29bb252592" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-464871684f29bb252592">{"x":{"data":[{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[39166.593000000001,35256.902999999998,42587.995000000003,43788.542000000001,59054.182999999997,59138.322999999997,69938.168000000005,76542.345000000001,55688.290000000001,43498.595000000001,37362.341999999997,39015.879999999997,42388.663,37966.927000000003,44364.413999999997,45842.745999999999,50934.205000000002,57603.154000000002,73030.142000000007,78409.804000000004,60181.139999999999,56376.440999999999,44490.622000000003,47540.860999999997,48412.832000000002,44308.43,51214.463000000003,49146.409,50275.237999999998,65631.017999999996,83917.269,84476.868000000002,68161.130999999994,54200.82,45160.874000000003,46100.392,50175.745999999999,43546.572999999997,46699.025999999998,45195.383999999998,49372.964,54452.949999999997,76938.278000000006,83249.692999999999,59089.940999999999,51824.169000000002,45327.917999999998,44034.896999999997,48253.372000000003,50319.875,49801.186999999998,51821.987999999998,62021.807999999997,64685.669000000002,79290.021999999997,77820.687999999995,67853.993000000002,57228.813999999998,49693.034,51309.565000000002,51337.627,44912.616999999998,51896.972999999998,52016.286,54826.004000000001,75635.493000000002,96819.410000000003,100786.65399999999,73355.482999999993,55940.881000000001,49440.226000000002,53992.601000000002,43806.921000000002,47408.989000000001,54921.741999999998,56090.856,65585.604999999996,81060.210000000006,108093.514,106591.666,72673.347999999998,70640.039000000004,53439.692999999999,56128.186000000002,61474.531999999999,57622.071000000004,56203.821000000004,60152.847999999998,66469.701000000001,81511.451000000001,97482.676000000007,121338.427,88531.615000000005,78358.024000000005,60636.798999999999,66807.827999999994,72599.900999999998,60042.012000000002,62170.580000000002,63046.097999999998,62270.447,84619.976999999999,100320.878,99673.493000000002,79136.029999999999,73283.339000000007,61454.199000000001,64363.646000000001,66390.112999999998,62138.853000000003,68202.743000000002,61158.673999999999,68145.646999999997,84205.182000000001,101893.833,109239.554,92126.618000000002,72602.725999999995,63285.131999999998,71589.607000000004,74172.736000000004,66198.080000000002,63430.660000000003,64644.025000000001,73665.437999999995,92268.430999999997,114624.202,121151.269,93004.176999999996,77738.337,69226.559999999998,77573.320000000007,74254.334000000003,65923.982999999993,65947.119999999995,70028.998999999996,75242.797000000006,90691.111999999994,119623.591,119855.79300000001,91739.070000000007,78819.206999999995,75441.297999999995,86121.626000000004,90760.884000000005,90609.782000000007,92250.653000000006,94828.596000000005,107351.81200000001,115597.503,138862.85000000001,131735.864,108012.30100000001,91725.370999999999,80169.460999999996,83989.096999999994,88559.050000000003,80283.073999999993,84725.259000000005,78036.432000000001,83815.592000000004,99615.063999999998,120770.981,121156.397,102063.23299999999,88587.402000000002,84286.785000000003,92936.290999999997,91062.482000000004,75945.210000000006,78154.341,76784.849000000002,89120.782999999996,98469.555999999997,115083.446,122350.005,106583.67999999999,97684.697,84355.857000000004,91040.210000000006,101690.973,91440.168999999994,99550.145000000004,92855.546000000002,101624.698,121567.811,141241.24600000001,139215.88500000001,123110.83100000001,110109.753,102368.842,109892.103,110043.747,98688.198999999993,103933.12300000001,98973.798999999999,110518.533,131522.997,151716.16399999999,154926.02499999999,125683.451,102897.986,93950.832999999999,96416.065000000002,95661.247000000003,82836.975000000006,95214.199999999997,88562.369999999995,98074.115999999995,117351.493,147041.80300000001,141307.82800000001,118131.705,106895.19899999999,95072.307000000001,111553.28599999999,110441.982,98675.285999999993,106742.016,98671.585000000006,115564.63800000001,131085.723,165075.42600000001,162000.63399999999,142085.18599999999,123280.446,108265.012,109955.09699999999,121808.277,112397.159,116059.14599999999,104348.632,117296.649,138087.41899999999,172281.64499999999,175270.24799999999,149938.13200000001,131113.378,117958.726,131973.42800000001,136083.78,128017.928,126186.58,110563.815,117185.64599999999,143055.42300000001,181568.06400000001,173644.41699999999,141397.45499999999,131412.579,109810.78,127863.17200000001,126529.598,111182.91499999999,107018.711,107416.268,114675.792,149375.55600000001,170189.36300000001,172716.005,138214.40900000001,131851.68100000001,122433.25900000001,127586.42999999999,134947.53099999999,114945.428,112477.268,105505.84699999999,127091.023,155516.99600000001,189042.19399999999,188859.66899999999,156947.86300000001,133491.524,127523.439,140715.959,138502.655,125035.65399999999,133699.41099999999,120011.632,137393.601,161981.31299999999,199521.54199999999,199220.82999999999,166310.99299999999,140824.84599999999,135531.277,148029.15700000001,160135.505,130987.106,130604.32399999999,121282.098,143617.82800000001,169307.076,207717.35800000001,203074.905,169393.44,146347.745,137041.413,145365.01300000001],"mode":"lines","name":"Natural Gas Electricity Generation","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[0.33900000000000002,0.60099999999999998,0.57199999999999995,0.64400000000000002,0.42399999999999999,0.45000000000000001,0.38800000000000001,0.48699999999999999,0.46200000000000002,0.27900000000000003,0.33800000000000002,0.35699999999999998,0.52200000000000002,0.50600000000000001,0.61199999999999999,0.61699999999999999,0.61099999999999999,0.56599999999999995,0.57599999999999996,0.48799999999999999,0.55500000000000005,0.51100000000000001,0.71099999999999997,0.67800000000000005,0.77900000000000003,0.73399999999999999,0.94599999999999995,0.69499999999999995,0.69999999999999996,0.57399999999999995,0.60199999999999998,0.56999999999999995,0.68899999999999995,0.61599999999999999,0.58399999999999996,0.58099999999999996,0.81200000000000006,0.61899999999999999,0.59899999999999998,0.64600000000000002,0.67000000000000004,0.501,0.56699999999999995,0.66700000000000004,0.69499999999999995,0.747,0.54000000000000004,0.79400000000000004,0.65800000000000003,0.73999999999999999,0.64400000000000002,0.71199999999999997,0.438,0.44400000000000001,0.254,0.47499999999999998,0.55200000000000005,0.63200000000000001,0.70499999999999996,0.55900000000000005,0.80000000000000004,0.69399999999999995,0.78900000000000003,0.76800000000000002,0.70699999999999996,0.69699999999999995,0.61099999999999999,0.64200000000000002,0.749,0.82499999999999996,0.72999999999999998,0.77700000000000002,0.64900000000000002,0.83599999999999997,0.70399999999999996,0.623,0.56699999999999995,0.67400000000000004,0.47299999999999998,0.748,0.64600000000000002,0.70699999999999996,0.70899999999999996,0.85199999999999998,0.997,0.77400000000000002,0.70199999999999996,0.88400000000000001,0.72199999999999998,0.62,0.64300000000000002,0.64400000000000002,0.61499999999999999,0.63900000000000001,0.59899999999999998,0.52700000000000002,0.318,0.373,0.68999999999999995,0.60799999999999998,0.57599999999999996,0.51400000000000001,0.57899999999999996,0.49199999999999999,0.68400000000000005,0.71299999999999997,0.67900000000000005,0.60599999999999998,0.72199999999999998,0.59899999999999998,0.52400000000000002,0.66400000000000003,0.67500000000000004,0.70299999999999996,0.78800000000000003,0.748,0.748,0.72399999999999998,0.78700000000000003,0.79200000000000004,0.83699999999999997,0.91900000000000004,0.93400000000000005,0.98899999999999999,0.82199999999999995,0.70099999999999996,0.61499999999999999,0.70499999999999996,0.68700000000000006,0.751,0.78200000000000003,0.57799999999999996,0.62,0.58099999999999996,0.70399999999999996,0.72499999999999998,0.59499999999999997,0.68799999999999994,0.79100000000000004,0.81999999999999995,0.60299999999999998,0.66800000000000004,0.57199999999999995,0.65000000000000002,0.48699999999999999,0.53900000000000003,0.52400000000000002,0.78300000000000003,0.82399999999999995,0.70299999999999996,0.57999999999999996,0.749,0.78100000000000003,0.85399999999999998,0.81399999999999995,0.61399999999999999,0.747,0.61599999999999999,0.68700000000000006,0.64400000000000002,0.68600000000000005,0.68400000000000005,0.58699999999999997,0.73299999999999998,0.79200000000000004,0.70499999999999996,0.83899999999999997,0.74399999999999999,0.79500000000000004,0.59099999999999997,0.78700000000000003,0.86299999999999999,0.90200000000000002,0.68500000000000005,0.58499999999999996,0.89300000000000002,0.93500000000000005,0.85699999999999998,0.63400000000000001,0.81599999999999995,0.871,0.90200000000000002,0.91800000000000004,0.86799999999999999,0.86699999999999999,0.83299999999999996,0.73899999999999999,0.875,0.89600000000000002,1.0960000000000001,1.0189999999999999,1.1919999999999999,1.2529999999999999,1.3380000000000001,1.329,1.179,1.052,0.84199999999999997,0.84199999999999997,1.0429999999999999,0.92700000000000005,0.96199999999999997,0.96099999999999997,0.97399999999999998,1.0940000000000001,1.181,1.222,1.0449999999999999,0.98699999999999999,0.73299999999999998,0.81399999999999995,0.90100000000000002,0.78600000000000003,0.92600000000000005,0.85699999999999998,0.996,0.878,0.92700000000000005,0.93100000000000005,0.99099999999999999,0.85199999999999998,0.80800000000000005,0.81000000000000005,0.83299999999999996,0.81200000000000006,1.0129999999999999,0.82099999999999995,0.97799999999999998,0.95599999999999996,0.99299999999999999,1.2190000000000001,1.113,0.92900000000000005,0.88800000000000001,0.95699999999999996,1.002,0.94899999999999995,1.109,1.012,1.161,1.2010000000000001,1.2310000000000001,1.1779999999999999,1.2310000000000001,1.046,0.92300000000000004,0.93100000000000005,0.95399999999999996,1.0089999999999999,0.93100000000000005,1.0880000000000001,0.86599999999999999,0.89400000000000002,0.69799999999999995,0.86799999999999999,0.88500000000000001,0.86799999999999999,0.84499999999999997,0.90600000000000003,0.90400000000000003,0.98899999999999999,1.0600000000000001,0.93100000000000005,0.88900000000000001,0.94599999999999995,0.88900000000000001,1.0780000000000001,0.92700000000000005,0.89600000000000002,0.97199999999999998,0.92500000000000004,0.97599999999999998,0.91900000000000004,1.0409999999999999,0.72999999999999998,0.93600000000000005,0.92500000000000004,0.98499999999999999,1.268,1.0860000000000001,1.002,1.1299999999999999,1.266,1.3149999999999999,1.548,1.393,1.3999999999999999,1.427,1.3,1.4259999999999999,1.343,1.3520000000000001,1.2230000000000001,1.23,1.2290000000000001,1.383,1.2709999999999999,1.3680000000000001,1.3129999999999999,1.2889999999999999],"mode":"lines","name":"Global Average Temperature Anomaly","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[27.224285714285699,29.362380952380899,29.8921739130435,25.798999999999999,28.833478260869601,31.859090909090899,29.983809523809501,31.218695652173899,33.859999999999999,33.075000000000003,34.555,28.3880952380952,29.4821739130435,29.583500000000001,27.241363636363602,27.4538095238095,28.610434782608699,27.6009523809524,26.435909090909099,27.467826086956499,26.210999999999999,22.210434782608701,19.5840909090909,19.317619047619001,19.6073913043478,20.775500000000001,24.508095238095201,26.2663636363636,27.003913043478299,25.521000000000001,26.93,28.381363636363599,29.632857142857102,28.8539130434783,26.3247619047619,29.548636363636401,32.911739130434803,35.914999999999999,33.219047619047601,28.357727272727299,28.223636363636398,30.724761904761898,30.747391304347801,31.5919047619048,28.451363636363599,30.330869565217402,30.962499999999999,32.204347826087002,34.146363636363603,34.722000000000001,36.760869565217398,36.719090909090902,40.272857142857099,38.041363636363599,40.685000000000002,44.935909090909099,45.860909090909097,53.1671428571428,48.532272727272698,43.279130434782601,46.991904761904799,47.990499999999997,54.093043478260903,53.036666666666697,49.922272727272698,56.305454545454602,58.705714285714301,64.968260869565199,65.6577272727273,62.370476190476197,58.311363636363602,59.366363636363602,65.232727272727303,61.543999999999997,62.899565217391299,69.673500000000004,70.959130434782594,70.957727272727297,74.361428571428604,73.048695652173905,64.119047619047606,58.878181818181801,59.289090909090902,62.028571428571396,54.780000000000001,59.269500000000001,60.564090909090901,63.974761904761898,63.513478260869597,67.478571428571399,74.046363636363594,72.392173913043493,79.632999999999996,85.926521739130393,94.766363636363593,91.774761904761903,92.982608695652203,95.361428571428604,105.50380952381001,112.336363636364,125.67136363636401,133.92809523809501,133.95826086956501,116.69714285714301,104.443636363636,76.283913043478293,56.968000000000004,40.644347826086999,41.6309090909091,39.078499999999998,47.979999999999997,49.905909090909098,59.257142857142803,69.672272727272698,64.208695652173901,71.064285714285703,69.397727272727295,75.823636363636396,77.972380952381002,74.625652173912997,78.418571428571397,76.308000000000007,81.242173913043501,84.497727272727303,73.842380952380907,75.349090909090904,76.177272727272694,76.618181818181796,75.273636363636399,81.902380952380994,84.148636363636399,89.366956521739098,89.523809523809504,89.414000000000001,102.935652173913,110.147619047619,101.29909090909101,96.2886363636364,97.078095238095202,86.334347826086997,85.648181818181797,86.411904761904793,97.109090909090895,98.566818181818206,100.102272727273,102.297142857143,106.187272727273,103.325714285714,94.534782608695707,82.400476190476198,87.919090909090897,94.118260869565205,94.704499999999996,89.596521739130395,86.720909090909103,88.262857142857101,94.729565217391297,95.3095,93.199047619047604,92.067727272727296,94.766956521739104,95.769499999999994,104.42652173913,106.435454545455,106.395238095238,100.556956521739,93.850952380952407,97.890454545454503,94.9630434782609,100.705,100.568095238095,102.175,101.99636363636399,105.234761904762,102.948260869565,96.317142857142898,93.271818181818205,84.406086956521705,75.707499999999996,59.139565217391301,47.557272727272696,50.856999999999999,47.782272727272698,54.378636363636403,59.388571428571403,59.828636363636399,51.198695652173903,42.912857142857099,45.509999999999998,46.268636363636404,42.585238095238097,37.3960869565217,31.784285714285701,30.377619047619,37.901739130434798,41.031904761904798,46.841818181818198,48.791818181818201,44.896190476190498,44.7517391304348,45.200000000000003,49.809523809523803,45.470909090909103,52.052727272727303,52.561818181818197,53.450000000000003,49.363043478260899,51.173999999999999,48.559565217391302,45.185454545454498,46.581904761904802,48.047826086956498,49.735714285714302,51.573181818181801,56.738181818181801,57.920476190476201,63.584782608695697,62.226999999999997,62.830454545454501,66.313809523809496,69.898695652173899,67.876190476190501,71.0745454545455,67.927391304347793,70.1905,70.753043478260906,56.188181818181803,48.919047619047603,51.227391304347798,54.996000000000002,58.170476190476201,63.870454545454599,60.740000000000002,54.665999999999997,57.376086956521704,54.830454545454501,56.859999999999999,53.960869565217401,56.677619047619103,59.867727272727301,57.7169565217391,50.607999999999997,29.320454545454499,16.975000000000001,28.781428571428599,38.314545454545502,40.7152173913043,42.370952380952403,39.5981818181818,39.405000000000001,41.389047619047602,47.0704347826087,51.849523809523802,59.234499999999997,62.183913043478299,61.417727272727298,65.160952380952395,71.377272727272697,72.591818181818198,67.872272727272701,71.534999999999997,81.3642857142857,79.095454545454601,71.802173913043504,83.277619047618998,91.608000000000004,108.399130434783,101.985238095238,109.71272727272699,114.675909090909,101.91809523809501,93.692608695652197,84.400000000000006,87.286666666666704,84.076363636363595,76.581818181818207,78.251363636363607,77.027500000000003,73.348260869565195,79.126499999999993,71.673478260869601,70.306818181818201,75.766666666666694,81.372608695652204,89.240952380952393,85.469090909090895,77.575454545454505,72.019523809523804,74.003043478260906,77.363809523809493,81.405714285714296,85.347272727272696,79.957391304347894,79.912499999999994,81.947826086956496,76.683181818181794,70.439999999999998,72.164347826086995,69.941428571428602,70.152272727272702],"mode":"lines","name":"WTI Oil price","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y3","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[1.8515994695840721,1.8779371654691073,1.9329696377795786,1.9726911717329554,2.1114245875328868,2.2512917986064953,2.3340837600534168,2.3389170222414357,2.3125354238472138,2.244955980157409,2.149433913499871,2.1471001901536506,2.3145136638593193,2.3282528397426234,2.2874714551839976,2.318458442150336,2.4105422344991378,2.4492794721448492,2.4176979000945504,2.3878449369448691,2.3194422100604686,2.1090003439213802,2.0769384114617173,1.9878743481543455,1.9987736386123811,1.9782390361706734,1.9600947840472698,2.0360119837525001,2.1447610078004784,2.259677591982769,2.3331142980288688,2.3456445824544927,2.3253245799635351,2.1529243184396392,2.0781907597781832,2.0630580624293118,2.1016921506146558,2.149433913499871,2.2793164660546914,2.3204250111223765,2.3786197792700432,2.4915511925066687,2.5455312716044354,2.5525652982618152,2.510411940196362,2.3646204839134985,2.2793164660546914,2.252343876557299,2.2731562823032334,2.2874714551839976,2.3055806019738441,2.355177543113216,2.4535879665305731,2.5710843460290524,2.605648267484129,2.6203112867942031,2.5885156324070202,2.4587337754839771,2.4371159859516518,2.4060438013622756,2.388762789235098,2.3860067011331179,2.3832429960115,2.4748563139344988,2.5447466501440172,2.6239436918052106,2.6986730392896132,2.7414849771884473,2.8069901489571136,2.7997173896280341,2.7498317351171653,2.6810215287142909,2.7027025947756149,2.6376277368056642,2.5779415157551897,2.5855058483441162,2.6679224100114309,2.7127060126384039,2.7549337870010606,2.7837759116303458,2.7542974522675299,2.5265283244788197,2.5217206229107165,2.528125768907977,2.4989739069994359,2.4956817229559589,2.550226115908643,2.5885156324070202,2.6871669901857858,2.7899373605743945,2.8160073426073025,2.8160073426073025,2.7744619666214616,2.6789646202071133,2.5680215564985067,2.5128460184772416,2.5047092770841801,2.5321082512722946,2.5748996883147051,2.6734587563325909,2.7930039069823738,2.9396908826703663,3.0335096378880211,3.0041963519661206,2.9128939952449864,2.7376090033437546,2.6246685921631592,2.5525652982618152,2.5249283241374862,2.5063419305080652,2.4832385926873033,2.4578779774000812,2.5541217188094731,2.65745841498615,2.7258901192305411,2.7479117345273405,2.6946271807700692,2.4664031782234406,2.4406063908914204,2.3437270363252209,2.3570732782781154,2.3693087250369538,2.3969857684155298,2.4824035195698819,2.5741377835159431,2.6986730392896132,2.7856283357475848,2.8124102164264526,2.7491921444333851,2.5930133911138515,2.3878449369448691,2.3005830903233728,2.2925347571405443,2.3164879981630371,2.3446862690126808,2.4221443280516848,2.5257286443082556,2.6878474937846906,2.7813006628418027,2.8136106967627028,2.7491921444333851,2.5533438113412288,2.3776925654808512,2.2854389341590751,2.2638442646776151,2.2481289071979869,2.3427668826268775,2.3924257969938352,2.5344901499768282,2.6518325211039815,2.7166795278002644,2.7612749623395079,2.6892071133007303,2.4578779774000812,2.3015845926604621,2.2823823856765264,2.2137538792874301,2.2224590485147608,2.2353763433005955,2.3446862690126808,2.5344901499768282,2.7093826463359885,2.7911651078127169,2.7991089320491769,2.753023566744941,2.5160822672564502,2.3065771142635829,2.2126603854660587,2.2257040486580881,2.2793164660546914,2.3702437414678603,2.4647039424704809,2.6100697927420065,2.7806808921371173,2.8466520505398383,2.8570447537800976,2.7893229212309465,2.5733752977756086,2.3214068472346332,2.3035845933271291,2.2512917986064953,2.2060741926132019,2.2278615467981093,2.3446862690126808,2.5439614125693151,2.7127060126384039,2.7899373605743945,2.826129489167811,2.7972813348301528,2.5336968139574321,2.3045830956567186,2.2267833795777636,2.1138429683971682,2.1234584270966104,2.2181159363675955,2.2669579153508947,2.4527277514237653,2.6693093727857793,2.8069901489571136,2.8678989020441064,2.8201877010390604,2.6203112867942031,2.3767644911682972,2.2038691200548879,2.2321626286975,2.3035845933271291,2.2884861686145439,2.4283362982996062,2.5839975524322312,2.7763317085186157,2.8825635754483532,2.9025198918318122,2.8284963541780774,2.5945081597030812,2.3164879981630371,2.2289385528257473,2.1860512767380942,2.2648832258100344,2.2782924004250011,2.3075726345050849,2.6041700706148179,2.8015405441895487,2.8820035082256483,2.9210087273580543,2.8466520505398383,2.5030739537434492,2.2428350885882717,2.2638442646776151,2.2364452904895007,2.2407096892759584,2.2428350885882717,2.3841650799864684,2.5463152779166438,2.7472709142554912,2.8758219768814333,2.9107188992270343,2.8684669225081145,2.5257286443082556,2.2332350148592526,2.2300144001592104,2.2438960966453663,2.2181159363675955,2.2823823856765264,2.3437270363252209,2.4672517145492794,2.7298116928837226,2.8616292890305104,2.9052603703899154,2.8243506567983707,2.5063419305080652,2.3969857684155298,2.2772672850097559,2.2638442646776151,2.2278615467981093,2.3485140248824456,2.5071572587228199,2.6440448711262978,2.8758219768814333,2.9861868607104594,3.0378334495726262,3.0022112396517002,2.8564702062204832,2.5733752977756086,2.5710843460290524,2.4882344398806748,2.4973291697865574,2.5603232890727545,2.6369121732688705,2.8724340572094973,3.1095072878128356,3.201526186533088,3.2343553957165869,3.1994891110680106,2.9242362718489212,2.7447035187502458,2.6851226964585053,2.73696154459663,2.7199787719674839,2.631888840136646,2.67827804276854,2.8267217308197088,3.0120976276402551,3.1009927842114839,3.1544439647088121,3.0937660138253564,2.8249439525737094,2.6019486702196644,2.5687881337687024,2.4689466302092709,2.5779415157551897,2.6217658325051976,2.67000213346468,2.8808824318750488,3.0411835364579085,3.1354942159291497,3.1557230098629323,3.1228053561174671,2.924773184613497,2.7020321287766471,2.563409711275944],"mode":"lines","name":"Henry Hub Natural Gas price","type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Year","anchor":"y4"},"yaxis4":{"domain":[0,0.23000000000000001],"automargin":true,"anchor":"x","title":"Price"},"yaxis3":{"domain":[0.27000000000000002,0.47999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis2":{"domain":[0.52000000000000002,0.72999999999999998],"automargin":true,"anchor":"x","title":"Temperature (C)"},"yaxis":{"domain":[0.77000000000000002,1],"automargin":true,"anchor":"x","title":"Value"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Time Series of Natural gas power generation, temperature, and oil and gas prices"},"attrs":{"46e42de82151":{"x":{},"y":{},"mode":"lines","name":"Natural Gas Electricity Generation","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e451e56a2a":{"x":{},"y":{},"mode":"lines","name":"Global Average Temperature Anomaly","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e440a2c4f":{"x":{},"y":{},"mode":"lines","name":"WTI Oil price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"46e4380514c4":{"x":{},"y":{},"mode":"lines","name":"Henry Hub Natural Gas price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>The ARIMA(4,1,0) model generally captures the directionality, but the residual structure is still not ideal, indicating that the current ARIMAX specification may be underfitting and requires the inclusion of seasonality or alternative lag orders.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">anomaly =</span> <span class="fu">as.numeric</span>(ts_anomaly),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">wti     =</span> <span class="fu">as.numeric</span>(ts_wti),</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">np      =</span> <span class="fu">as.numeric</span>(ts_np)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>fit_auto <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(ts_n),</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xreg =</span> X)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: as.numeric(ts_n) 
Regression with ARIMA(4,1,0) errors 

Coefficients:
          ar1      ar2      ar3      ar4   anomaly       wti         np
      -0.1339  -0.3445  -0.3984  -0.2631  4125.500  -48.2789  62325.321
s.e.   0.0582   0.0529   0.0517   0.0563  5066.948   80.9044   4036.709

sigma^2 = 105186192:  log likelihood = -3182.66
AIC=6381.33   AICc=6381.83   BIC=6410.93

Training set error measures:
                   ME     RMSE      MAE      MPE     MAPE      MASE        ACF1
Training set 402.8289 10118.36 7933.104 -0.82718 9.157407 0.7122981 -0.01555444</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(4,1,0) errors
Q* = 32.023, df = 6, p-value = 1.615e-05

Model df: 4.   Total lags used: 10</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Natural_gas <span class="sc">~</span> Monthly_Anomaly <span class="sc">+</span> WTI <span class="sc">+</span> HH, <span class="at">data =</span> data_all2)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Natural_gas ~ Monthly_Anomaly + WTI + HH, data = data_all2)

Residuals:
   Min     1Q Median     3Q    Max 
-59790 -14874    632  16338  53566 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -148694.67   11886.85 -12.509   &lt;2e-16 ***
Monthly_Anomaly   82988.81    5361.43  15.479   &lt;2e-16 ***
WTI                  37.29      55.35   0.674    0.501    
HH                69161.93    5263.33  13.140   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21390 on 296 degrees of freedom
Multiple R-squared:  0.6754,    Adjusted R-squared:  0.6721 
F-statistic: 205.3 on 3 and 296 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>From the regression model, temperature and natural gas price are statistically significant, indicating that they have a meaningful impact on total natural gas electricity generation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(lm_fit))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Moreover, the residuals exhibit a high correlation, indicating significant serial correlation that remains unexplained. This suggests that traditional machine learning models may struggle to fully capture the underlying temporal patterns in these time series variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>res.fit <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">residuals</span>(lm_fit), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(res.fit)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(res.fit)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>first_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(res.fit)  </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>seasonal_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(first_diff, <span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="do">###### Plot ACF and PACF for the Differenced Series ######</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(first_diff) <span class="sc">+</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ACF of first Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(first_diff) <span class="sc">+</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"PACF of first Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"PACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This series appears closer to weak stationarity. The ACF plot shows clear autocorrelations at lags q = 0,1,2,3 and Q = 1,2,3.</p>
<p>Additionally, both first-order differencing (d = 1) and seasonal differencing (D = 1) have been applied to the data.</p>
<p>The PACF plot shows clear autocorrelations at lags p = 0,1,2,3,4 and P = 0,1,2,3.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Define SARIMA Model Comparison Function ######</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>SARIMA.c <span class="ot">&lt;-</span> <span class="cf">function</span>(p_range, d_range, q_range, P_range, D_range, Q_range, data) {</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set seasonal period</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize results storage</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over parameter combinations</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p_range) {</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> d_range) {</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (q <span class="cf">in</span> q_range) {</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (P <span class="cf">in</span> P_range) {</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (D <span class="cf">in</span> D_range) {</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (Q <span class="cf">in</span> Q_range) {</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (p <span class="sc">+</span> d <span class="sc">+</span> q <span class="sc">+</span> P <span class="sc">+</span> D <span class="sc">+</span> Q <span class="sc">&lt;=</span> <span class="dv">10</span>) {</span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>                result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>                  model <span class="ot">&lt;-</span> <span class="fu">Arima</span>(</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>                    data,</span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">order =</span> <span class="fu">c</span>(p, d, q),</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(P, D, Q), <span class="at">period =</span> s)</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q,</span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">AIC</span>(model),</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">BIC</span>(model),</span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>                    model<span class="sc">$</span>aicc)</span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>                }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>                results_list[[<span class="fu">length</span>(results_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> result</span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb124-38"><a href="#cb124-38" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb124-39"><a href="#cb124-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb124-40"><a href="#cb124-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb124-41"><a href="#cb124-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb124-42"><a href="#cb124-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb124-43"><a href="#cb124-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-44"><a href="#cb124-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert results to a tidy data frame</span></span>
<span id="cb124-45"><a href="#cb124-45" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind, results_list))</span>
<span id="cb124-46"><a href="#cb124-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(results_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"d"</span>, <span class="st">"q"</span>, <span class="st">"P"</span>, <span class="st">"D"</span>, <span class="st">"Q"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"AICc"</span>)</span>
<span id="cb124-47"><a href="#cb124-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-48"><a href="#cb124-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_df)</span>
<span id="cb124-49"><a href="#cb124-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-50"><a href="#cb124-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-51"><a href="#cb124-51" aria-hidden="true" tabindex="-1"></a><span class="do">###### Run SARIMA Model Comparison ######</span></span>
<span id="cb124-52"><a href="#cb124-52" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">SARIMA.c</span>(</span>
<span id="cb124-53"><a href="#cb124-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb124-54"><a href="#cb124-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_range =</span> <span class="dv">1</span>, <span class="at">D_range =</span> <span class="dv">1</span>, </span>
<span id="cb124-55"><a href="#cb124-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">Q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb124-56"><a href="#cb124-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> res.fit</span>
<span id="cb124-57"><a href="#cb124-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb124-58"><a href="#cb124-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-59"><a href="#cb124-59" aria-hidden="true" tabindex="-1"></a><span class="do">###### Identify Models with Minimum AIC and BIC ######</span></span>
<span id="cb124-60"><a href="#cb124-60" aria-hidden="true" tabindex="-1"></a>minaic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC), ]</span>
<span id="cb124-61"><a href="#cb124-61" aria-hidden="true" tabindex="-1"></a>minbic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC), ]</span>
<span id="cb124-62"><a href="#cb124-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-63"><a href="#cb124-63" aria-hidden="true" tabindex="-1"></a><span class="do">###### Display Best Models Based on AIC and BIC ######</span></span>
<span id="cb124-64"><a href="#cb124-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(minaic)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    p d q P D Q      AIC     BIC     AICc
156 2 1 2 0 1 1 6174.973 6196.93 6175.273</code></pre>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>The model ARIMA(2,1,2)x(0,1,1)[12] works siginificantly better than ARIMA(4,1,0) due to the lower AIC, BIC, and AICc numbers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>model_output_1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Function to Extract Model Diagnostics ######</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>extract_model_diagnostics <span class="ot">&lt;-</span> <span class="cf">function</span>(model_output) {</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  start_line <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Coefficients"</span>, model_output)  <span class="co"># Find where coefficients start</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  end_line <span class="ot">&lt;-</span> <span class="fu">length</span>(model_output)  <span class="co"># Capture till the last line</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(start_line) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(model_output[start_line<span class="sc">:</span>end_line], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Print coefficient section</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No coefficient details found.</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Handle cases where output format changes</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(2,1,2)x(0,1,1)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(2,1,2)x(0,1,1)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
     Estimate     SE  t.value p.value
ar1   -0.1671 0.1309  -1.2764  0.2029
ar2    0.5522 0.0759   7.2781  0.0000
ma1   -0.2340 0.1377  -1.6994  0.0904
ma2   -0.6145 0.1145  -5.3683  0.0000
sma1  -0.8267 0.0458 -18.0527  0.0000

sigma^2 estimated as 117746620 on 282 degrees of freedom 
 
AIC = 21.51558  AICc = 21.51633  BIC = 21.59209 
 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>model_output_2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(4,1,0) ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(4,1,0) ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate       SE t.value p.value
ar1       -0.1969   0.0567 -3.4719  0.0006
ar2       -0.1995   0.0511 -3.9047  0.0001
ar3       -0.4763   0.0510 -9.3452  0.0000
ar4       -0.2042   0.0570 -3.5827  0.0004
constant -62.7302 375.9731 -0.1668  0.8676

sigma^2 estimated as 180646297 on 294 degrees of freedom 
 
AIC = 21.89311  AICc = 21.8938  BIC = 21.96737 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<p>Using corss validation, we can find that ARIMA(2,1,2)x(0,1,1)[12] is the better model since is stays at a lower RMSE for the majority of the time in the plot below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(res.fit)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">90</span>   <span class="co"># initial training size</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">27</span>, <span class="dv">4</span>)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">27</span>, <span class="dv">4</span>)</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>) {</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># training = first (k+i-1) observations</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> y[<span class="dv">1</span><span class="sc">:</span>(k<span class="sc">+</span>i<span class="dv">-1</span>)]</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test = next 4 observations</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>  xtest  <span class="ot">&lt;-</span> y[(k<span class="sc">+</span>i)<span class="sc">:</span>(k<span class="sc">+</span>i<span class="sc">+</span><span class="dv">3</span>)]</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit ARIMA models</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">order=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ensure xtest length = 4</span></span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(xtest)<span class="sc">==</span><span class="dv">4</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(fcast<span class="sc">$</span>mean)<span class="sc">==</span><span class="dv">4</span>) {</span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>    rmse1[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a>    rmse2[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a><span class="co"># final RMSE</span></span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse1, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11173.86 14727.87 16605.97 17738.84</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse2, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11169.59 13342.43 12813.27 11401.01</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### RMSE Plot using Plotly #####</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for RMSE values by quarter</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>qr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Q1"</span>, <span class="st">"Q2"</span>, <span class="st">"Q3"</span>, <span class="st">"Q4"</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>rmse11 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>rmse22 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an interactive RMSE comparison plot</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse11, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"blue"</span>), <span class="at">name =</span> <span class="st">"RMSE1: ARIMA(2,1,2)x(0,1,1)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse22, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"RMSE2: ARIMA(4,1,0)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cross-Validation RMSE"</span>,</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Quarter"</span>),</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"RMSE"</span>),</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Model"</span>)</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7176cab086a048271111" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7176cab086a048271111">{"x":{"visdat":{"46e4418d1186":["function () ","plotlyVisDat"],"46e4416116ed":["function () ","data"],"46e459a22f68":["function () ","data"]},"cur_data":"46e459a22f68","attrs":{"46e4416116ed":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["blue"],"name":"RMSE1: ARIMA(2,1,2)x(0,1,1)[12]","inherit":true},"46e459a22f68":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["red"],"name":"RMSE2: ARIMA(4,1,0)","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cross-Validation RMSE","xaxis":{"domain":[0,1],"automargin":true,"title":"Quarter","type":"category","categoryorder":"array","categoryarray":["Q1","Q2","Q3","Q4"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"RMSE"},"legend":{"title":"Model"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Q1","Q2","Q3","Q4"],"y":[11173.860798177513,14727.871668270898,16605.967336101112,17738.841022677803],"type":"scatter","mode":"lines","name":"RMSE1: ARIMA(2,1,2)x(0,1,1)[12]","marker":{"color":"rgba(0,0,255,1)","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Q1","Q2","Q3","Q4"],"y":[11169.589432158484,13342.434274595242,12813.272155252955,11401.005784721961],"type":"scatter","mode":"lines","name":"RMSE2: ARIMA(4,1,0)","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the dependent variable (TotalVehicleSales)</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(y)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>ts_anomaly <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ts_anomaly)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>ts_wti     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ts_wti)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>ts_np      <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ts_np)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define external regressors (all variables except TotalVehicleSales)</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>xreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ts_anomaly, ts_wti, ts_np)</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,1,0)x(0,0,1)[12] with external regressors</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="co">#fit1 &lt;- Arima(y, order = c(2,1,2), seasonal = list(order = c(2,0,1), period = 12), xreg = xreg)</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y 
Regression with ARIMA(2,1,2)(0,1,1)[12] errors 

Coefficients:
          ar1     ar2      ma1      ma2     sma1  ts_anomaly    ts_wti
      -0.1907  0.6612  -0.1396  -0.8344  -0.6714  -78834.931  -43.9766
s.e.   0.0799  0.0585   0.0786   0.0759   0.0446    2812.808   38.9504
           ts_np
      -82497.919
s.e.    5516.879

sigma^2 = 28024043:  log likelihood = -2869.2
AIC=5756.4   AICc=5757.05   BIC=5789.34

Training set error measures:
                  ME     RMSE      MAE      MPE     MAPE      MASE         ACF1
Training set 274.502 5105.131 4010.581 4.325729 64.16456 0.3178684 -0.007055458</code></pre>
</div>
</div>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model to each external regressor</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>temp_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_anomaly"</span>])</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(FinR_fit)</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>ftemp <span class="ot">&lt;-</span> <span class="fu">forecast</span>(temp_fit, <span class="at">h =</span> <span class="dv">32</span>)  <span class="co"># Forecast next 32 periods</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>wti_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_wti"</span>])</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(Imp_fit)</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>fwti <span class="ot">&lt;-</span> <span class="fu">forecast</span>(wti_fit, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>hh_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_np"</span>])</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(CPI_fit)</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>fhh <span class="ot">&lt;-</span> <span class="fu">forecast</span>(hh_fit, <span class="at">h =</span> <span class="dv">32</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create future external regressor matrix using forecasted values</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>fxreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">anomaly =</span> <span class="fu">as.numeric</span>(ftemp<span class="sc">$</span>mean),</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">wti  =</span> <span class="fu">as.numeric</span>(fwti<span class="sc">$</span>mean),</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">np   =</span> <span class="fu">as.numeric</span>(fhh<span class="sc">$</span>mean)</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,0,2)x(0,0,1)[12] with external regressors</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast TotalVehicleSales using future external regressors</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg =</span> fxreg, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forecast</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ICLN Prices Forecast"</span>) <span class="sc">+</span></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>