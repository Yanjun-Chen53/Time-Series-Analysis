<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.21">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ARIMAX, SARIMAX, and VAR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assets/gu-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea1d7ac60288e0f1efdbc993fd8432ae.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-870b6070356b2f6ba798b4fc2bd491a6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>

<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>

<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>



</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./source.html"> 
<span class="menu-text">Data Sources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./visualization.html"> 
<span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./EDA.html"> 
<span class="menu-text">Exploratory Data Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./univariate.html"> 
<span class="menu-text">Univariate TS Models (ARIMA/SARIMA)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./multivariate.html" aria-current="page"> 
<span class="menu-text">Multivariate TS Models (ARIMAX/SARIMAX/VAR)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./financial.html"> 
<span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DL.html"> 
<span class="menu-text">Deep Learning for TS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./other.html"> 
<span class="menu-text">Other-Interrupted TS/ARFIMA/Spectral Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusion.html"> 
<span class="menu-text">Conclusions</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link active" data-scroll-target="#literature-review">Literature Review</a>
  <ul class="collapse">
  <li><a href="#drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy" id="toc-drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy" class="nav-link" data-scroll-target="#drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy">1. Drivers of Energy Transition – The Tripartite Effect of Price, Climate, and Policy</a></li>
  <li><a href="#price-outputinvestment-transmission-mechanism-substitution-and-demand-channels" id="toc-price-outputinvestment-transmission-mechanism-substitution-and-demand-channels" class="nav-link" data-scroll-target="#price-outputinvestment-transmission-mechanism-substitution-and-demand-channels">2. Price-Output/Investment Transmission Mechanism (Substitution and Demand Channels)</a></li>
  <li><a href="#application-of-time-series-and-multivariate-methods-in-energy-research" id="toc-application-of-time-series-and-multivariate-methods-in-energy-research" class="nav-link" data-scroll-target="#application-of-time-series-and-multivariate-methods-in-energy-research">3. Application of Time Series and Multivariate Methods in Energy Research</a></li>
  <li><a href="#financial-market-perspective-etfs-and-energy-transition-signals" id="toc-financial-market-perspective-etfs-and-energy-transition-signals" class="nav-link" data-scroll-target="#financial-market-perspective-etfs-and-energy-transition-signals">4. Financial Market Perspective: ETFs and Energy Transition Signals</a></li>
  </ul></li>
  <li><a href="#key-research-questions" id="toc-key-research-questions" class="nav-link" data-scroll-target="#key-research-questions">Key Research Questions</a></li>
  <li><a href="#arimax-solar-power-generation-temperature-oil-prices-gas-prices" id="toc-arimax-solar-power-generation-temperature-oil-prices-gas-prices" class="nav-link" data-scroll-target="#arimax-solar-power-generation-temperature-oil-prices-gas-prices">(1) ARIMAX: Solar power generation ~ temperature + oil prices + gas prices</a></li>
  <li><a href="#arimax-icln-xle-oil-prices-gas-prices" id="toc-arimax-icln-xle-oil-prices-gas-prices" class="nav-link" data-scroll-target="#arimax-icln-xle-oil-prices-gas-prices">(2) ARIMAX: ICLN ~ XLE + oil prices + gas prices</a></li>
  <li><a href="#var-the-dynamic-relationship-between-clean-and-traditional-energy" id="toc-var-the-dynamic-relationship-between-clean-and-traditional-energy" class="nav-link" data-scroll-target="#var-the-dynamic-relationship-between-clean-and-traditional-energy">(3) VAR: The dynamic relationship between clean and traditional energy</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ARIMAX, SARIMAX, and VAR</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review">Literature Review</h2>
<section id="drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy" class="level3">
<h3 class="anchored" data-anchor-id="drivers-of-energy-transition-the-tripartite-effect-of-price-climate-and-policy">1. Drivers of Energy Transition – The Tripartite Effect of Price, Climate, and Policy</h3>
<p>Energy transition is both a result of technological evolution and a dynamic process driven by the combined effects of economics, climate, and policy. Numerous studies have shown that fossil fuel prices (such as crude oil and natural gas) have a significant impact on the development of renewable energy: when oil or natural gas prices rise, the relative cost of fossil fuels increases, enhancing the relative competitiveness of clean energy, thereby driving growth in renewable power generation or related investment. Simultaneously, climate and weather variables (temperature, irradiance, degree-days) directly affect the short-term output of renewable power generation: solar power is affected by solar irradiance and temperature (high temperatures may slightly reduce photovoltaic efficiency), while wind power is affected by seasonal wind speeds and extreme weather. Finally, policy (subsidies, feed-in tariffs, carbon prices) is a structural driver: policy shocks typically produce lasting trend changes or step responses.</p>
</section>
<section id="price-outputinvestment-transmission-mechanism-substitution-and-demand-channels" class="level3">
<h3 class="anchored" data-anchor-id="price-outputinvestment-transmission-mechanism-substitution-and-demand-channels">2. Price-Output/Investment Transmission Mechanism (Substitution and Demand Channels)</h3>
<p>Literature divides price transmission into supply-side and demand-side mechanisms: Price increases make renewable energy more attractive by raising the cost of fossil fuel power generation (or the marginal cost of fuel power generation) (substitution effect); another channel is the financial market: oil and gas prices affect the earnings and stock performance of related energy companies, which in turn affects ETFs or capital flows (ICLE, XLE, etc.). These financial variables then feed back into investment and project construction decisions.</p>
</section>
<section id="application-of-time-series-and-multivariate-methods-in-energy-research" class="level3">
<h3 class="anchored" data-anchor-id="application-of-time-series-and-multivariate-methods-in-energy-research">3. Application of Time Series and Multivariate Methods in Energy Research</h3>
<p>In empirical methods, researchers widely use ARIMAX/SARIMAX (modeling a single response variable under exogenous shocks) to characterize the short-term impact of exogenous variables such as weather/prices on power generation or prices; while VAR/VECM/VARMA are used to study the dynamic interactions between several endogenous variables (e.g., how wind, solar, natural gas, and coal power generation interact), and to conduct impact response analysis (IRFs) and variance decomposition to identify shock sources and propagation paths. Model selection typically considers the seasonality, trend, and cointegration of time series data.</p>
</section>
<section id="financial-market-perspective-etfs-and-energy-transition-signals" class="level3">
<h3 class="anchored" data-anchor-id="financial-market-perspective-etfs-and-energy-transition-signals">4. Financial Market Perspective: ETFs and Energy Transition Signals</h3>
<p>ETFs (such as clean energy ETFs vs.&nbsp;traditional energy ETFs) are often used as market signals for the energy transition. Empirical research shows that energy ETFs are sensitive to oil and gas prices, macroeconomic and policy news, and can reflect investors’ expectations for the transition prospects. Therefore, using ETFs as financial indicators can supplement the dimension of market expectations that cannot be directly captured by physical electricity generation sequences.</p>
</section>
</section>
<section id="key-research-questions" class="level2">
<h2 class="anchored" data-anchor-id="key-research-questions">Key Research Questions</h2>
<ol type="1">
<li><strong>Does the price of fossil fuels drive the growth of solar power generation through substitution effects?</strong>
<ul>
<li>What are the immediate or lagged responses of solar power if WTI or HH rises? (Examine the β parameter and impulse response)</li>
</ul></li>
<li><strong>What are the short-term and seasonal effects of weather variables (temp or degree-days) on solar output? Are there nonlinearities (e.g., excessively high temperatures reduce efficiency)?</strong>
<ul>
<li>It is necessary to examine the linear/quadratic terms of temp, as well as the seasonal interaction term.</li>
</ul></li>
<li><strong>Are there substitution or complementarity relationships in the power generation structure (wind, solar, coal, natural gas)? How do shocks (e.g., rising natural gas prices) propagate between different energy sources?</strong>
<ul>
<li>VAR can be used to obtain the impulse response function (IRF) and variance decomposition to answer these questions.</li>
</ul></li>
<li><strong>How do financial markets (ICLE vs XLE) reflect expectations of energy transition? Are these ETFs leading/lagging relationships with actual power generation data or fuel prices?</strong>
<ul>
<li>VAR can be used to test Granger causality and interaction.</li>
</ul></li>
<li><strong>Have policies or structural events altered the long-term relationships between energy variables (e.g., trend abrupt changes or changes in cointegration structures)?</strong>
<ul>
<li>Examine structural breakpoints and incorporate policy dummy variables to quantify policy effects.</li>
</ul></li>
<li><strong>Forecasting: How does the ARIMAX model perform in short-term solar forecasting, considering the uncertainty of exogenous variables? Is it a significant improvement compared to using an autoregressive model alone?</strong></li>
</ol>
<ul>
<li>Test model stability using time series cross-validation (tsCV) and RMSE comparisons.</li>
</ul>
</section>
<section id="arimax-solar-power-generation-temperature-oil-prices-gas-prices" class="level2">
<h2 class="anchored" data-anchor-id="arimax-solar-power-generation-temperature-oil-prices-gas-prices">(1) ARIMAX: Solar power generation ~ temperature + oil prices + gas prices</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seasonal)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prophet)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fma)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/electric.csv"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">str_extract</span>(Description, <span class="st">"(?&lt;=From ).*?(?=,)"</span>),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>solar_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Solar"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Solar =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Solar =</span> <span class="fu">log</span>(<span class="fu">pmax</span>(Solar, .Machine<span class="sc">$</span>double.eps))) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>ts_solar <span class="ot">&lt;-</span> <span class="fu">ts</span>(solar_df<span class="sc">$</span>Solar,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(solar_df<span class="sc">$</span>Year), <span class="fu">min</span>(solar_df<span class="sc">$</span>Month)),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/WTIprice.csv"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> wti <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> observation_date) <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2000-01-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-12-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">WTI =</span> POILWTIUSDM) <span class="sc">%&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WTI =</span> <span class="fu">as.numeric</span>(WTI))<span class="sc">%&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>ts_wti <span class="ot">&lt;-</span> <span class="fu">ts</span>(wti<span class="sc">$</span>WTI,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/naturalgasprice.csv"</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> df_n <span class="sc">%&gt;%</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">log</span>(<span class="fu">pmax</span>(HH, .Machine<span class="sc">$</span>double.eps))) <span class="sc">%&gt;%</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>ts_np <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_n<span class="sc">$</span>HH,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(df_n<span class="sc">$</span>Year), <span class="fu">min</span>(df_n<span class="sc">$</span>Month)),</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/Global_Temperature_2000onwards.csv"</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="fu">order</span>(df<span class="sc">$</span>Year, df<span class="sc">$</span>Month), ]</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>df_temp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>ts_anomaly <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_temp<span class="sc">$</span>Monthly_Anomaly,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>),   </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">frequency =</span> <span class="dv">12</span>)     </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">auto.arima()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Manual Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Model Diagnostics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Final Model Fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p><strong>The relationship between temperature (temp) and solar power generation:</strong> Solar power generation is closely related to temperature and irradiance, but extreme high temperatures can reduce the efficiency of photovoltaic panels.</p></li>
<li><p><strong>The substitution effect of fossil fuel prices on clean energy:</strong> When oil prices (WTI) or natural gas prices (HH) rise, clean energy (especially wind and solar power) becomes more economically attractive.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> solar_df <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_temp, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(wti, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_n, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual plots for each variable with y-axis labels</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Solar, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Solar Electricity Generation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Value"</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>Monthly_Anomaly, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Global Average Temperature Anomaly"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperature (C)"</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>WTI, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"WTI Oil price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>HH, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Henry Hub Natural Gas price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the individual plots into a single figure with subplots and y-axis labels</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">subplot</span>(p2, p3, p4, p1, <span class="at">nrows =</span> <span class="dv">4</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>, <span class="at">titleX =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Time Series of Solar power generation, temperature, and oil and gas prices"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Value"</span>), </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperature (C)"</span>), </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis3 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis4 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>final_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5e5aac541953a3b78005" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5e5aac541953a3b78005">{"x":{"data":[{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[0.33900000000000002,0.60099999999999998,0.57199999999999995,0.64400000000000002,0.42399999999999999,0.45000000000000001,0.38800000000000001,0.48699999999999999,0.46200000000000002,0.27900000000000003,0.33800000000000002,0.35699999999999998,0.52200000000000002,0.50600000000000001,0.61199999999999999,0.61699999999999999,0.61099999999999999,0.56599999999999995,0.57599999999999996,0.48799999999999999,0.55500000000000005,0.51100000000000001,0.71099999999999997,0.67800000000000005,0.77900000000000003,0.73399999999999999,0.94599999999999995,0.69499999999999995,0.69999999999999996,0.57399999999999995,0.60199999999999998,0.56999999999999995,0.68899999999999995,0.61599999999999999,0.58399999999999996,0.58099999999999996,0.81200000000000006,0.61899999999999999,0.59899999999999998,0.64600000000000002,0.67000000000000004,0.501,0.56699999999999995,0.66700000000000004,0.69499999999999995,0.747,0.54000000000000004,0.79400000000000004,0.65800000000000003,0.73999999999999999,0.64400000000000002,0.71199999999999997,0.438,0.44400000000000001,0.254,0.47499999999999998,0.55200000000000005,0.63200000000000001,0.70499999999999996,0.55900000000000005,0.80000000000000004,0.69399999999999995,0.78900000000000003,0.76800000000000002,0.70699999999999996,0.69699999999999995,0.61099999999999999,0.64200000000000002,0.749,0.82499999999999996,0.72999999999999998,0.77700000000000002,0.64900000000000002,0.83599999999999997,0.70399999999999996,0.623,0.56699999999999995,0.67400000000000004,0.47299999999999998,0.748,0.64600000000000002,0.70699999999999996,0.70899999999999996,0.85199999999999998,0.997,0.77400000000000002,0.70199999999999996,0.88400000000000001,0.72199999999999998,0.62,0.64300000000000002,0.64400000000000002,0.61499999999999999,0.63900000000000001,0.59899999999999998,0.52700000000000002,0.318,0.373,0.68999999999999995,0.60799999999999998,0.57599999999999996,0.51400000000000001,0.57899999999999996,0.49199999999999999,0.68400000000000005,0.71299999999999997,0.67900000000000005,0.60599999999999998,0.72199999999999998,0.59899999999999998,0.52400000000000002,0.66400000000000003,0.67500000000000004,0.70299999999999996,0.78800000000000003,0.748,0.748,0.72399999999999998,0.78700000000000003,0.79200000000000004,0.83699999999999997,0.91900000000000004,0.93400000000000005,0.98899999999999999,0.82199999999999995,0.70099999999999996,0.61499999999999999,0.70499999999999996,0.68700000000000006,0.751,0.78200000000000003,0.57799999999999996,0.62,0.58099999999999996,0.70399999999999996,0.72499999999999998,0.59499999999999997,0.68799999999999994,0.79100000000000004,0.81999999999999995,0.60299999999999998,0.66800000000000004,0.57199999999999995,0.65000000000000002,0.48699999999999999,0.53900000000000003,0.52400000000000002,0.78300000000000003,0.82399999999999995,0.70299999999999996,0.57999999999999996,0.749,0.78100000000000003,0.85399999999999998,0.81399999999999995,0.61399999999999999,0.747,0.61599999999999999,0.68700000000000006,0.64400000000000002,0.68600000000000005,0.68400000000000005,0.58699999999999997,0.73299999999999998,0.79200000000000004,0.70499999999999996,0.83899999999999997,0.74399999999999999,0.79500000000000004,0.59099999999999997,0.78700000000000003,0.86299999999999999,0.90200000000000002,0.68500000000000005,0.58499999999999996,0.89300000000000002,0.93500000000000005,0.85699999999999998,0.63400000000000001,0.81599999999999995,0.871,0.90200000000000002,0.91800000000000004,0.86799999999999999,0.86699999999999999,0.83299999999999996,0.73899999999999999,0.875,0.89600000000000002,1.0960000000000001,1.0189999999999999,1.1919999999999999,1.2529999999999999,1.3380000000000001,1.329,1.179,1.052,0.84199999999999997,0.84199999999999997,1.0429999999999999,0.92700000000000005,0.96199999999999997,0.96099999999999997,0.97399999999999998,1.0940000000000001,1.181,1.222,1.0449999999999999,0.98699999999999999,0.73299999999999998,0.81399999999999995,0.90100000000000002,0.78600000000000003,0.92600000000000005,0.85699999999999998,0.996,0.878,0.92700000000000005,0.93100000000000005,0.99099999999999999,0.85199999999999998,0.80800000000000005,0.81000000000000005,0.83299999999999996,0.81200000000000006,1.0129999999999999,0.82099999999999995,0.97799999999999998,0.95599999999999996,0.99299999999999999,1.2190000000000001,1.113,0.92900000000000005,0.88800000000000001,0.95699999999999996,1.002,0.94899999999999995,1.109,1.012,1.161,1.2010000000000001,1.2310000000000001,1.1779999999999999,1.2310000000000001,1.046,0.92300000000000004,0.93100000000000005,0.95399999999999996,1.0089999999999999,0.93100000000000005,1.0880000000000001,0.86599999999999999,0.89400000000000002,0.69799999999999995,0.86799999999999999,0.88500000000000001,0.86799999999999999,0.84499999999999997,0.90600000000000003,0.90400000000000003,0.98899999999999999,1.0600000000000001,0.93100000000000005,0.88900000000000001,0.94599999999999995,0.88900000000000001,1.0780000000000001,0.92700000000000005,0.89600000000000002,0.97199999999999998,0.92500000000000004,0.97599999999999998,0.91900000000000004,1.0409999999999999,0.72999999999999998,0.93600000000000005,0.92500000000000004,0.98499999999999999,1.268,1.0860000000000001,1.002,1.1299999999999999,1.266,1.3149999999999999,1.548,1.393,1.3999999999999999,1.427,1.3,1.4259999999999999,1.343,1.3520000000000001,1.2230000000000001,1.23,1.2290000000000001,1.383,1.2709999999999999,1.3680000000000001,1.3129999999999999,1.2889999999999999],"mode":"lines","name":"Global Average Temperature Anomaly","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[27.224285714285699,29.362380952380899,29.8921739130435,25.798999999999999,28.833478260869601,31.859090909090899,29.983809523809501,31.218695652173899,33.859999999999999,33.075000000000003,34.555,28.3880952380952,29.4821739130435,29.583500000000001,27.241363636363602,27.4538095238095,28.610434782608699,27.6009523809524,26.435909090909099,27.467826086956499,26.210999999999999,22.210434782608701,19.5840909090909,19.317619047619001,19.6073913043478,20.775500000000001,24.508095238095201,26.2663636363636,27.003913043478299,25.521000000000001,26.93,28.381363636363599,29.632857142857102,28.8539130434783,26.3247619047619,29.548636363636401,32.911739130434803,35.914999999999999,33.219047619047601,28.357727272727299,28.223636363636398,30.724761904761898,30.747391304347801,31.5919047619048,28.451363636363599,30.330869565217402,30.962499999999999,32.204347826087002,34.146363636363603,34.722000000000001,36.760869565217398,36.719090909090902,40.272857142857099,38.041363636363599,40.685000000000002,44.935909090909099,45.860909090909097,53.1671428571428,48.532272727272698,43.279130434782601,46.991904761904799,47.990499999999997,54.093043478260903,53.036666666666697,49.922272727272698,56.305454545454602,58.705714285714301,64.968260869565199,65.6577272727273,62.370476190476197,58.311363636363602,59.366363636363602,65.232727272727303,61.543999999999997,62.899565217391299,69.673500000000004,70.959130434782594,70.957727272727297,74.361428571428604,73.048695652173905,64.119047619047606,58.878181818181801,59.289090909090902,62.028571428571396,54.780000000000001,59.269500000000001,60.564090909090901,63.974761904761898,63.513478260869597,67.478571428571399,74.046363636363594,72.392173913043493,79.632999999999996,85.926521739130393,94.766363636363593,91.774761904761903,92.982608695652203,95.361428571428604,105.50380952381001,112.336363636364,125.67136363636401,133.92809523809501,133.95826086956501,116.69714285714301,104.443636363636,76.283913043478293,56.968000000000004,40.644347826086999,41.6309090909091,39.078499999999998,47.979999999999997,49.905909090909098,59.257142857142803,69.672272727272698,64.208695652173901,71.064285714285703,69.397727272727295,75.823636363636396,77.972380952381002,74.625652173912997,78.418571428571397,76.308000000000007,81.242173913043501,84.497727272727303,73.842380952380907,75.349090909090904,76.177272727272694,76.618181818181796,75.273636363636399,81.902380952380994,84.148636363636399,89.366956521739098,89.523809523809504,89.414000000000001,102.935652173913,110.147619047619,101.29909090909101,96.2886363636364,97.078095238095202,86.334347826086997,85.648181818181797,86.411904761904793,97.109090909090895,98.566818181818206,100.102272727273,102.297142857143,106.187272727273,103.325714285714,94.534782608695707,82.400476190476198,87.919090909090897,94.118260869565205,94.704499999999996,89.596521739130395,86.720909090909103,88.262857142857101,94.729565217391297,95.3095,93.199047619047604,92.067727272727296,94.766956521739104,95.769499999999994,104.42652173913,106.435454545455,106.395238095238,100.556956521739,93.850952380952407,97.890454545454503,94.9630434782609,100.705,100.568095238095,102.175,101.99636363636399,105.234761904762,102.948260869565,96.317142857142898,93.271818181818205,84.406086956521705,75.707499999999996,59.139565217391301,47.557272727272696,50.856999999999999,47.782272727272698,54.378636363636403,59.388571428571403,59.828636363636399,51.198695652173903,42.912857142857099,45.509999999999998,46.268636363636404,42.585238095238097,37.3960869565217,31.784285714285701,30.377619047619,37.901739130434798,41.031904761904798,46.841818181818198,48.791818181818201,44.896190476190498,44.7517391304348,45.200000000000003,49.809523809523803,45.470909090909103,52.052727272727303,52.561818181818197,53.450000000000003,49.363043478260899,51.173999999999999,48.559565217391302,45.185454545454498,46.581904761904802,48.047826086956498,49.735714285714302,51.573181818181801,56.738181818181801,57.920476190476201,63.584782608695697,62.226999999999997,62.830454545454501,66.313809523809496,69.898695652173899,67.876190476190501,71.0745454545455,67.927391304347793,70.1905,70.753043478260906,56.188181818181803,48.919047619047603,51.227391304347798,54.996000000000002,58.170476190476201,63.870454545454599,60.740000000000002,54.665999999999997,57.376086956521704,54.830454545454501,56.859999999999999,53.960869565217401,56.677619047619103,59.867727272727301,57.7169565217391,50.607999999999997,29.320454545454499,16.975000000000001,28.781428571428599,38.314545454545502,40.7152173913043,42.370952380952403,39.5981818181818,39.405000000000001,41.389047619047602,47.0704347826087,51.849523809523802,59.234499999999997,62.183913043478299,61.417727272727298,65.160952380952395,71.377272727272697,72.591818181818198,67.872272727272701,71.534999999999997,81.3642857142857,79.095454545454601,71.802173913043504,83.277619047618998,91.608000000000004,108.399130434783,101.985238095238,109.71272727272699,114.675909090909,101.91809523809501,93.692608695652197,84.400000000000006,87.286666666666704,84.076363636363595,76.581818181818207,78.251363636363607,77.027500000000003,73.348260869565195,79.126499999999993,71.673478260869601,70.306818181818201,75.766666666666694,81.372608695652204,89.240952380952393,85.469090909090895,77.575454545454505,72.019523809523804,74.003043478260906,77.363809523809493,81.405714285714296,85.347272727272696,79.957391304347894,79.912499999999994,81.947826086956496,76.683181818181794,70.439999999999998,72.164347826086995,69.941428571428602,70.152272727272702],"mode":"lines","name":"WTI Oil price","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[1.8515994695840721,1.8779371654691073,1.9329696377795786,1.9726911717329554,2.1114245875328868,2.2512917986064953,2.3340837600534168,2.3389170222414357,2.3125354238472138,2.244955980157409,2.149433913499871,2.1471001901536506,2.3145136638593193,2.3282528397426234,2.2874714551839976,2.318458442150336,2.4105422344991378,2.4492794721448492,2.4176979000945504,2.3878449369448691,2.3194422100604686,2.1090003439213802,2.0769384114617173,1.9878743481543455,1.9987736386123811,1.9782390361706734,1.9600947840472698,2.0360119837525001,2.1447610078004784,2.259677591982769,2.3331142980288688,2.3456445824544927,2.3253245799635351,2.1529243184396392,2.0781907597781832,2.0630580624293118,2.1016921506146558,2.149433913499871,2.2793164660546914,2.3204250111223765,2.3786197792700432,2.4915511925066687,2.5455312716044354,2.5525652982618152,2.510411940196362,2.3646204839134985,2.2793164660546914,2.252343876557299,2.2731562823032334,2.2874714551839976,2.3055806019738441,2.355177543113216,2.4535879665305731,2.5710843460290524,2.605648267484129,2.6203112867942031,2.5885156324070202,2.4587337754839771,2.4371159859516518,2.4060438013622756,2.388762789235098,2.3860067011331179,2.3832429960115,2.4748563139344988,2.5447466501440172,2.6239436918052106,2.6986730392896132,2.7414849771884473,2.8069901489571136,2.7997173896280341,2.7498317351171653,2.6810215287142909,2.7027025947756149,2.6376277368056642,2.5779415157551897,2.5855058483441162,2.6679224100114309,2.7127060126384039,2.7549337870010606,2.7837759116303458,2.7542974522675299,2.5265283244788197,2.5217206229107165,2.528125768907977,2.4989739069994359,2.4956817229559589,2.550226115908643,2.5885156324070202,2.6871669901857858,2.7899373605743945,2.8160073426073025,2.8160073426073025,2.7744619666214616,2.6789646202071133,2.5680215564985067,2.5128460184772416,2.5047092770841801,2.5321082512722946,2.5748996883147051,2.6734587563325909,2.7930039069823738,2.9396908826703663,3.0335096378880211,3.0041963519661206,2.9128939952449864,2.7376090033437546,2.6246685921631592,2.5525652982618152,2.5249283241374862,2.5063419305080652,2.4832385926873033,2.4578779774000812,2.5541217188094731,2.65745841498615,2.7258901192305411,2.7479117345273405,2.6946271807700692,2.4664031782234406,2.4406063908914204,2.3437270363252209,2.3570732782781154,2.3693087250369538,2.3969857684155298,2.4824035195698819,2.5741377835159431,2.6986730392896132,2.7856283357475848,2.8124102164264526,2.7491921444333851,2.5930133911138515,2.3878449369448691,2.3005830903233728,2.2925347571405443,2.3164879981630371,2.3446862690126808,2.4221443280516848,2.5257286443082556,2.6878474937846906,2.7813006628418027,2.8136106967627028,2.7491921444333851,2.5533438113412288,2.3776925654808512,2.2854389341590751,2.2638442646776151,2.2481289071979869,2.3427668826268775,2.3924257969938352,2.5344901499768282,2.6518325211039815,2.7166795278002644,2.7612749623395079,2.6892071133007303,2.4578779774000812,2.3015845926604621,2.2823823856765264,2.2137538792874301,2.2224590485147608,2.2353763433005955,2.3446862690126808,2.5344901499768282,2.7093826463359885,2.7911651078127169,2.7991089320491769,2.753023566744941,2.5160822672564502,2.3065771142635829,2.2126603854660587,2.2257040486580881,2.2793164660546914,2.3702437414678603,2.4647039424704809,2.6100697927420065,2.7806808921371173,2.8466520505398383,2.8570447537800976,2.7893229212309465,2.5733752977756086,2.3214068472346332,2.3035845933271291,2.2512917986064953,2.2060741926132019,2.2278615467981093,2.3446862690126808,2.5439614125693151,2.7127060126384039,2.7899373605743945,2.826129489167811,2.7972813348301528,2.5336968139574321,2.3045830956567186,2.2267833795777636,2.1138429683971682,2.1234584270966104,2.2181159363675955,2.2669579153508947,2.4527277514237653,2.6693093727857793,2.8069901489571136,2.8678989020441064,2.8201877010390604,2.6203112867942031,2.3767644911682972,2.2038691200548879,2.2321626286975,2.3035845933271291,2.2884861686145439,2.4283362982996062,2.5839975524322312,2.7763317085186157,2.8825635754483532,2.9025198918318122,2.8284963541780774,2.5945081597030812,2.3164879981630371,2.2289385528257473,2.1860512767380942,2.2648832258100344,2.2782924004250011,2.3075726345050849,2.6041700706148179,2.8015405441895487,2.8820035082256483,2.9210087273580543,2.8466520505398383,2.5030739537434492,2.2428350885882717,2.2638442646776151,2.2364452904895007,2.2407096892759584,2.2428350885882717,2.3841650799864684,2.5463152779166438,2.7472709142554912,2.8758219768814333,2.9107188992270343,2.8684669225081145,2.5257286443082556,2.2332350148592526,2.2300144001592104,2.2438960966453663,2.2181159363675955,2.2823823856765264,2.3437270363252209,2.4672517145492794,2.7298116928837226,2.8616292890305104,2.9052603703899154,2.8243506567983707,2.5063419305080652,2.3969857684155298,2.2772672850097559,2.2638442646776151,2.2278615467981093,2.3485140248824456,2.5071572587228199,2.6440448711262978,2.8758219768814333,2.9861868607104594,3.0378334495726262,3.0022112396517002,2.8564702062204832,2.5733752977756086,2.5710843460290524,2.4882344398806748,2.4973291697865574,2.5603232890727545,2.6369121732688705,2.8724340572094973,3.1095072878128356,3.201526186533088,3.2343553957165869,3.1994891110680106,2.9242362718489212,2.7447035187502458,2.6851226964585053,2.73696154459663,2.7199787719674839,2.631888840136646,2.67827804276854,2.8267217308197088,3.0120976276402551,3.1009927842114839,3.1544439647088121,3.0937660138253564,2.8249439525737094,2.6019486702196644,2.5687881337687024,2.4689466302092709,2.5779415157551897,2.6217658325051976,2.67000213346468,2.8808824318750488,3.0411835364579085,3.1354942159291497,3.1557230098629323,3.1228053561174671,2.924773184613497,2.7020321287766471,2.563409711275944],"mode":"lines","name":"Henry Hub Natural Gas price","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y3","frame":null},{"x":["2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01","2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01","2004-04-01","2004-05-01","2004-06-01","2004-07-01","2004-08-01","2004-09-01","2004-10-01","2004-11-01","2004-12-01","2005-01-01","2005-02-01","2005-03-01","2005-04-01","2005-05-01","2005-06-01","2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[2.2103601489515285,3.051498051459848,3.3089358832358498,3.6071812101294309,4.0020830637957951,4.0639540808980321,4.4122648177344921,4.1949739035040254,4.1222190989880803,3.6928963754718702,2.9948819120991521,2.7296159790167707,1.8718021769015913,2.5311539009533202,3.4499240517523888,3.6573629868961435,4.3951032616854491,4.5124297016863677,4.5217233575309894,4.4461627310994896,4.171351898582885,3.0355777914761144,2.6594900104868331,1.3952541024913625,2.4265710727750367,3.159762560375694,3.7931718995878208,3.8255496654888019,4.0542167711313217,4.5595764079293719,4.4489490308720825,4.3164876132027272,3.9628681994337147,3.4325668414082129,3.3384350599258399,1.4602416060719736,2.5815038797756698,2.8808824318750488,3.9125628596806128,4.099481346327253,4.2189487254466318,4.5073588809761693,4.1336774485709133,4.127005344461649,4.0227948533820248,3.5677282525497858,2.6412691674118589,1.4471542493766532,2.5344901499768282,2.3852704596126535,3.9689513928140383,4.0413304898994458,4.4039838020259241,4.4759267298669334,4.4079745565946808,4.2883476237898934,4.1048228065097279,3.5121721081044499,2.7305941655371044,2.0487245690177756,2.1596380836741127,2.5712372395390211,3.6417092271374569,4.0649672435114237,4.396336261853989,4.4827313287955137,4.2812251552437024,4.3286917840436354,4.1126427905034761,3.6287312812776582,2.5459233515937747,1.0271162869630397,2.5599368156379927,2.9721053429228346,3.5086756532909833,3.9526657838901627,4.2589404999108975,4.2442290117593924,4.1215705484756917,4.4187562668906057,3.9887988442301956,3.4745407758863651,2.7527685947904748,0.99805503367679471,2.5527210493718568,2.9571993238372074,3.881316344648984,3.9975399329509087,4.4330999048578823,4.4362543693769769,4.4519374180840874,4.3196590885970121,4.2226205024506678,3.8965641303656002,3.1905586514864201,1.6867692553704239,2.7904900333754679,3.5791203901211968,4.3121405072097154,4.5447936583937398,4.5925306424416279,4.8533106938192638,4.7084304977608777,4.656642464357053,4.528256743719119,4.0983863830484326,3.3620406664609614,2.9278280949401183,1.9726911717329554,3.4158889304051452,4.3580796815104081,4.5993130665036936,4.7043365574825904,4.6387306795100525,4.7973430588324204,4.7560956704596551,4.5538137317112604,4.2209918973354652,3.6988792886922699,3.0544256198932094,2.2890945028115466,3.4911599551398851,4.3307201823050283,4.7209868451483556,5.0315614729784324,5.1707850860693343,5.0837742254529976,5.0523720700763368,4.9242128345697811,4.3232846146501185,4.341139533867592,3.7932619917070736,3.6834145486828689,4.4461627310994896,4.8064770426931265,5.0999030125208238,5.2505389403990455,5.4061533157904336,5.2528073169162131,5.4344335407446156,5.2242401631517206,5.0680233112049864,4.6762808134460441,4.7929269452719856,4.5572396522305416,4.9070509778396856,5.4434042367317659,5.7643223870025375,6.1368562646920042,6.2673295724754814,6.2334494795555484,6.1342891859409523,6.1270940496597275,6.0670983189228629,5.8501198528416136,5.8544184135832378,5.736004394317229,6.0699129075621006,6.4287496530721873,6.5023986649882737,6.6236760418511027,6.7692802581680853,6.7200355783915615,6.8502236190239332,6.8551758947776067,6.8952099139384364,6.7145976231581841,6.7452610550615297,6.6215640946042145,6.7274221439666357,7.1831830735318656,7.3045811763434001,7.4671739046252092,7.5618112580018098,7.4886845970429148,7.5387514859432088,7.5133060023354892,7.4482890142308422,7.229577874553649,6.9390058532535335,7.0521594728927219,7.302195839472847,7.6363936304367348,7.7744851097454362,7.8257042352419814,7.8468238157622165,7.8736221517793412,7.8963863931716958,7.7039661394910883,7.5546386015722033,7.4556807145331536,7.3587640171249635,7.3037099727929879,7.7149286693794208,7.8699566044676645,7.9654351503669556,8.1389101799258938,8.1529174343446602,8.2801517604204093,8.2863163148747407,8.1983833719057557,8.0681598212447927,7.9255710203554521,7.792977545646834,7.7510390938572717,7.9197920956402355,8.4149577875059087,8.4983524133946986,8.6630283068597542,8.7185620249414715,8.6249898173463961,8.5883107109059491,8.5290112818704742,8.4445521735280078,8.0736364205374631,8.0179683509387001,8.1074112793023314,8.2678119219506065,8.5283780075036155,8.7089248341474512,8.8318596872769657,8.9112153445952877,8.8180198934530516,8.809177197269193,8.6929769231303275,8.5111129441196223,8.2275799220702286,8.0422622428460713,8.1831761782656329,8.2521262580271131,8.6824747214168045,8.8176349122176116,8.8765301689972702,8.9835769016538016,9.0036409960392003,8.9716457775595053,8.8272070431025718,8.7149723285318998,8.3811427429186782,8.1470204173973784,8.4026522195867752,8.6236067724060828,8.7561541848121553,8.9772385260270937,9.1750660854275203,9.1751282377242855,9.269530836468693,9.1394265852838146,8.953164484572314,8.865761263287057,8.6598238845534805,8.5353126382527389,8.6232175866572387,8.7531198100696788,9.1373590572132937,9.295757595645016,9.4300508369876006,9.4089270154917095,9.4085091128859624,9.3898937676115306,9.3249405699967394,9.1343270935710343,8.9612507384316693,8.7145453867425626,8.9646477403139926,9.1079486672570411,9.3668501526498282,9.5031318441856261,9.62378740625266,9.6836094762501261,9.6655774478411516,9.5820660531967672,9.4944762892453678,9.3877751746798754,9.0362861067566485,8.8213098728113977,8.9626537125202539,9.1521377896526026,9.4102408436193823,9.6199064595611503,9.7573656886671696,9.7888452047522829,9.846616203371525,9.7838055837970188,9.6539245610225954,9.5553979347051179,9.2539849392873439,9.1174031444922008,9.1839557387258708,9.4326139449689705,9.6703150666545596,9.8574999998795647,10.008258159231872,10.097969743187607,10.094127457408314,10.088111955742738,9.9165939867601747,9.8794411411128014,9.5380846303667717,9.4682379062099713],"mode":"lines","name":"Solar Electricity Generation","type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Year","anchor":"y4"},"yaxis4":{"domain":[0,0.23000000000000001],"automargin":true,"anchor":"x","title":"Price"},"yaxis3":{"domain":[0.27000000000000002,0.47999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis2":{"domain":[0.52000000000000002,0.72999999999999998],"automargin":true,"anchor":"x","title":"Temperature (C)"},"yaxis":{"domain":[0.77000000000000002,1],"automargin":true,"anchor":"x","title":"Value"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Time Series of Solar power generation, temperature, and oil and gas prices"},"attrs":{"1838aac3395":{"x":{},"y":{},"mode":"lines","name":"Global Average Temperature Anomaly","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1838640b1109":{"x":{},"y":{},"mode":"lines","name":"WTI Oil price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"18384f18540":{"x":{},"y":{},"mode":"lines","name":"Henry Hub Natural Gas price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"183838eb5141":{"x":{},"y":{},"mode":"lines","name":"Solar Electricity Generation","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fit_auto <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  ts_solar,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">xreg =</span> <span class="fu">cbind</span>(ts_anomaly, ts_wti, ts_np))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_solar 
Regression with ARIMA(0,1,0)(2,0,0)[12] errors 

Coefficients:
        sar1    sar2  ts_anomaly   ts_wti   ts_np
      0.7384  0.0343     -0.2005  -0.0035  0.1222
s.e.  0.0623  0.0655      0.1178   0.0024  0.2867

sigma^2 = 0.0832:  log likelihood = -55.29
AIC=122.58   AICc=122.87   BIC=144.78

Training set error measures:
                      ME      RMSE       MAE        MPE     MAPE      MASE
Training set 0.007005674 0.2855417 0.1738749 -0.5963215 5.174797 0.5206869
                   ACF1
Training set -0.3249882</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,1,0)(2,0,0)[12] errors
Q* = 75.679, df = 22, p-value = 8.212e-08

Model df: 2.   Total lags used: 24</code></pre>
</div>
</div>
<p>The auto.arima() fits a Regression with (0,1,0)(2,0,0)[12] errors. The ACF plot and Ljung–Box test all indicate that the model does not fully capture the seasonal structure.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Solar <span class="sc">~</span> Monthly_Anomaly <span class="sc">+</span> WTI <span class="sc">+</span> HH, <span class="at">data =</span> data_all)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Solar ~ Monthly_Anomaly + WTI + HH, data = data_all)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.4115 -1.0282  0.0462  1.2208  4.0037 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -4.819000   0.880666  -5.472 9.49e-08 ***
Monthly_Anomaly  7.017950   0.397215  17.668  &lt; 2e-16 ***
WTI              0.009648   0.004100   2.353   0.0193 *  
HH               1.839612   0.389946   4.718 3.68e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.585 on 296 degrees of freedom
Multiple R-squared:  0.5961,    Adjusted R-squared:  0.592 
F-statistic: 145.6 on 3 and 296 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>From the regression model, all variables are statistically significant, indicating that WTI oil price, natural gas price and temperature have a meaningful impact on total solar electricity generation. This suggests that changes in these factors directly influence solar electricity generation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(lm_fit))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Moreover, the residuals exhibit a high correlation, indicating significant serial correlation that remains unexplained. This suggests that traditional machine learning models may struggle to fully capture the underlying temporal patterns in these time series variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>res.fit <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">residuals</span>(lm_fit), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(res.fit)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(res.fit)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>first_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(res.fit)  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>seasonal_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(first_diff, <span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">###### Plot ACF and PACF for the Differenced Series ######</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"PACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This series appears closer to weak stationarity. The ACF plot shows clear autocorrelations at lags q = 0,1,2,3 and Q = 1,2.</p>
<p>Additionally, both first-order differencing (d = 1) and seasonal differencing (D = 1) have been applied to the data.</p>
<p>The PACF plot shows clear autocorrelations at lags p = 0,1,2,3 and P = 0,1,2.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Define SARIMA Model Comparison Function ######</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>SARIMA.c <span class="ot">&lt;-</span> <span class="cf">function</span>(p_range, d_range, q_range, P_range, D_range, Q_range, data) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set seasonal period</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize results storage</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over parameter combinations</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p_range) {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> d_range) {</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (q <span class="cf">in</span> q_range) {</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (P <span class="cf">in</span> P_range) {</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (D <span class="cf">in</span> D_range) {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (Q <span class="cf">in</span> Q_range) {</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (p <span class="sc">+</span> d <span class="sc">+</span> q <span class="sc">+</span> P <span class="sc">+</span> D <span class="sc">+</span> Q <span class="sc">&lt;=</span> <span class="dv">10</span>) {</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>                  model <span class="ot">&lt;-</span> <span class="fu">Arima</span>(</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>                    data,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">order =</span> <span class="fu">c</span>(p, d, q),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(P, D, Q), <span class="at">period =</span> s)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">AIC</span>(model),</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">BIC</span>(model),</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>                    model<span class="sc">$</span>aicc)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>                results_list[[<span class="fu">length</span>(results_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> result</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert results to a tidy data frame</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind, results_list))</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(results_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"d"</span>, <span class="st">"q"</span>, <span class="st">"P"</span>, <span class="st">"D"</span>, <span class="st">"Q"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"AICc"</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_df)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="do">###### Run SARIMA Model Comparison ######</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">SARIMA.c</span>(</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_range =</span> <span class="dv">1</span>, <span class="at">D_range =</span> <span class="dv">1</span>, </span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">Q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> res.fit</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="do">###### Identify Models with Minimum AIC and BIC ######</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>minaic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC), ]</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>minbic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC), ]</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="do">###### Display Best Models Based on AIC and BIC ######</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(minaic)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
96 2 1 2 1 1 2 729.6844 758.9602 730.2023</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>The model ARIMA(2,1,2)x(1,1,2)[12] works siginificantly better than ARIMA(0,1,0)x(2,0,0)[12] due to the lower AIC, BIC, and AICc numbers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model_output_1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Function to Extract Model Diagnostics ######</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>extract_model_diagnostics <span class="ot">&lt;-</span> <span class="cf">function</span>(model_output) {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  start_line <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Coefficients"</span>, model_output)  <span class="co"># Find where coefficients start</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  end_line <span class="ot">&lt;-</span> <span class="fu">length</span>(model_output)  <span class="co"># Capture till the last line</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(start_line) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(model_output[start_line<span class="sc">:</span>end_line], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Print coefficient section</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No coefficient details found.</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Handle cases where output format changes</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(2,1,2)x(1,1,2)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(2,1,2)x(1,1,2)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
     Estimate     SE  t.value p.value
ar1   -0.0857 0.1575  -0.5444  0.5866
ar2    0.4865 0.0843   5.7725  0.0000
ma1   -0.3514 0.1644  -2.1372  0.0335
ma2   -0.4945 0.1338  -3.6948  0.0003
sar1  -0.9712 0.0467 -20.7861  0.0000
sma1   0.1310 0.0839   1.5613  0.1196
sma2  -0.7351 0.0832  -8.8318  0.0000

sigma^2 estimated as 0.6651609 on 280 degrees of freedom 
 
AIC = 2.542454  AICc = 2.543853  BIC = 2.644461 
 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model_output_2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(0,1,0)x(2,0,0)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(0,1,0)x(2,0,0)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
sar1       0.1181 0.0579  2.0389  0.0423
sar2       0.1333 0.0592  2.2503  0.0252
constant  -0.0069 0.0691 -0.0993  0.9210

sigma^2 estimated as 0.8323154 on 296 degrees of freedom 
 
AIC = 2.68328  AICc = 2.683552  BIC = 2.732784 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Using corss validation, we can confirm that ARIMA(0,1,0)x(2,0,0)[12] is the better model since is stays at a lower RMSE for the majority of the time in the plot below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(res.fit)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">92</span>   <span class="co"># initial training size</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">52</span>, <span class="dv">4</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">52</span>, <span class="dv">4</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>) {</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># training = first (k+i-1) observations</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> y[<span class="dv">1</span><span class="sc">:</span>(k<span class="sc">+</span>i<span class="dv">-1</span>)]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test = next 4 observations</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  xtest  <span class="ot">&lt;-</span> y[(k<span class="sc">+</span>i)<span class="sc">:</span>(k<span class="sc">+</span>i<span class="sc">+</span><span class="dv">3</span>)]</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit ARIMA models</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ensure xtest length = 4</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(xtest)<span class="sc">==</span><span class="dv">4</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(fcast<span class="sc">$</span>mean)<span class="sc">==</span><span class="dv">4</span>) {</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    rmse1[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    rmse2[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="co"># final RMSE</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse1, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8445689 1.0799366 1.2584144 1.3675548</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse2, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7018249 0.9072551 1.0266301 1.0813421</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### RMSE Plot using Plotly #####</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for RMSE values by quarter</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>qr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Q1"</span>, <span class="st">"Q2"</span>, <span class="st">"Q3"</span>, <span class="st">"Q4"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>rmse11 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>rmse22 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an interactive RMSE comparison plot</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse11, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"blue"</span>), <span class="at">name =</span> <span class="st">"RMSE1: ARIMA(2,1,2)x(1,1,2)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse22, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"RMSE2: ARIMA(0,1,0)x(2,0,0)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cross-Validation RMSE for GDP Forecasting"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Quarter"</span>),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"RMSE"</span>),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Model"</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-4762a7c6444d378ce2ac" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4762a7c6444d378ce2ac">{"x":{"visdat":{"18383d50497e":["function () ","plotlyVisDat"],"183870b2784d":["function () ","data"],"183888446b8":["function () ","data"]},"cur_data":"183888446b8","attrs":{"183870b2784d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["blue"],"name":"RMSE1: ARIMA(2,1,2)x(1,1,2)[12]","inherit":true},"183888446b8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["red"],"name":"RMSE2: ARIMA(0,1,0)x(2,0,0)[12]","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cross-Validation RMSE for GDP Forecasting","xaxis":{"domain":[0,1],"automargin":true,"title":"Quarter","type":"category","categoryorder":"array","categoryarray":["Q1","Q2","Q3","Q4"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"RMSE"},"legend":{"title":"Model"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Q1","Q2","Q3","Q4"],"y":[0.84456887640759026,1.0799365635760443,1.2584143811724353,1.3675547776115951],"type":"scatter","mode":"lines","name":"RMSE1: ARIMA(2,1,2)x(1,1,2)[12]","marker":{"color":"rgba(0,0,255,1)","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Q1","Q2","Q3","Q4"],"y":[0.70182485873609535,0.90725512418198184,1.0266300836316402,1.081342118432395],"type":"scatter","mode":"lines","name":"RMSE2: ARIMA(0,1,0)x(2,0,0)[12]","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the dependent variable (TotalVehicleSales)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> ts_solar</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define external regressors (all variables except TotalVehicleSales)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>xreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ts_anomaly, ts_wti, ts_np)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,1,0)x(0,0,1)[12] with external regressors</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#fit1 &lt;- Arima(y, order = c(2,1,2), seasonal = list(order = c(1,1,2), period = 12), xreg = xreg)</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y 
Regression with ARIMA(0,1,0)(2,0,0)[12] errors 

Coefficients:
        sar1    sar2  ts_anomaly   ts_wti   ts_np
      0.7384  0.0343     -0.2005  -0.0035  0.1222
s.e.  0.0623  0.0655      0.1178   0.0024  0.2867

sigma^2 = 0.0832:  log likelihood = -55.29
AIC=122.58   AICc=122.87   BIC=144.78

Training set error measures:
                      ME      RMSE       MAE        MPE     MAPE      MASE
Training set 0.007005674 0.2855417 0.1738749 -0.5963215 5.174797 0.5206869
                   ACF1
Training set -0.3249882</code></pre>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<p>This model successfully captured the long-term upward trend in solar power generation and accurately reproduced the monthly seasonal patterns. Short-term forecasts have high reliability, while medium- and long-term forecasts exhibit reasonable confidence interval expansion, reflecting the uncertainties in the energy sector. Although the ARIMA model slightly exaggerates the long-term growth slope, the overall trend direction is highly consistent with the structural changes in the US energy market. Therefore, this forecast can serve as a reliable baseline for future solar power generation growth.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model to each external regressor</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tmp_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_anomaly"</span>])</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(FinR_fit)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ftmp <span class="ot">&lt;-</span> <span class="fu">forecast</span>(tmp_fit, <span class="at">h =</span> <span class="dv">32</span>)  <span class="co"># Forecast next 32 periods</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>wti_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_wti"</span>])</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(Imp_fit)</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>fwti <span class="ot">&lt;-</span> <span class="fu">forecast</span>(wti_fit, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>hh_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_np"</span>])</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(CPI_fit)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>fhh <span class="ot">&lt;-</span> <span class="fu">forecast</span>(hh_fit, <span class="at">h =</span> <span class="dv">32</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create future external regressor matrix using forecasted values</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fxreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Temperature =</span> ftmp<span class="sc">$</span>mean, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">WTI =</span> fwti<span class="sc">$</span>mean, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">HH =</span> fhh<span class="sc">$</span>mean)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,0,2)x(0,0,1)[12] with external regressors</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast TotalVehicleSales using future external regressors</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg =</span> fxreg, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forecast</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Solar Electricity Net Generation Forecast"</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="arimax-icln-xle-oil-prices-gas-prices" class="level2">
<h2 class="anchored" data-anchor-id="arimax-icln-xle-oil-prices-gas-prices">(2) ARIMAX: ICLN ~ XLE + oil prices + gas prices</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>etf_symbols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ICLN"</span>, <span class="st">"XLE"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>etf_data <span class="ot">&lt;-</span> <span class="fu">tq_get</span>(etf_symbols,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">from =</span> <span class="st">"2000-01-01"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="st">"2024-12-01"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">get =</span> <span class="st">"stock.prices"</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>icln_monthly <span class="ot">&lt;-</span> etf_data <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(symbol <span class="sc">==</span> <span class="st">"ICLN"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tq_transmute</span>(<span class="at">select =</span> adjusted,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">mutate_fun =</span> to.monthly,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">indexAt =</span> <span class="st">"lastof"</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_rename =</span> <span class="st">"adjusted"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>ts_icln <span class="ot">&lt;-</span> <span class="fu">ts</span>(icln_monthly<span class="sc">$</span>adjusted,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">year</span>(<span class="fu">min</span>(icln_monthly<span class="sc">$</span>date)), <span class="fu">month</span>(<span class="fu">min</span>(icln_monthly<span class="sc">$</span>date))),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>xle_monthly <span class="ot">&lt;-</span> etf_data <span class="sc">%&gt;%</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(symbol <span class="sc">==</span> <span class="st">"XLE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tq_transmute</span>(<span class="at">select =</span> adjusted,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">mutate_fun =</span> to.monthly,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">indexAt =</span> <span class="st">"lastof"</span>,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_rename =</span> <span class="st">"adjusted"</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>ts_xle <span class="ot">&lt;-</span> <span class="fu">ts</span>(xle_monthly<span class="sc">$</span>adjusted,</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">year</span>(<span class="fu">min</span>(xle_monthly<span class="sc">$</span>date)), <span class="fu">month</span>(<span class="fu">min</span>(xle_monthly<span class="sc">$</span>date))),</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">auto.arima()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Manual Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Model Diagnostics</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Final Model Fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<ul>
<li><p><strong>Fuel Prices → Substitution/Competition Channel for Clean Energy:</strong> When fossil fuel prices (especially natural gas or oil) rise, the costs for fossil power generation and related companies increase, making renewable energy (and related listed companies) more economically attractive, thereby boosting their valuations and ETF performance.</p></li>
<li><p><strong>Traditional Energy ETFs (XLE) as a Transmission of Industry Sentiment/Risk Premium:</strong> XLE represents the market performance of the traditional energy sector, reflecting industry prosperity, capital flows, and investor risk appetite. The correlation between ICLN and XLE can capture “sector rotation” or the market transmission of funds from traditional energy to clean energy. If the two move in opposite directions, it indicates a substitution relationship between fund flows and market expectations.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/WTIprice.csv"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>wti <span class="ot">&lt;-</span> wti <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> observation_date) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2008-01-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2024-12-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">WTI =</span> POILWTIUSDM) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WTI =</span> <span class="fu">as.numeric</span>(WTI))<span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>ts_wti <span class="ot">&lt;-</span> <span class="fu">ts</span>(wti<span class="sc">$</span>WTI,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">1</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/naturalgasprice.csv"</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> df_n <span class="sc">%&gt;%</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2024</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HH =</span> <span class="fu">log</span>(<span class="fu">pmax</span>(HH, .Machine<span class="sc">$</span>double.eps))) <span class="sc">%&gt;%</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>ts_np <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_n<span class="sc">$</span>HH,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(df_n<span class="sc">$</span>Year), <span class="fu">min</span>(df_n<span class="sc">$</span>Month)),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>df_icln <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">time</span>(ts_icln)),   </span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">ICLN =</span> <span class="fu">as.numeric</span>(ts_icln)</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>df_xle <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">time</span>(ts_xle)),  </span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">XLE =</span> <span class="fu">as.numeric</span>(ts_xle)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> df_icln <span class="sc">%&gt;%</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_n, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(wti, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(df_xle, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>data_all <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_all, Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2008-06-01"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>common_start <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">6</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>common_end   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2024</span>, <span class="dv">11</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>ts_icln <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_icln, <span class="at">start =</span> common_start, <span class="at">end =</span> common_end)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>ts_xle  <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_xle,  <span class="at">start =</span> common_start, <span class="at">end =</span> common_end)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>ts_wti  <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_wti,  <span class="at">start =</span> common_start, <span class="at">end =</span> common_end)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>ts_np   <span class="ot">&lt;-</span> <span class="fu">window</span>(ts_np,   <span class="at">start =</span> common_start, <span class="at">end =</span> common_end)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual plots for each variable with y-axis labels</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>ICLN, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Renewable Energy ETF (ICLN)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>XLE, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Energy Select Sector SPDR Fund (XLE)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>WTI, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"WTI Oil price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(data_all, <span class="at">x =</span> <span class="sc">~</span>Date, <span class="at">y =</span> <span class="sc">~</span>HH, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>, <span class="at">name =</span> <span class="st">"Henry Hub Natural Gas price"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the individual plots into a single figure with subplots and y-axis labels</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">subplot</span>(p2, p3, p4, p1, <span class="at">nrows =</span> <span class="dv">4</span>, <span class="at">shareX =</span> <span class="cn">TRUE</span>, <span class="at">titleX =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Time Series of ICLN, XLE, WTI and HH price"</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>), </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>), </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis3 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis4 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Price"</span>),</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>final_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a74279c830944b09b8c2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a74279c830944b09b8c2">{"x":{"data":[{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01"],"y":[51.264862060546875,43.106983184814453,43.251815795898438,36.793960571289062,29.876913070678711,29.225910186767578,27.910982131958008,27.414348602294922,24.031383514404297,24.935979843139648,26.8857421875,30.350698471069336,28.363077163696289,29.880105972290039,30.204755783081055,31.969438552856445,32.758007049560547,33.688854217529297,33.985462188720703,32.489177703857422,33.466842651367188,34.409557342529297,35.839302062988281,31.735517501831055,29.855035781860352,32.354972839355469,30.768476486206055,33.843971252441406,35.763755798339844,37.858619689941406,41.386459350585938,44.357810974121094,47.626251220703125,48.522800445556641,48.966972351074219,46.916549682617188,46.014743804931641,46.686489105224609,41.917079925537109,35.871192932128906,42.737667083740234,43.448833465576172,42.56146240234375,43.521938323974609,46.101589202880859,44.345157623291016,44.029953002929688,39.326580047607422,41.218189239501953,43.255161285400391,44.422718048095703,45.806858062744141,44.877395629882812,44.328426361083984,44.780036926269531,48.498115539550781,48.711280822753906,49.949867248535156,49.29486083984375,50.699321746826172,49.550102233886719,52.157329559326172,51.619438171386719,52.7108154296875,54.9232177734375,54.95501708984375,56.533134460449219,53.256507873535156,55.983833312988281,57.164203643798828,60.168125152587891,61.175838470458984,64.548683166503906,62.311061859130859,63.671684265136719,58.736255645751953,56.662155151367188,51.736133575439453,51.627063751220703,49.272686004638672,51.535770416259766,50.940402984619141,54.289138793945312,51.472274780273438,49.679225921630859,45.8587646484375,43.908870697021484,40.750331878662109,45.298137664794922,45.291465759277344,40.528175354003906,39.110504150390625,38.015335083007812,41.879951477050781,45.676132202148438,45.249820709228516,46.480922698974609,45.895160675048828,46.664840698242188,48.385936737060547,47.022281646728516,51.003627777099609,51.886363983154297,50.219272613525391,49.17218017578125,48.441471099853516,47.013889312744141,45.350654602050781,45.300014495849609,46.486248016357422,43.939342498779297,48.413383483886719,48.010414123535156,48.851699829101562,51.425910949707031,53.269145965576172,47.4974365234375,48.315830230712891,52.902992248535156,54.487010955810547,54.797332763671875,55.648799896240234,53.714950561523438,55.028820037841797,48.795024871826172,48.032138824462891,42.057342529296875,46.772743225097656,47.850761413574219,48.869064331054688,48.861679077148438,43.436710357666016,47.517658233642578,46.764354705810547,42.871055603027344,44.557735443115234,43.624423980712891,44.324390411376953,46.995494842529297,41.829429626464844,35.434471130371094,23.255308151245117,30.40955924987793,31.017740249633789,30.677928924560547,29.202796936035156,28.894800186157227,24.674249649047852,23.660915374755859,30.28465461730957,31.641439437866211,32.826953887939453,40.198829650878906,41.393135070800781,41.671550750732422,44.050861358642578,45.915946960449219,42.097419738769531,41.253608703613281,44.938167572021484,49.579517364501953,47.094928741455078,48.499950408935547,57.605712890625,61.677951812744141,67.43780517578125,66.29974365234375,76.930625915527344,63.795909881591797,69.960494995117188,71.816108703613281,64.951408386230469,81.166725158691406,82.203842163085938,79.697502136230469,81.938896179199219,76.253387451171875,76.2574462890625,78.374946594238281,70.512588500976562,75.387374877929688,81.247856140136719,82.58526611328125,84.570037841796875,79.704864501953125,79.134140014648438,79.195213317871094,78.789047241210938,81.367790222167969,89.900321960449219,89.052833557128906,88.748115539550781,87.493064880371094,89.470413208007812,87.617851257324219,84.973457336425781,85.738014221191406,92.454612731933594],"mode":"lines","name":"Energy Select Sector SPDR Fund (XLE)","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[133.92809523809501,133.95826086956501,116.69714285714301,104.443636363636,76.283913043478293,56.968000000000004,40.644347826086999,41.6309090909091,39.078499999999998,47.979999999999997,49.905909090909098,59.257142857142803,69.672272727272698,64.208695652173901,71.064285714285703,69.397727272727295,75.823636363636396,77.972380952381002,74.625652173912997,78.418571428571397,76.308000000000007,81.242173913043501,84.497727272727303,73.842380952380907,75.349090909090904,76.177272727272694,76.618181818181796,75.273636363636399,81.902380952380994,84.148636363636399,89.366956521739098,89.523809523809504,89.414000000000001,102.935652173913,110.147619047619,101.29909090909101,96.2886363636364,97.078095238095202,86.334347826086997,85.648181818181797,86.411904761904793,97.109090909090895,98.566818181818206,100.102272727273,102.297142857143,106.187272727273,103.325714285714,94.534782608695707,82.400476190476198,87.919090909090897,94.118260869565205,94.704499999999996,89.596521739130395,86.720909090909103,88.262857142857101,94.729565217391297,95.3095,93.199047619047604,92.067727272727296,94.766956521739104,95.769499999999994,104.42652173913,106.435454545455,106.395238095238,100.556956521739,93.850952380952407,97.890454545454503,94.9630434782609,100.705,100.568095238095,102.175,101.99636363636399,105.234761904762,102.948260869565,96.317142857142898,93.271818181818205,84.406086956521705,75.707499999999996,59.139565217391301,47.557272727272696,50.856999999999999,47.782272727272698,54.378636363636403,59.388571428571403,59.828636363636399,51.198695652173903,42.912857142857099,45.509999999999998,46.268636363636404,42.585238095238097,37.3960869565217,31.784285714285701,30.377619047619,37.901739130434798,41.031904761904798,46.841818181818198,48.791818181818201,44.896190476190498,44.7517391304348,45.200000000000003,49.809523809523803,45.470909090909103,52.052727272727303,52.561818181818197,53.450000000000003,49.363043478260899,51.173999999999999,48.559565217391302,45.185454545454498,46.581904761904802,48.047826086956498,49.735714285714302,51.573181818181801,56.738181818181801,57.920476190476201,63.584782608695697,62.226999999999997,62.830454545454501,66.313809523809496,69.898695652173899,67.876190476190501,71.0745454545455,67.927391304347793,70.1905,70.753043478260906,56.188181818181803,48.919047619047603,51.227391304347798,54.996000000000002,58.170476190476201,63.870454545454599,60.740000000000002,54.665999999999997,57.376086956521704,54.830454545454501,56.859999999999999,53.960869565217401,56.677619047619103,59.867727272727301,57.7169565217391,50.607999999999997,29.320454545454499,16.975000000000001,28.781428571428599,38.314545454545502,40.7152173913043,42.370952380952403,39.5981818181818,39.405000000000001,41.389047619047602,47.0704347826087,51.849523809523802,59.234499999999997,62.183913043478299,61.417727272727298,65.160952380952395,71.377272727272697,72.591818181818198,67.872272727272701,71.534999999999997,81.3642857142857,79.095454545454601,71.802173913043504,83.277619047618998,91.608000000000004,108.399130434783,101.985238095238,109.71272727272699,114.675909090909,101.91809523809501,93.692608695652197,84.400000000000006,87.286666666666704,84.076363636363595,76.581818181818207,78.251363636363607,77.027500000000003,73.348260869565195,79.126499999999993,71.673478260869601,70.306818181818201,75.766666666666694,81.372608695652204,89.240952380952393,85.469090909090895,77.575454545454505,72.019523809523804,74.003043478260906,77.363809523809493,81.405714285714296,85.347272727272696,79.957391304347894,79.912499999999994,81.947826086956496,76.683181818181794,70.439999999999998,72.164347826086995,69.941428571428602,70.152272727272702],"mode":"lines","name":"WTI Oil price","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01","2024-12-01"],"y":[2.9396908826703663,3.0335096378880211,3.0041963519661206,2.9128939952449864,2.7376090033437546,2.6246685921631592,2.5525652982618152,2.5249283241374862,2.5063419305080652,2.4832385926873033,2.4578779774000812,2.5541217188094731,2.65745841498615,2.7258901192305411,2.7479117345273405,2.6946271807700692,2.4664031782234406,2.4406063908914204,2.3437270363252209,2.3570732782781154,2.3693087250369538,2.3969857684155298,2.4824035195698819,2.5741377835159431,2.6986730392896132,2.7856283357475848,2.8124102164264526,2.7491921444333851,2.5930133911138515,2.3878449369448691,2.3005830903233728,2.2925347571405443,2.3164879981630371,2.3446862690126808,2.4221443280516848,2.5257286443082556,2.6878474937846906,2.7813006628418027,2.8136106967627028,2.7491921444333851,2.5533438113412288,2.3776925654808512,2.2854389341590751,2.2638442646776151,2.2481289071979869,2.3427668826268775,2.3924257969938352,2.5344901499768282,2.6518325211039815,2.7166795278002644,2.7612749623395079,2.6892071133007303,2.4578779774000812,2.3015845926604621,2.2823823856765264,2.2137538792874301,2.2224590485147608,2.2353763433005955,2.3446862690126808,2.5344901499768282,2.7093826463359885,2.7911651078127169,2.7991089320491769,2.753023566744941,2.5160822672564502,2.3065771142635829,2.2126603854660587,2.2257040486580881,2.2793164660546914,2.3702437414678603,2.4647039424704809,2.6100697927420065,2.7806808921371173,2.8466520505398383,2.8570447537800976,2.7893229212309465,2.5733752977756086,2.3214068472346332,2.3035845933271291,2.2512917986064953,2.2060741926132019,2.2278615467981093,2.3446862690126808,2.5439614125693151,2.7127060126384039,2.7899373605743945,2.826129489167811,2.7972813348301528,2.5336968139574321,2.3045830956567186,2.2267833795777636,2.1138429683971682,2.1234584270966104,2.2181159363675955,2.2669579153508947,2.4527277514237653,2.6693093727857793,2.8069901489571136,2.8678989020441064,2.8201877010390604,2.6203112867942031,2.3767644911682972,2.2038691200548879,2.2321626286975,2.3035845933271291,2.2884861686145439,2.4283362982996062,2.5839975524322312,2.7763317085186157,2.8825635754483532,2.9025198918318122,2.8284963541780774,2.5945081597030812,2.3164879981630371,2.2289385528257473,2.1860512767380942,2.2648832258100344,2.2782924004250011,2.3075726345050849,2.6041700706148179,2.8015405441895487,2.8820035082256483,2.9210087273580543,2.8466520505398383,2.5030739537434492,2.2428350885882717,2.2638442646776151,2.2364452904895007,2.2407096892759584,2.2428350885882717,2.3841650799864684,2.5463152779166438,2.7472709142554912,2.8758219768814333,2.9107188992270343,2.8684669225081145,2.5257286443082556,2.2332350148592526,2.2300144001592104,2.2438960966453663,2.2181159363675955,2.2823823856765264,2.3437270363252209,2.4672517145492794,2.7298116928837226,2.8616292890305104,2.9052603703899154,2.8243506567983707,2.5063419305080652,2.3969857684155298,2.2772672850097559,2.2638442646776151,2.2278615467981093,2.3485140248824456,2.5071572587228199,2.6440448711262978,2.8758219768814333,2.9861868607104594,3.0378334495726262,3.0022112396517002,2.8564702062204832,2.5733752977756086,2.5710843460290524,2.4882344398806748,2.4973291697865574,2.5603232890727545,2.6369121732688705,2.8724340572094973,3.1095072878128356,3.201526186533088,3.2343553957165869,3.1994891110680106,2.9242362718489212,2.7447035187502458,2.6851226964585053,2.73696154459663,2.7199787719674839,2.631888840136646,2.67827804276854,2.8267217308197088,3.0120976276402551,3.1009927842114839,3.1544439647088121,3.0937660138253564,2.8249439525737094,2.6019486702196644,2.5687881337687024,2.4689466302092709,2.5779415157551897,2.6217658325051976,2.67000213346468,2.8808824318750488,3.0411835364579085,3.1354942159291497,3.1557230098629323,3.1228053561174671,2.924773184613497,2.7020321287766471,2.563409711275944],"mode":"lines","name":"Henry Hub Natural Gas price","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y3","frame":null},{"x":["2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01","2020-10-01","2020-11-01","2020-12-01","2021-01-01","2021-02-01","2021-03-01","2021-04-01","2021-05-01","2021-06-01","2021-07-01","2021-08-01","2021-09-01","2021-10-01","2021-11-01","2021-12-01","2022-01-01","2022-02-01","2022-03-01","2022-04-01","2022-05-01","2022-06-01","2022-07-01","2022-08-01","2022-09-01","2022-10-01","2022-11-01","2022-12-01","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01","2024-01-01","2024-02-01","2024-03-01","2024-04-01","2024-05-01","2024-06-01","2024-07-01","2024-08-01","2024-09-01","2024-10-01","2024-11-01"],"y":[35.355648040771484,34.433933258056641,35.278232574462891,25.667139053344727,15.472048759460449,13.487910270690918,15.049893379211426,14.261865615844727,10.715750694274902,12.312910079956055,14.810667037963867,16.654092788696289,16.126106262207031,16.515113830566406,14.959090232849121,16.444385528564453,14.449843406677246,15.270294189453125,15.867928504943848,13.715131759643555,12.745668411254883,13.430000305175781,13.11634635925293,10.842368125915527,10.507546424865723,11.695041656494141,11.176860809326172,12.429131507873535,12.206024169921875,10.701862335205078,11.506361961364746,11.978530883789062,12.479754447937012,13.692858695983887,13.344182968139648,12.363529205322266,11.899582862854004,10.77573299407959,9.7106447219848633,6.8092074394226074,7.198512077331543,6.8532757759094238,6.4460997581481934,7.0046615600585938,7.2084593772888184,6.8687944412231445,6.4385504722595215,5.3214287757873535,5.5643515586853027,4.8630275726318359,5.1790075302124023,5.2791972160339355,5.0171647071838379,5.1250615119934082,5.6224789619445801,5.7401046752929688,5.716580867767334,5.7714724540710449,6.6654233932495117,7.0575075149536133,6.9339823722839355,7.3941307067871094,7.0688514709472656,8.1240234375,8.401698112487793,8.3937664031982422,8.3837928771972656,8.3115205764770508,8.9700193405151367,8.9941091537475586,8.5925865173339844,8.9459266662597656,9.6037425994873047,9.0612058639526367,9.5389642715454102,8.8020839691162109,8.4619808197021484,8.2838363647460938,7.9815182685852051,8.2288780212402344,9.0121908187866211,9.7790098190307617,10.298468589782715,10.018124580383301,9.2910614013671875,8.7730350494384766,7.8873767852783203,7.5698771476745605,8.188166618347168,7.87066650390625,8.2852554321289062,7.3253769874572754,7.0811986923217773,7.8642568588256836,7.7463760375976562,7.3422179222106934,7.5314736366271973,7.8059701919555664,7.8831725120544434,7.8574399948120117,7.6000986099243164,6.8967046737670898,6.8855166435241699,7.2088217735290527,7.5233893394470215,7.4797000885009766,7.4097938537597656,7.593292236328125,7.606473445892334,8.0241174697875977,8.1129779815673828,7.9796867370605469,8.2729291915893555,7.917485237121582,8.3635196685791016,8.5878639221191406,8.3994159698486328,8.5429964065551758,8.8391304016113281,8.7134990692138672,7.9421753883361816,8.2878818511962891,7.9330787658691406,7.823906421661377,7.3781270980834961,8.1787128448486328,7.6080212593078613,8.7409353256225586,8.9343585968017578,8.9896240234375,9.3580503463745117,9.2014684677124023,9.8740768432617188,9.9575977325439453,10.087520599365234,10.115361213684082,9.8926372528076172,10.21744441986084,10.98331356048584,11.32917308807373,11.740462303161621,8.9268646240234375,10.057912826538086,11.142223358154297,11.754646301269531,13.519720077514648,16.092220306396484,17.359697341918945,18.364282608032227,22.091596603393555,26.560819625854492,28.028060913085938,24.312934875488281,22.855096817016602,21.858125686645508,21.557155609130859,22.188037872314453,21.478700637817383,22.065084457397461,20.476171493530273,23.89990234375,22.216409683227539,20.137136459350586,17.835201263427734,19.699577331542969,20.470058441162109,17.920814514160156,18.910072326660156,18.244497299194336,21.347501754760742,21.242153167724609,18.282810211181641,18.091264724731445,20.265281677246094,19.043682098388672,19.897527694702148,18.420085906982422,18.976526260375977,17.949987411499023,17.59501838684082,17.771308898925781,17.65540885925293,15.53057861328125,14.120463371276855,12.565474510192871,13.724472045898438,15.158291816711426,13.444830894470215,13.542186737060547,13.610335350036621,12.880166053771973,14.57415771484375,13.052566528320312,13.865902900695801,14.003091812133789,14.395060539245605,12.836984634399414,12.141240119934082],"mode":"lines","name":"Renewable Energy ETF (ICLN)","type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Year","anchor":"y4"},"yaxis4":{"domain":[0,0.23000000000000001],"automargin":true,"anchor":"x","title":"Price"},"yaxis3":{"domain":[0.27000000000000002,0.47999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis2":{"domain":[0.52000000000000002,0.72999999999999998],"automargin":true,"anchor":"x","title":"Price"},"yaxis":{"domain":[0.77000000000000002,1],"automargin":true,"anchor":"x","title":"Price"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Time Series of ICLN, XLE, WTI and HH price"},"attrs":{"1838336f6302":{"x":{},"y":{},"mode":"lines","name":"Energy Select Sector SPDR Fund (XLE)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"183871c74868":{"x":{},"y":{},"mode":"lines","name":"WTI Oil price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"183869654ebc":{"x":{},"y":{},"mode":"lines","name":"Henry Hub Natural Gas price","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1838333f76fe":{"x":{},"y":{},"mode":"lines","name":"Renewable Energy ETF (ICLN)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fit_auto <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  ts_icln,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">xreg =</span> <span class="fu">cbind</span>(ts_xle, ts_wti, ts_np)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_icln 
Regression with ARIMA(0,1,1)(2,0,0)[12] errors 

Coefficients:
         ma1     sar1     sar2  ts_xle  ts_wti   ts_np
      0.3556  -0.0975  -0.0040  0.1480  0.0094  1.4393
s.e.  0.0688   0.0940   0.0955  0.0256  0.0180  0.8832

sigma^2 = 1.837:  log likelihood = -336.51
AIC=687.02   AICc=687.62   BIC=710.01

Training set error measures:
                     ME     RMSE       MAE        MPE     MAPE     MASE
Training set -0.1154497 1.331195 0.8690732 -0.8413407 6.832749 0.281648
                    ACF1
Training set 0.002878453</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit_auto)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,1,1)(2,0,0)[12] errors
Q* = 24.12, df = 21, p-value = 0.2873

Model df: 3.   Total lags used: 24</code></pre>
</div>
</div>
<p>The auto.arima() fits a Regression with ARIMA(0,1,1)(2,0,0)[12] errors. It shows well-behaved residuals. - The residual time series fluctuates randomly around zero with no noticeable pattern. - The ACF plot does not exhibit significant autocorrelation, and most spikes remain within the 95% confidence bounds, indicating that the model successfully captures the serial dependence in the data. - The Ljung–Box test (p = 0.2873) confirms that we cannot reject the null hypothesis of no autocorrelation, meaning the residuals are consistent with white noise. - Therefore, this ARIMA model adequately accounts for the strong temporal dependence in the series</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(ICLN <span class="sc">~</span> XLE <span class="sc">+</span> WTI <span class="sc">+</span> HH, <span class="at">data =</span> data_all)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ICLN ~ XLE + WTI + HH, data = data_all)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.3476 -3.9395 -0.8801  2.4945 18.6202 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -9.38426    3.69562  -2.539   0.0119 *  
XLE         -0.02889    0.02691  -1.073   0.2844    
WTI          0.03615    0.01855   1.948   0.0528 .  
HH           7.89197    1.52241   5.184 5.43e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.357 on 194 degrees of freedom
  (1 observation deleted due to missingness)
Multiple R-squared:  0.1566,    Adjusted R-squared:  0.1436 
F-statistic: 12.01 on 3 and 194 DF,  p-value: 3.026e-07</code></pre>
</div>
</div>
<p>Only HH (natural gas price) has a stable and significant effect on ICLN.</p>
<p>XLE has no significant effect at all; WTI has only a weak correlation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(lm_fit))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Moreover, the residuals exhibit a high correlation, indicating significant serial correlation that remains unexplained. This suggests that traditional machine learning models may struggle to fully capture the underlying temporal patterns in these time series variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>res.fit <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">residuals</span>(lm_fit), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(res.fit)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(res.fit)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>first_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(res.fit)  </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>seasonal_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(first_diff, <span class="at">lag =</span> <span class="dv">12</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="do">###### Plot ACF and PACF for the Differenced Series ######</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(seasonal_diff) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"PACF of Seasonally Differenced Residuals"</span>) <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Define SARIMA Model Comparison Function ######</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>SARIMA.c <span class="ot">&lt;-</span> <span class="cf">function</span>(p_range, d_range, q_range, P_range, D_range, Q_range, data) {</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set seasonal period</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize results storage</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  results_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over parameter combinations</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p_range) {</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> d_range) {</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (q <span class="cf">in</span> q_range) {</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (P <span class="cf">in</span> P_range) {</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (D <span class="cf">in</span> D_range) {</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (Q <span class="cf">in</span> Q_range) {</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> (p <span class="sc">+</span> d <span class="sc">+</span> q <span class="sc">+</span> P <span class="sc">+</span> D <span class="sc">+</span> Q <span class="sc">&lt;=</span> <span class="dv">10</span>) {</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>                result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>                  model <span class="ot">&lt;-</span> <span class="fu">Arima</span>(</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>                    data,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">order =</span> <span class="fu">c</span>(p, d, q),</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(P, D, Q), <span class="at">period =</span> s)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q,</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">AIC</span>(model),</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">BIC</span>(model),</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>                    model<span class="sc">$</span>aicc)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>                }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(p, d, q, P, D, Q, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>                results_list[[<span class="fu">length</span>(results_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> result</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert results to a tidy data frame</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind, results_list))</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(results_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"d"</span>, <span class="st">"q"</span>, <span class="st">"P"</span>, <span class="st">"D"</span>, <span class="st">"Q"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"AICc"</span>)</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_df)</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a><span class="do">###### Run SARIMA Model Comparison ######</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">SARIMA.c</span>(</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_range =</span> <span class="dv">1</span>, <span class="at">D_range =</span> <span class="dv">1</span>, </span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">Q_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> res.fit</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a><span class="do">###### Identify Models with Minimum AIC and BIC ######</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>minaic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC), ]</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>minbic <span class="ot">&lt;-</span> output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC), ]</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a><span class="do">###### Display Best Models Based on AIC and BIC ######</span></span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(minaic)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    p d q P D Q      AIC      BIC    AICc
101 3 1 2 0 1 1 698.2812 720.8237 698.914</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>The model ARIMA(3,1,2)x(0,1,1)[12] works siginificantly better than ARIMA(0,1,1)x(2,0,0)[12] due to the lower AIC, BIC, and AICc numbers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>model_output_1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Function to Extract Model Diagnostics ######</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>extract_model_diagnostics <span class="ot">&lt;-</span> <span class="cf">function</span>(model_output) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  start_line <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Coefficients"</span>, model_output)  <span class="co"># Find where coefficients start</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  end_line <span class="ot">&lt;-</span> <span class="fu">length</span>(model_output)  <span class="co"># Capture till the last line</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(start_line) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(model_output[start_line<span class="sc">:</span>end_line], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Print coefficient section</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No coefficient details found.</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Handle cases where output format changes</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(3,1,2)x(0,1,1)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(3,1,2)x(0,1,1)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
     Estimate     SE  t.value p.value
ar1    0.9859 0.0710  13.8854       0
ar2   -1.1419 0.0560 -20.3829       0
ar3    0.3433 0.0736   4.6614       0
ma1   -0.8266 0.0208 -39.6853       0
ma2    1.0000 0.0319  31.3116       0
sma1  -0.7952 0.0752 -10.5770       0

sigma^2 estimated as 2.124997 on 179 degrees of freedom 
 
AIC = 3.774493  AICc = 3.777044  BIC = 3.896345 
 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model_output_2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Extract and Print Model Diagnostics ######</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"### ARIMA(0,1,1)x(2,0,0)[12] ###</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### ARIMA(0,1,1)x(2,0,0)[12] ###</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_model_diagnostics</span>(model_output_2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients: 
         Estimate     SE t.value p.value
ma1        0.2613 0.0752  3.4767  0.0006
sar1       0.2153 0.0838  2.5676  0.0110
sar2       0.2064 0.0865  2.3857  0.0180
constant  -0.1597 0.2338 -0.6830  0.4954

sigma^2 estimated as 2.54072 on 193 degrees of freedom 
 
AIC = 3.831405  AICc = 3.832463  BIC = 3.914735 
 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>Using corss validation, we can find that ARIMA(3,1,2)x(0,1,1)[12] is the better model since is stays at a lower RMSE for the majority of the time in the plot below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(res.fit)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">90</span>   <span class="co"># initial training size</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">27</span>, <span class="dv">4</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">27</span>, <span class="dv">4</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>) {</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># training = first (k+i-1) observations</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> y[<span class="dv">1</span><span class="sc">:</span>(k<span class="sc">+</span>i<span class="dv">-1</span>)]</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test = next 4 observations</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  xtest  <span class="ot">&lt;-</span> y[(k<span class="sc">+</span>i)<span class="sc">:</span>(k<span class="sc">+</span>i<span class="sc">+</span><span class="dv">3</span>)]</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit ARIMA models</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(<span class="fu">ts</span>(xtrain, <span class="at">frequency=</span><span class="dv">12</span>),</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">period=</span><span class="dv">12</span>))</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ensure xtest length = 4</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(xtest)<span class="sc">==</span><span class="dv">4</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(fcast<span class="sc">$</span>mean)<span class="sc">==</span><span class="dv">4</span>) {</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>    rmse1[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>    rmse2[i,] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="co"># final RMSE</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse1, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4349772 0.6892801 0.7957101 0.9767452</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rmse2, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6071017 1.2748298 1.8310810 2.4632175</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### RMSE Plot using Plotly #####</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for RMSE values by quarter</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>qr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Q1"</span>, <span class="st">"Q2"</span>, <span class="st">"Q3"</span>, <span class="st">"Q4"</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>rmse11 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>rmse22 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Quarter =</span> qr, <span class="at">RMSE =</span> <span class="fu">colMeans</span>(rmse2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an interactive RMSE comparison plot</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse11, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"blue"</span>), <span class="at">name =</span> <span class="st">"RMSE1: ARIMA(3,1,2)x(0,1,1)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">data =</span> rmse22, <span class="at">x =</span> <span class="sc">~</span>Quarter, <span class="at">y =</span> <span class="sc">~</span>RMSE, </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">I</span>(<span class="st">"red"</span>), <span class="at">name =</span> <span class="st">"RMSE2: ARIMA(0,1,1)x(2,0,0)[12]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cross-Validation RMSE for GDP Forecasting"</span>,</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Quarter"</span>),</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"RMSE"</span>),</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Model"</span>)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f5521c4197deeba8a907" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f5521c4197deeba8a907">{"x":{"visdat":{"1838f434f2b":["function () ","plotlyVisDat"],"18387d3a49a6":["function () ","data"],"183840c365b9":["function () ","data"]},"cur_data":"183840c365b9","attrs":{"18387d3a49a6":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["blue"],"name":"RMSE1: ARIMA(3,1,2)x(0,1,1)[12]","inherit":true},"183840c365b9":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","color":["red"],"name":"RMSE2: ARIMA(0,1,1)x(2,0,0)[12]","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cross-Validation RMSE for GDP Forecasting","xaxis":{"domain":[0,1],"automargin":true,"title":"Quarter","type":"category","categoryorder":"array","categoryarray":["Q1","Q2","Q3","Q4"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"RMSE"},"legend":{"title":"Model"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Q1","Q2","Q3","Q4"],"y":[0.43497724841326324,0.68928009036099169,0.79571008871094229,0.97674515381218185],"type":"scatter","mode":"lines","name":"RMSE1: ARIMA(3,1,2)x(0,1,1)[12]","marker":{"color":"rgba(0,0,255,1)","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Q1","Q2","Q3","Q4"],"y":[0.60710165808911165,1.274829782448232,1.8310809987168415,2.4632175174967905],"type":"scatter","mode":"lines","name":"RMSE2: ARIMA(0,1,1)x(2,0,0)[12]","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the dependent variable (TotalVehicleSales)</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> ts_icln</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define external regressors (all variables except TotalVehicleSales)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>xreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ts_xle, ts_wti, ts_np)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,1,0)x(0,0,1)[12] with external regressors</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">#fit1 &lt;- Arima(y, order = c(2,1,2), seasonal = list(order = c(2,0,1), period = 12), xreg = xreg)</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y 
Regression with ARIMA(3,1,2)(0,1,1)[12] errors 

Coefficients:
         ar1      ar2     ar3      ma1     ma2     sma1  ts_xle  ts_wti   ts_np
      1.0823  -1.2256  0.4413  -0.8235  0.9999  -0.7606  0.1213  0.0155  3.8612
s.e.  0.0701   0.0558  0.0748   0.0382  0.0754   0.0864  0.0226  0.0116  1.7681

sigma^2 = 1.781:  log likelihood = -320.74
AIC=661.49   AICc=662.75   BIC=693.69

Training set error measures:
                    ME     RMSE       MAE      MPE    MAPE      MASE
Training set 0.1085898 1.258092 0.8648518 1.402603 7.68769 0.2802799
                    ACF1
Training set 0.001177419</code></pre>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<p>The ARIMAX model suggests a mild downward trend in future ICLN values, driven largely by the projected behavior of the external energy market indicators (XLE, WTI, and HH).</p>
<p>Although the short-term forecast remains relatively tight, the confidence bands expand substantially over longer horizons, reflecting the inherently high volatility of renewable-energy equities and the uncertainty in future energy-market conditions.</p>
<p>Overall, the model produces a smooth and stable forecast trajectory without unrealistic jumps, indicating a reasonable and well-behaved dynamic specification.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model to each external regressor</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>xle_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_xle"</span>])</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(FinR_fit)</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>fxle <span class="ot">&lt;-</span> <span class="fu">forecast</span>(xle_fit, <span class="at">h =</span> <span class="dv">32</span>)  <span class="co"># Forecast next 32 periods</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>wti_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_wti"</span>])</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(Imp_fit)</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>fwti <span class="ot">&lt;-</span> <span class="fu">forecast</span>(wti_fit, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>hh_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(xreg[, <span class="st">"ts_np"</span>])</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(CPI_fit)</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>fhh <span class="ot">&lt;-</span> <span class="fu">forecast</span>(hh_fit, <span class="at">h =</span> <span class="dv">32</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create future external regressor matrix using forecasted values</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>fxreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">XLE =</span> fxle<span class="sc">$</span>mean, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">WTI =</span> fwti<span class="sc">$</span>mean, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">HH =</span> fhh<span class="sc">$</span>mean)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA(2,0,2)x(0,0,1)[12] with external regressors</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(y, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>), <span class="at">xreg =</span> xreg)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast TotalVehicleSales using future external regressors</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg =</span> fxreg, <span class="at">h =</span> <span class="dv">32</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forecast</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"ICLN Prices Forecast"</span>) <span class="sc">+</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="var-the-dynamic-relationship-between-clean-and-traditional-energy" class="level2">
<h2 class="anchored" data-anchor-id="var-the-dynamic-relationship-between-clean-and-traditional-energy">(3) VAR: The dynamic relationship between clean and traditional energy</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/electric.csv"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">str_extract</span>(Description, <span class="st">"(?&lt;=From ).*?(?=,)"</span>),</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">YYYYMM =</span> <span class="fu">as.character</span>(YYYYMM),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">as.integer</span>(<span class="fu">substr</span>(YYYYMM, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;=</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Year, Month, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>wind_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Wind"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>ts_wind <span class="ot">&lt;-</span> <span class="fu">ts</span>(wind_df<span class="sc">$</span>Value,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(wind_df<span class="sc">$</span>Year), <span class="fu">min</span>(wind_df<span class="sc">$</span>Month)),</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>solar_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Solar"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>ts_solar <span class="ot">&lt;-</span> <span class="fu">ts</span>(solar_df<span class="sc">$</span>Value,</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(solar_df<span class="sc">$</span>Year), <span class="fu">min</span>(solar_df<span class="sc">$</span>Month)),</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>coal_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Coal"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>ts_coal <span class="ot">&lt;-</span> <span class="fu">ts</span>(coal_df<span class="sc">$</span>Value,</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(coal_df<span class="sc">$</span>Year), <span class="fu">min</span>(coal_df<span class="sc">$</span>Month)),</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)     </span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>n_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Description <span class="sc">==</span> <span class="st">"Natural Gas"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>ts_n <span class="ot">&lt;-</span> <span class="fu">ts</span>(n_df<span class="sc">$</span>Value,</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="fu">min</span>(n_df<span class="sc">$</span>Year), <span class="fu">min</span>(n_df<span class="sc">$</span>Month)),</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">frequency =</span> <span class="dv">12</span>)        </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">VARselect</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Initial selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>From a time series perspective:</p>
<ul>
<li>The rise of clean energy is accompanied by the decline of traditional energy;</li>
<li>There are potential substitution and synergistic relationships among different energy sources;</li>
<li>Their mutual influences can be further analyzed using a VAR model.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ts_wind, ts_solar, ts_coal, ts_n)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_ts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"wind"</span>, <span class="st">"solar"</span>, <span class="st">"coal"</span>, <span class="st">"natural_gas"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(df_ts)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>p-values are 8 and 10.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(df_ts, <span class="at">type=</span><span class="st">"both"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
    10     10      8     10 

$criteria
                  1            2            3            4            5
AIC(n) 6.635608e+01 6.503473e+01 6.475708e+01 6.445831e+01 6.372948e+01
HQ(n)  6.647588e+01 6.523440e+01 6.503662e+01 6.481771e+01 6.416875e+01
SC(n)  6.665530e+01 6.553343e+01 6.545526e+01 6.535597e+01 6.482662e+01
FPE(n) 6.577950e+28 1.754975e+28 1.329736e+28 9.866202e+27 4.762551e+27
                  6            7            8            9           10
AIC(n) 6.340032e+01 6.312212e+01 6.284699e+01 6.270320e+01 6.251556e+01
HQ(n)  6.391946e+01 6.372113e+01 6.352586e+01 6.346194e+01 6.335416e+01
SC(n)  6.469694e+01 6.461822e+01 6.454256e+01 6.459825e+01 6.461008e+01
FPE(n) 3.429250e+27 2.598985e+27 1.976379e+27 1.714463e+27 1.423999e+27</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>The two VAR models (p=8 and p=10) showed almost identical fitting results. The log-likelihood of p=10 was slightly higher, but the improvement was limited, while the degrees of freedom were lower. The major significant lags were consistent in both models, indicating that lag order 8 was sufficient to capture the dynamic relationships between variables.</p>
<p>There is a certain degree of complementarity between renewable energy sources (wind–solar), while the relationship with fossil fuels (coal, gas) is more of a substitution relationship. The trend term indicates a long-term upward trend for renewable energy and gas-fired power, while the trend for coal-fired power may be a remnant of structural changes.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">8</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: wind, solar, coal, natural_gas 
Deterministic variables: both 
Sample size: 298 
Log Likelihood: -10915.965 
Roots of the characteristic polynomial:
1.025 1.013 1.013 0.9833 0.9833 0.9674 0.9649 0.9649 0.9062 0.9062 0.9001 0.9001 0.8996 0.8996 0.8751 0.8751 0.8366 0.8366 0.7962 0.7962 0.7935 0.7935 0.7819 0.7819 0.7391 0.7391 0.7308 0.7308 0.508 0.508 0.3611 0.3611
Call:
vars::VAR(y = df_ts, p = 8, type = "both")


Estimation results for equation wind: 
===================================== 
wind = wind.l1 + solar.l1 + coal.l1 + natural_gas.l1 + wind.l2 + solar.l2 + coal.l2 + natural_gas.l2 + wind.l3 + solar.l3 + coal.l3 + natural_gas.l3 + wind.l4 + solar.l4 + coal.l4 + natural_gas.l4 + wind.l5 + solar.l5 + coal.l5 + natural_gas.l5 + wind.l6 + solar.l6 + coal.l6 + natural_gas.l6 + wind.l7 + solar.l7 + coal.l7 + natural_gas.l7 + wind.l8 + solar.l8 + coal.l8 + natural_gas.l8 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
wind.l1         3.817e-01  6.532e-02   5.844  1.5e-08 ***
solar.l1        8.492e-02  2.777e-01   0.306  0.76000    
coal.l1        -7.911e-03  1.488e-02  -0.532  0.59550    
natural_gas.l1 -5.541e-02  1.730e-02  -3.204  0.00152 ** 
wind.l2         1.269e-01  7.289e-02   1.741  0.08291 .  
solar.l2       -2.964e-01  3.321e-01  -0.892  0.37299    
coal.l2        -2.452e-03  1.848e-02  -0.133  0.89457    
natural_gas.l2  8.470e-03  2.109e-02   0.402  0.68832    
wind.l3        -5.333e-02  7.220e-02  -0.739  0.46074    
solar.l3       -2.358e-01  3.504e-01  -0.673  0.50151    
coal.l3         9.975e-03  1.813e-02   0.550  0.58259    
natural_gas.l3  5.426e-02  2.093e-02   2.592  0.01006 *  
wind.l4         1.260e-01  7.142e-02   1.764  0.07891 .  
solar.l4       -7.508e-01  3.456e-01  -2.172  0.03072 *  
coal.l4        -2.849e-02  1.751e-02  -1.627  0.10492    
natural_gas.l4 -1.906e-02  2.087e-02  -0.913  0.36193    
wind.l5         8.101e-02  7.267e-02   1.115  0.26592    
solar.l5        1.159e+00  3.630e-01   3.193  0.00158 ** 
coal.l5        -1.967e-04  1.762e-02  -0.011  0.99110    
natural_gas.l5  2.292e-02  2.097e-02   1.093  0.27536    
wind.l6        -3.436e-02  7.204e-02  -0.477  0.63375    
solar.l6        3.396e-01  3.847e-01   0.883  0.37818    
coal.l6         7.190e-03  1.801e-02   0.399  0.69004    
natural_gas.l6 -1.858e-02  2.088e-02  -0.890  0.37447    
wind.l7         1.188e-01  7.151e-02   1.661  0.09783 .  
solar.l7       -2.243e-01  3.735e-01  -0.601  0.54864    
coal.l7        -4.401e-03  1.788e-02  -0.246  0.80577    
natural_gas.l7 -3.028e-03  2.146e-02  -0.141  0.88791    
wind.l8         4.189e-02  6.845e-02   0.612  0.54106    
solar.l8        2.887e-02  3.063e-01   0.094  0.92498    
coal.l8         1.247e-02  1.531e-02   0.814  0.41618    
natural_gas.l8  3.464e-02  1.682e-02   2.059  0.04043 *  
const           5.520e+02  3.186e+03   0.173  0.86258    
trend           1.330e+01  9.976e+00   1.333  0.18370    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1808 on 264 degrees of freedom
Multiple R-Squared: 0.9831, Adjusted R-squared: 0.981 
F-statistic:   465 on 33 and 264 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation solar: 
====================================== 
solar = wind.l1 + solar.l1 + coal.l1 + natural_gas.l1 + wind.l2 + solar.l2 + coal.l2 + natural_gas.l2 + wind.l3 + solar.l3 + coal.l3 + natural_gas.l3 + wind.l4 + solar.l4 + coal.l4 + natural_gas.l4 + wind.l5 + solar.l5 + coal.l5 + natural_gas.l5 + wind.l6 + solar.l6 + coal.l6 + natural_gas.l6 + wind.l7 + solar.l7 + coal.l7 + natural_gas.l7 + wind.l8 + solar.l8 + coal.l8 + natural_gas.l8 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
wind.l1        -4.424e-02  1.408e-02  -3.143 0.001865 ** 
solar.l1        6.650e-01  5.985e-02  11.110  &lt; 2e-16 ***
coal.l1         7.756e-04  3.208e-03   0.242 0.809115    
natural_gas.l1 -2.674e-04  3.728e-03  -0.072 0.942857    
wind.l2        -6.495e-03  1.571e-02  -0.413 0.679610    
solar.l2        4.049e-01  7.158e-02   5.656 4.03e-08 ***
coal.l2        -2.849e-03  3.983e-03  -0.715 0.475031    
natural_gas.l2  1.454e-03  4.546e-03   0.320 0.749265    
wind.l3         1.708e-02  1.556e-02   1.098 0.273308    
solar.l3        1.062e-01  7.551e-02   1.407 0.160708    
coal.l3         1.726e-03  3.907e-03   0.442 0.658914    
natural_gas.l3  5.200e-04  4.511e-03   0.115 0.908322    
wind.l4         5.338e-02  1.539e-02   3.468 0.000613 ***
solar.l4       -4.428e-01  7.449e-02  -5.944 8.77e-09 ***
coal.l4         2.490e-03  3.775e-03   0.660 0.510000    
natural_gas.l4 -1.046e-02  4.498e-03  -2.326 0.020780 *  
wind.l5         3.670e-02  1.566e-02   2.344 0.019838 *  
solar.l5       -4.554e-02  7.823e-02  -0.582 0.560931    
coal.l5         6.679e-04  3.798e-03   0.176 0.860546    
natural_gas.l5  6.769e-03  4.519e-03   1.498 0.135347    
wind.l6         1.090e-02  1.553e-02   0.702 0.483132    
solar.l6       -1.211e-01  8.291e-02  -1.460 0.145359    
coal.l6        -1.533e-04  3.881e-03  -0.039 0.968523    
natural_gas.l6 -3.809e-03  4.500e-03  -0.846 0.398135    
wind.l7        -5.198e-02  1.541e-02  -3.373 0.000855 ***
solar.l7        1.897e-01  8.049e-02   2.357 0.019154 *  
coal.l7        -5.489e-03  3.854e-03  -1.424 0.155557    
natural_gas.l7  1.564e-02  4.626e-03   3.380 0.000834 ***
wind.l8        -5.771e-02  1.475e-02  -3.912 0.000116 ***
solar.l8        3.192e-01  6.601e-02   4.836 2.26e-06 ***
coal.l8        -1.530e-03  3.299e-03  -0.464 0.643178    
natural_gas.l8 -1.090e-02  3.626e-03  -3.005 0.002908 ** 
const           6.623e+02  6.867e+02   0.965 0.335638    
trend           3.185e+00  2.150e+00   1.481 0.139707    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 389.7 on 264 degrees of freedom
Multiple R-Squared: 0.9963, Adjusted R-squared: 0.9958 
F-statistic:  2148 on 33 and 264 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation coal: 
===================================== 
coal = wind.l1 + solar.l1 + coal.l1 + natural_gas.l1 + wind.l2 + solar.l2 + coal.l2 + natural_gas.l2 + wind.l3 + solar.l3 + coal.l3 + natural_gas.l3 + wind.l4 + solar.l4 + coal.l4 + natural_gas.l4 + wind.l5 + solar.l5 + coal.l5 + natural_gas.l5 + wind.l6 + solar.l6 + coal.l6 + natural_gas.l6 + wind.l7 + solar.l7 + coal.l7 + natural_gas.l7 + wind.l8 + solar.l8 + coal.l8 + natural_gas.l8 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
wind.l1        -4.913e-01  3.039e-01  -1.617 0.107170    
solar.l1        1.458e+00  1.292e+00   1.128 0.260250    
coal.l1         5.797e-01  6.925e-02   8.370 3.39e-15 ***
natural_gas.l1  9.157e-02  8.048e-02   1.138 0.256229    
wind.l2        -2.036e-02  3.392e-01  -0.060 0.952178    
solar.l2        2.205e-01  1.546e+00   0.143 0.886662    
coal.l2         7.125e-02  8.600e-02   0.828 0.408165    
natural_gas.l2 -2.469e-01  9.815e-02  -2.515 0.012489 *  
wind.l3         4.889e-01  3.360e-01   1.455 0.146768    
solar.l3       -5.972e-01  1.630e+00  -0.366 0.714433    
coal.l3        -9.940e-02  8.435e-02  -1.178 0.239688    
natural_gas.l3 -1.047e-01  9.739e-02  -1.075 0.283208    
wind.l4        -3.105e-01  3.323e-01  -0.934 0.350970    
solar.l4       -2.604e+00  1.608e+00  -1.619 0.106591    
coal.l4        -8.784e-02  8.149e-02  -1.078 0.282100    
natural_gas.l4  9.187e-02  9.712e-02   0.946 0.345086    
wind.l5         9.110e-02  3.381e-01   0.269 0.787830    
solar.l5        1.724e+00  1.689e+00   1.021 0.308334    
coal.l5         1.852e-01  8.201e-02   2.259 0.024710 *  
natural_gas.l5  9.240e-02  9.757e-02   0.947 0.344494    
wind.l6        -6.651e-01  3.352e-01  -1.984 0.048272 *  
solar.l6        2.490e+00  1.790e+00   1.391 0.165470    
coal.l6         9.134e-02  8.380e-02   1.090 0.276731    
natural_gas.l6 -3.676e-01  9.716e-02  -3.783 0.000191 ***
wind.l7        -2.770e-01  3.328e-01  -0.832 0.405960    
solar.l7       -7.318e-01  1.738e+00  -0.421 0.674063    
coal.l7         1.681e-01  8.320e-02   2.020 0.044425 *  
natural_gas.l7 -9.292e-02  9.987e-02  -0.930 0.353029    
wind.l8        -1.741e-01  3.185e-01  -0.547 0.585132    
solar.l8       -1.326e+00  1.425e+00  -0.930 0.353097    
coal.l8        -3.729e-01  7.123e-02  -5.236 3.36e-07 ***
natural_gas.l8 -1.052e-01  7.828e-02  -1.344 0.180069    
const           1.065e+05  1.483e+04   7.184 6.90e-12 ***
trend           1.840e+02  4.642e+01   3.963 9.52e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 8414 on 264 degrees of freedom
Multiple R-Squared: 0.9655, Adjusted R-squared: 0.9612 
F-statistic: 223.8 on 33 and 264 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation natural_gas: 
============================================ 
natural_gas = wind.l1 + solar.l1 + coal.l1 + natural_gas.l1 + wind.l2 + solar.l2 + coal.l2 + natural_gas.l2 + wind.l3 + solar.l3 + coal.l3 + natural_gas.l3 + wind.l4 + solar.l4 + coal.l4 + natural_gas.l4 + wind.l5 + solar.l5 + coal.l5 + natural_gas.l5 + wind.l6 + solar.l6 + coal.l6 + natural_gas.l6 + wind.l7 + solar.l7 + coal.l7 + natural_gas.l7 + wind.l8 + solar.l8 + coal.l8 + natural_gas.l8 + const + trend 

                 Estimate Std. Error t value Pr(&gt;|t|)    
wind.l1         3.289e-02  2.747e-01   0.120  0.90478    
solar.l1       -1.059e+00  1.168e+00  -0.907  0.36542    
coal.l1        -1.842e-01  6.259e-02  -2.942  0.00355 ** 
natural_gas.l1  8.112e-01  7.273e-02  11.153  &lt; 2e-16 ***
wind.l2        -3.452e-01  3.065e-01  -1.126  0.26108    
solar.l2        2.348e+00  1.397e+00   1.681  0.09392 .  
coal.l2        -3.866e-02  7.772e-02  -0.497  0.61930    
natural_gas.l2 -2.646e-01  8.870e-02  -2.983  0.00312 ** 
wind.l3         6.057e-01  3.036e-01   1.995  0.04707 *  
solar.l3        3.471e-01  1.473e+00   0.236  0.81397    
coal.l3        -1.298e-01  7.623e-02  -1.703  0.08982 .  
natural_gas.l3 -1.459e-01  8.802e-02  -1.658  0.09848 .  
wind.l4        -1.712e-02  3.003e-01  -0.057  0.95459    
solar.l4       -1.675e+00  1.453e+00  -1.152  0.25022    
coal.l4        -6.420e-02  7.365e-02  -0.872  0.38415    
natural_gas.l4  5.628e-02  8.777e-02   0.641  0.52196    
wind.l5        -5.046e-01  3.056e-01  -1.651  0.09988 .  
solar.l5        2.782e+00  1.526e+00   1.823  0.06944 .  
coal.l5        -9.806e-02  7.411e-02  -1.323  0.18692    
natural_gas.l5  4.493e-02  8.817e-02   0.510  0.61080    
wind.l6        -6.079e-01  3.029e-01  -2.007  0.04582 *  
solar.l6       -2.192e+00  1.618e+00  -1.355  0.17652    
coal.l6         2.501e-02  7.573e-02   0.330  0.74151    
natural_gas.l6 -2.549e-01  8.781e-02  -2.903  0.00401 ** 
wind.l7         2.773e-01  3.007e-01   0.922  0.35732    
solar.l7       -1.510e+00  1.571e+00  -0.961  0.33735    
coal.l7         2.857e-01  7.519e-02   3.800  0.00018 ***
natural_gas.l7 -1.013e-01  9.026e-02  -1.122  0.26274    
wind.l8        -3.463e-01  2.878e-01  -1.203  0.23002    
solar.l8        1.613e+00  1.288e+00   1.252  0.21166    
coal.l8        -2.013e-01  6.437e-02  -3.127  0.00196 ** 
natural_gas.l8 -1.449e-01  7.074e-02  -2.048  0.04155 *  
const           1.125e+05  1.340e+04   8.399 2.79e-15 ***
trend           2.832e+02  4.195e+01   6.751 9.30e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 7603 on 264 degrees of freedom
Multiple R-Squared: 0.963,  Adjusted R-squared: 0.9584 
F-statistic: 208.2 on 33 and 264 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                wind  solar     coal natural_gas
wind         3269310 211148 -2361536    -3011017
solar         211148 151858   211409       98698
coal        -2361536 211409 70790341    33550343
natural_gas -3011017  98698 33550343    57812585

Correlation matrix of residuals:
               wind   solar     coal natural_gas
wind         1.0000 0.29967 -0.15523    -0.21902
solar        0.2997 1.00000  0.06448     0.03331
coal        -0.1552 0.06448  1.00000     0.52444
natural_gas -0.2190 0.03331  0.52444     1.00000</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: wind, solar, coal, natural_gas 
Deterministic variables: both 
Sample size: 296 
Log Likelihood: -10764.325 
Roots of the characteristic polynomial:
1.025 1.015 1.015 0.994 0.994 0.9747 0.9747 0.9723 0.947 0.947 0.9408 0.9408 0.9232 0.9232 0.9113 0.9113 0.9017 0.9017 0.8924 0.8882 0.8882 0.8693 0.8693 0.8612 0.8612 0.8557 0.8557 0.8204 0.8204 0.7978 0.7978 0.794 0.7455 0.7455 0.7322 0.7322 0.7181 0.5306 0.5217 0.3942
Call:
vars::VAR(y = df_ts, p = 10, type = "both")


Estimation results for equation wind: 
===================================== 
wind = wind.l1 + solar.l1 + coal.l1 + natural_gas.l1 + wind.l2 + solar.l2 + coal.l2 + natural_gas.l2 + wind.l3 + solar.l3 + coal.l3 + natural_gas.l3 + wind.l4 + solar.l4 + coal.l4 + natural_gas.l4 + wind.l5 + solar.l5 + coal.l5 + natural_gas.l5 + wind.l6 + solar.l6 + coal.l6 + natural_gas.l6 + wind.l7 + solar.l7 + coal.l7 + natural_gas.l7 + wind.l8 + solar.l8 + coal.l8 + natural_gas.l8 + wind.l9 + solar.l9 + coal.l9 + natural_gas.l9 + wind.l10 + solar.l10 + coal.l10 + natural_gas.l10 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
wind.l1          3.875e-01  6.672e-02   5.808 1.89e-08 ***
solar.l1         1.877e-01  3.186e-01   0.589 0.556364    
coal.l1         -4.377e-03  1.535e-02  -0.285 0.775793    
natural_gas.l1  -5.808e-02  1.766e-02  -3.288 0.001150 ** 
wind.l2          1.379e-01  7.296e-02   1.891 0.059810 .  
solar.l2        -3.957e-01  3.509e-01  -1.128 0.260537    
coal.l2         -1.561e-02  1.852e-02  -0.843 0.400165    
natural_gas.l2  -5.350e-03  2.145e-02  -0.249 0.803288    
wind.l3         -4.500e-02  7.289e-02  -0.617 0.537515    
solar.l3        -3.016e-01  3.589e-01  -0.840 0.401633    
coal.l3          1.443e-02  1.813e-02   0.796 0.426625    
natural_gas.l3   6.883e-02  2.164e-02   3.181 0.001649 ** 
wind.l4          1.112e-01  7.274e-02   1.529 0.127627    
solar.l4        -7.629e-01  3.582e-01  -2.130 0.034123 *  
coal.l4         -4.172e-02  1.827e-02  -2.284 0.023209 *  
natural_gas.l4  -1.297e-02  2.150e-02  -0.603 0.546908    
wind.l5          7.496e-02  7.332e-02   1.022 0.307615    
solar.l5         1.262e+00  3.761e-01   3.355 0.000914 ***
coal.l5          1.574e-02  1.803e-02   0.873 0.383642    
natural_gas.l5   1.345e-03  2.135e-02   0.063 0.949827    
wind.l6         -1.087e-01  7.378e-02  -1.473 0.141881    
solar.l6         1.434e-01  3.901e-01   0.368 0.713483    
coal.l6          7.796e-03  1.776e-02   0.439 0.661038    
natural_gas.l6  -1.502e-02  2.080e-02  -0.722 0.470960    
wind.l7          1.345e-01  7.328e-02   1.835 0.067619 .  
solar.l7         8.403e-02  3.874e-01   0.217 0.828458    
coal.l7         -6.171e-03  1.772e-02  -0.348 0.727916    
natural_gas.l7  -6.212e-03  2.149e-02  -0.289 0.772780    
wind.l8          2.071e-02  7.387e-02   0.280 0.779464    
solar.l8         3.247e-01  4.054e-01   0.801 0.423894    
coal.l8          2.503e-03  1.822e-02   0.137 0.890843    
natural_gas.l8   1.094e-02  2.196e-02   0.498 0.619020    
wind.l9          7.915e-02  7.561e-02   1.047 0.296193    
solar.l9        -1.219e+00  4.298e-01  -2.836 0.004936 ** 
coal.l9          3.302e-02  1.858e-02   1.778 0.076669 .  
natural_gas.l9   2.545e-02  2.223e-02   1.145 0.253211    
wind.l10        -3.022e-02  6.981e-02  -0.433 0.665480    
solar.l10        8.001e-01  3.898e-01   2.053 0.041127 *  
coal.l10        -3.500e-02  1.577e-02  -2.220 0.027335 *  
natural_gas.l10 -1.921e-02  1.720e-02  -1.116 0.265263    
const            4.676e+03  4.020e+03   1.163 0.245875    
trend            2.264e+01  1.201e+01   1.885 0.060588 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1763 on 254 degrees of freedom
Multiple R-Squared: 0.9844, Adjusted R-squared: 0.9819 
F-statistic: 390.8 on 41 and 254 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation solar: 
====================================== 
solar = wind.l1 + solar.l1 + coal.l1 + natural_gas.l1 + wind.l2 + solar.l2 + coal.l2 + natural_gas.l2 + wind.l3 + solar.l3 + coal.l3 + natural_gas.l3 + wind.l4 + solar.l4 + coal.l4 + natural_gas.l4 + wind.l5 + solar.l5 + coal.l5 + natural_gas.l5 + wind.l6 + solar.l6 + coal.l6 + natural_gas.l6 + wind.l7 + solar.l7 + coal.l7 + natural_gas.l7 + wind.l8 + solar.l8 + coal.l8 + natural_gas.l8 + wind.l9 + solar.l9 + coal.l9 + natural_gas.l9 + wind.l10 + solar.l10 + coal.l10 + natural_gas.l10 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
wind.l1         -3.216e-02  1.337e-02  -2.405  0.01688 *  
solar.l1         4.952e-01  6.385e-02   7.755 2.14e-13 ***
coal.l1          3.695e-03  3.077e-03   1.201  0.23096    
natural_gas.l1  -6.061e-03  3.540e-03  -1.712  0.08808 .  
wind.l2         -1.071e-02  1.462e-02  -0.732  0.46460    
solar.l2         3.691e-01  7.034e-02   5.247 3.25e-07 ***
coal.l2         -3.696e-03  3.711e-03  -0.996  0.32026    
natural_gas.l2   2.660e-03  4.300e-03   0.619  0.53677    
wind.l3          3.253e-03  1.461e-02   0.223  0.82397    
solar.l3         1.886e-01  7.194e-02   2.621  0.00930 ** 
coal.l3          1.526e-04  3.633e-03   0.042  0.96653    
natural_gas.l3   5.833e-03  4.337e-03   1.345  0.17984    
wind.l4          3.581e-02  1.458e-02   2.456  0.01471 *  
solar.l4        -3.702e-01  7.178e-02  -5.157 5.06e-07 ***
coal.l4         -8.134e-04  3.662e-03  -0.222  0.82438    
natural_gas.l4  -1.105e-02  4.308e-03  -2.566  0.01087 *  
wind.l5          1.976e-02  1.470e-02   1.345  0.17998    
solar.l5         1.505e-02  7.539e-02   0.200  0.84188    
coal.l5          3.182e-03  3.614e-03   0.880  0.37953    
natural_gas.l5   3.612e-03  4.279e-03   0.844  0.39938    
wind.l6          3.202e-03  1.479e-02   0.217  0.82877    
solar.l6        -1.016e-01  7.819e-02  -1.299  0.19504    
coal.l6          1.764e-03  3.559e-03   0.495  0.62069    
natural_gas.l6  -5.727e-03  4.169e-03  -1.374  0.17076    
wind.l7         -2.806e-02  1.469e-02  -1.911  0.05718 .  
solar.l7         6.280e-02  7.764e-02   0.809  0.41936    
coal.l7         -5.481e-03  3.551e-03  -1.543  0.12399    
natural_gas.l7   9.725e-03  4.308e-03   2.258  0.02483 *  
wind.l8         -6.149e-02  1.481e-02  -4.153 4.48e-05 ***
solar.l8        -1.309e-02  8.125e-02  -0.161  0.87211    
coal.l8         -2.904e-03  3.652e-03  -0.795  0.42723    
natural_gas.l8  -8.497e-03  4.402e-03  -1.930  0.05469 .  
wind.l9         -1.684e-02  1.516e-02  -1.111  0.26765    
solar.l9         2.208e-01  8.614e-02   2.564  0.01094 *  
coal.l9          3.251e-03  3.723e-03   0.873  0.38334    
natural_gas.l9   3.709e-03  4.455e-03   0.833  0.40585    
wind.l10         3.428e-02  1.399e-02   2.450  0.01496 *  
solar.l10        2.496e-01  7.812e-02   3.194  0.00158 ** 
coal.l10        -5.278e-03  3.160e-03  -1.670  0.09616 .  
natural_gas.l10 -1.813e-03  3.448e-03  -0.526  0.59957    
const            1.224e+03  8.057e+02   1.519  0.13000    
trend            5.912e+00  2.407e+00   2.456  0.01471 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 353.4 on 254 degrees of freedom
Multiple R-Squared: 0.9971, Adjusted R-squared: 0.9966 
F-statistic:  2098 on 41 and 254 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation coal: 
===================================== 
coal = wind.l1 + solar.l1 + coal.l1 + natural_gas.l1 + wind.l2 + solar.l2 + coal.l2 + natural_gas.l2 + wind.l3 + solar.l3 + coal.l3 + natural_gas.l3 + wind.l4 + solar.l4 + coal.l4 + natural_gas.l4 + wind.l5 + solar.l5 + coal.l5 + natural_gas.l5 + wind.l6 + solar.l6 + coal.l6 + natural_gas.l6 + wind.l7 + solar.l7 + coal.l7 + natural_gas.l7 + wind.l8 + solar.l8 + coal.l8 + natural_gas.l8 + wind.l9 + solar.l9 + coal.l9 + natural_gas.l9 + wind.l10 + solar.l10 + coal.l10 + natural_gas.l10 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
wind.l1         -4.461e-01  3.108e-01  -1.435 0.152404    
solar.l1         7.785e-01  1.484e+00   0.525 0.600269    
coal.l1          5.831e-01  7.150e-02   8.155 1.61e-14 ***
natural_gas.l1   7.192e-02  8.225e-02   0.874 0.382722    
wind.l2         -1.433e-01  3.398e-01  -0.422 0.673565    
solar.l2         4.676e-01  1.634e+00   0.286 0.775052    
coal.l2          1.483e-01  8.624e-02   1.720 0.086663 .  
natural_gas.l2  -1.968e-01  9.992e-02  -1.970 0.049958 *  
wind.l3          5.886e-01  3.394e-01   1.734 0.084137 .  
solar.l3        -1.404e+00  1.672e+00  -0.840 0.401862    
coal.l3         -1.148e-01  8.442e-02  -1.360 0.175103    
natural_gas.l3  -1.338e-01  1.008e-01  -1.328 0.185326    
wind.l4         -3.265e-01  3.388e-01  -0.964 0.336003    
solar.l4        -2.138e+00  1.668e+00  -1.282 0.201159    
coal.l4         -5.747e-02  8.508e-02  -0.675 0.499997    
natural_gas.l4   1.065e-01  1.001e-01   1.064 0.288374    
wind.l5          3.902e-02  3.415e-01   0.114 0.909105    
solar.l5         1.513e+00  1.752e+00   0.864 0.388503    
coal.l5          1.229e-01  8.398e-02   1.463 0.144590    
natural_gas.l5   1.383e-01  9.943e-02   1.390 0.165619    
wind.l6         -2.918e-01  3.436e-01  -0.849 0.396512    
solar.l6         4.197e+00  1.817e+00   2.310 0.021696 *  
coal.l6          7.238e-02  8.270e-02   0.875 0.382335    
natural_gas.l6  -3.512e-01  9.688e-02  -3.625 0.000349 ***
wind.l7         -4.420e-01  3.413e-01  -1.295 0.196480    
solar.l7        -1.465e+00  1.804e+00  -0.812 0.417590    
coal.l7          1.803e-01  8.251e-02   2.185 0.029817 *  
natural_gas.l7  -5.628e-02  1.001e-01  -0.562 0.574407    
wind.l8         -8.256e-02  3.440e-01  -0.240 0.810547    
solar.l8        -2.712e+00  1.888e+00  -1.436 0.152092    
coal.l8         -3.032e-01  8.485e-02  -3.574 0.000421 ***
natural_gas.l8  -5.455e-02  1.023e-01  -0.533 0.594300    
wind.l9          4.088e-01  3.522e-01   1.161 0.246778    
solar.l9         4.886e-01  2.001e+00   0.244 0.807317    
coal.l9         -1.575e-01  8.651e-02  -1.820 0.069913 .  
natural_gas.l9  -7.517e-02  1.035e-01  -0.726 0.468340    
wind.l10        -4.922e-01  3.251e-01  -1.514 0.131328    
solar.l10        9.746e-01  1.815e+00   0.537 0.591788    
coal.l10         1.721e-01  7.343e-02   2.343 0.019899 *  
natural_gas.l10  1.305e-01  8.012e-02   1.629 0.104592    
const            7.800e+04  1.872e+04   4.166 4.25e-05 ***
trend            1.288e+02  5.593e+01   2.304 0.022046 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 8211 on 254 degrees of freedom
Multiple R-Squared: 0.9682, Adjusted R-squared: 0.9631 
F-statistic: 188.6 on 41 and 254 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation natural_gas: 
============================================ 
natural_gas = wind.l1 + solar.l1 + coal.l1 + natural_gas.l1 + wind.l2 + solar.l2 + coal.l2 + natural_gas.l2 + wind.l3 + solar.l3 + coal.l3 + natural_gas.l3 + wind.l4 + solar.l4 + coal.l4 + natural_gas.l4 + wind.l5 + solar.l5 + coal.l5 + natural_gas.l5 + wind.l6 + solar.l6 + coal.l6 + natural_gas.l6 + wind.l7 + solar.l7 + coal.l7 + natural_gas.l7 + wind.l8 + solar.l8 + coal.l8 + natural_gas.l8 + wind.l9 + solar.l9 + coal.l9 + natural_gas.l9 + wind.l10 + solar.l10 + coal.l10 + natural_gas.l10 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
wind.l1          2.169e-01  2.643e-01   0.820  0.41276    
solar.l1        -2.938e+00  1.262e+00  -2.328  0.02070 *  
coal.l1         -1.538e-01  6.082e-02  -2.529  0.01204 *  
natural_gas.l1   7.498e-01  6.997e-02  10.717  &lt; 2e-16 ***
wind.l2         -4.644e-01  2.890e-01  -1.607  0.10939    
solar.l2         1.605e+00  1.390e+00   1.155  0.24925    
coal.l2          3.563e-02  7.336e-02   0.486  0.62759    
natural_gas.l2  -1.807e-01  8.499e-02  -2.125  0.03451 *  
wind.l3          6.833e-01  2.887e-01   2.366  0.01871 *  
solar.l3        -3.196e-01  1.422e+00  -0.225  0.82234    
coal.l3         -1.692e-01  7.181e-02  -2.356  0.01924 *  
natural_gas.l3  -9.628e-02  8.572e-02  -1.123  0.26241    
wind.l4         -2.387e-01  2.882e-01  -0.828  0.40818    
solar.l4        -1.098e-02  1.419e+00  -0.008  0.99383    
coal.l4         -2.624e-02  7.237e-02  -0.363  0.71726    
natural_gas.l4   2.203e-02  8.515e-02   0.259  0.79603    
wind.l5         -5.692e-01  2.905e-01  -1.959  0.05115 .  
solar.l5         3.560e+00  1.490e+00   2.389  0.01763 *  
coal.l5         -1.298e-01  7.144e-02  -1.818  0.07030 .  
natural_gas.l5   9.238e-02  8.458e-02   1.092  0.27580    
wind.l6         -1.670e-01  2.923e-01  -0.571  0.56835    
solar.l6         3.411e-01  1.545e+00   0.221  0.82550    
coal.l6          3.845e-03  7.035e-02   0.055  0.95646    
natural_gas.l6  -2.381e-01  8.241e-02  -2.889  0.00420 ** 
wind.l7          2.874e-01  2.903e-01   0.990  0.32315    
solar.l7        -4.002e+00  1.535e+00  -2.608  0.00965 ** 
coal.l7          2.969e-01  7.019e-02   4.230 3.27e-05 ***
natural_gas.l7  -9.313e-02  8.514e-02  -1.094  0.27510    
wind.l8         -1.122e-01  2.927e-01  -0.383  0.70182    
solar.l8        -3.448e+00  1.606e+00  -2.147  0.03274 *  
coal.l8         -1.158e-01  7.218e-02  -1.605  0.10976    
natural_gas.l8  -5.717e-02  8.702e-02  -0.657  0.51179    
wind.l9          3.537e-01  2.996e-01   1.181  0.23876    
solar.l9         4.147e+00  1.703e+00   2.436  0.01554 *  
coal.l9         -1.142e-01  7.359e-02  -1.551  0.12203    
natural_gas.l9  -9.644e-02  8.804e-02  -1.095  0.27443    
wind.l10        -8.975e-01  2.766e-01  -3.245  0.00133 ** 
solar.l10        2.210e+00  1.544e+00   1.431  0.15356    
coal.l10         8.528e-02  6.246e-02   1.365  0.17341    
natural_gas.l10  1.820e-01  6.815e-02   2.670  0.00806 ** 
const            7.970e+04  1.593e+04   5.005 1.05e-06 ***
trend            2.236e+02  4.758e+01   4.699 4.28e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 6984 on 254 degrees of freedom
Multiple R-Squared: 0.9696, Adjusted R-squared: 0.9647 
F-statistic: 197.7 on 41 and 254 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                wind  solar     coal natural_gas
wind         3108218 198223 -1490440    -1948601
solar         198223 124862   325507       48199
coal        -1490440 325507 67415908    27635060
natural_gas -1948601  48199 27635060    48780515

Correlation matrix of residuals:
               wind   solar    coal natural_gas
wind         1.0000 0.31819 -0.1030    -0.15825
solar        0.3182 1.00000  0.1122     0.01953
coal        -0.1030 0.11219  1.0000     0.48190
natural_gas -0.1583 0.01953  0.4819     1.00000</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>The cross-validation results are very similar. Considering the principle of parsimony, we select VAR(8) as the best model.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df_ts <span class="ot">&lt;-</span> df_ts  </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ts</span>(df_ts,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>),  <span class="co"># Jan 2000</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df_ts)        <span class="co"># total observations, here 198</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">4</span>                  <span class="co"># forecast horizon = 4 months</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">60</span>                 <span class="co"># choose rolling steps (e.g., 60 months)</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> n <span class="sc">-</span> h <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> R      <span class="co"># initial training size</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Initial training size k ="</span>, k, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Initial training size k = 243 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rolling steps R ="</span>, R, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rolling steps R = 60 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE matrices: R rows × 4 forecast horizons × 4 variables</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>vars_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(df_ts)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>rmse_VAR1 <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(R, h, <span class="dv">4</span>),</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">paste0</span>(<span class="st">"h"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), vars_names))</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>rmse_VAR2 <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(R, h, <span class="dv">4</span>),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">paste0</span>(<span class="st">"h"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), vars_names))</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Rolling Forecast Loop</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- training index ----</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  train_end <span class="ot">&lt;-</span> k <span class="sc">+</span> i <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> y[<span class="dv">1</span><span class="sc">:</span>train_end, ]</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- test index (next 4 months) ----</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> y[(train_end <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(train_end <span class="sc">+</span> h), ]</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># VAR(8)</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(xtrain, <span class="at">p =</span> <span class="dv">8</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  fc1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit1, <span class="at">n.ahead =</span> h)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract forecasts as matrix h × 4</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  f1mat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fc1<span class="sc">$</span>fcst, <span class="cf">function</span>(x) x[,<span class="dv">1</span>])</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># RMSE for each horizon and variable</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  rmse_VAR1[i, , ] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((f1mat <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># VAR(10)</span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(xtrain, <span class="at">p =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>  fc2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> h)</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>  f2mat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fc2<span class="sc">$</span>fcst, <span class="cf">function</span>(x) x[,<span class="dv">1</span>])</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  rmse_VAR2[i, , ] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((f2mat <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Compute Average RMSE</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>avg_rmse_VAR1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(rmse_VAR1, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>avg_rmse_VAR2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(rmse_VAR2, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Average RMSE (VAR(8)):"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Average RMSE (VAR(8)):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_rmse_VAR1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       wind     solar      coal natural_gas
h1 3033.775  722.5353  9548.566    10926.18
h2 3431.019  858.1524 12479.094    14739.77
h3 3778.627  990.0419 14481.603    15876.96
h4 3385.318 1108.8745 14758.000    13151.50</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Average RMSE (VAR(10)):"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Average RMSE (VAR(10)):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(avg_rmse_VAR2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       wind     solar      coal natural_gas
h1 3182.289  654.1270  9972.004   10372.523
h2 3575.924  777.7966 11344.345   11750.857
h3 3587.279  933.6982 12007.739   11004.535
h4 3411.327 1035.7083 12573.067    9314.433</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Example Plot: Solar RMSE</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">step =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>R, <span class="dv">2</span>),</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rmse =</span> <span class="fu">c</span>(rmse_VAR1[,<span class="dv">1</span>,<span class="st">"solar"</span>], rmse_VAR2[,<span class="dv">1</span>,<span class="st">"solar"</span>]),</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"VAR(8)"</span>, <span class="st">"VAR(10)"</span>), <span class="at">each =</span> R)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> rmse, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"1-step-ahead RMSE for Solar (Rolling Forecast)"</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Rolling step"</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"RMSE"</span>) <span class="sc">+</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<p>The prediction results based on the VAR(8) model indicate that the proportion of electricity generated by traditional fossil energy (coal and natural gas) is expected to continue to decline, while clean energy (solar and wind) is showing a significant growth trend, reflecting the long-term transformation of the energy structure towards low-carbon and renewable directions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">VAR</span>(df_ts, <span class="at">p =</span> <span class="dv">8</span>, <span class="at">type =</span> <span class="st">"both"</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">32</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="multivariate_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>