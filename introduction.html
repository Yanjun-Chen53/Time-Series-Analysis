<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.21">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Energy Transition: A Time Series Perspective</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assets/gu-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea1d7ac60288e0f1efdbc993fd8432ae.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-870b6070356b2f6ba798b4fc2bd491a6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./introduction.html" aria-current="page"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./source.html"> 
<span class="menu-text">Data Sources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./visualization.html"> 
<span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./EDA.html"> 
<span class="menu-text">Exploratory Data Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./univariate.html"> 
<span class="menu-text">Univariate TS Models (ARIMA/SARIMA)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./multivariate.html"> 
<span class="menu-text">Multivariate TS Models (ARIMAX/SARIMAX/VAR)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./financial.html"> 
<span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DL.html"> 
<span class="menu-text">Deep Learning for TS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./other.html"> 
<span class="menu-text">Other-Interrupted TS/ARFIMA/Spectral Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusion.html"> 
<span class="menu-text">Conclusions</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#topic-explanation" id="toc-topic-explanation" class="nav-link active" data-scroll-target="#topic-explanation"><strong>Topic Explanation</strong></a></li>
  <li><a href="#the-big-picture" id="toc-the-big-picture" class="nav-link" data-scroll-target="#the-big-picture"><strong>The Big Picture</strong></a></li>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link" data-scroll-target="#literature-review"><strong>Literature Review</strong></a></li>
  <li><a href="#guiding-questions" id="toc-guiding-questions" class="nav-link" data-scroll-target="#guiding-questions"><strong>Guiding Questions</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Energy Transition: A Time Series Perspective</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="topic-explanation" class="level2">
<h2 class="anchored" data-anchor-id="topic-explanation"><strong>Topic Explanation</strong></h2>
<p>The world is undergoing a profound transformation in how energy is produced, consumed, and financed. Historically, global economic growth has been tightly coupled with fossil fuels such as oil, coal, and natural gas. However, mounting evidence of climate change, advances in clean technologies, and shifting government policies have accelerated the global transition toward renewable energy. This transition—often described as the “energy transition”—is reshaping markets, altering geopolitical balances, and influencing the financial system.</p>
<p>From a data science perspective, this topic provides a unique opportunity to explore long-term structural trends alongside short-term volatility. Energy data exhibits strong seasonality (e.g., higher natural gas demand in winter, increased electricity demand during summer heat waves), as well as structural breaks (such as the 2015 Paris Agreement or the 2020 oil price crash). It also connects multiple domains: technology costs, consumer behavior, financial market reactions, and environmental policy.</p>
<p>Understanding these dynamics is not just an academic exercise—governments, investors, and industries rely on such analyses to guide decision-making in the face of uncertainty.</p>
</section>
<section id="the-big-picture" class="level2">
<h2 class="anchored" data-anchor-id="the-big-picture"><strong>The Big Picture</strong></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/big.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
<p>The global shift to clean energy is one of the most significant transformations shaping the 21st-century economy, with implications spanning technology, markets, policy, and finance. This analysis will consider the following five main areas:</p>
<p><strong>Evolution and Seasonality of Power Generation MixExplanation:</strong> This theme examines how the global and U.S. electricity generation mix has evolved over time, focusing on the relative rise of renewable sources—particularly wind and solar—against the decline of fossil fuels such as coal and natural gas. The analysis uses time-series models (ARIMA/SARIMA) to capture both long-term structural trends and recurring seasonal patterns in generation data.</p>
<p><strong>Price Linkages Across Fossil Fuels and Energy Equities:</strong> This theme explores how fossil fuel prices (WTI crude oil, Henry Hub natural gas) interact with financial market indicators such as the Energy ETF (XLE) and the Clean Energy ETF (ICLE/ICLN). Vector autoregression (VAR) and ARIMAX models are used to identify short-run and long-run linkages, Granger causality, and potential substitution effects between traditional and renewable sectors.</p>
<p><strong>Volatility and Risk Spillovers in Energy and Financial Markets</strong> This component investigates the dynamic volatility interactions among commodities (WTI, HH), sectoral ETFs (XLE, ICLE), and the market-wide Volatility Index (VIX). GARCH-type and VAR-GARCH models quantify volatility clustering, persistence, and cross-market spillovers that reveal systemic risk channels during transition shocks.</p>
<p><strong>Substitution and Decarbonization Dynamics in Power Systems:</strong> This theme studies the interdependence between renewable and fossil-fuel generation—whether increases in wind and solar output correspond to reductions in coal and gas use. A multivariate VAR or VECM framework captures substitution relationships and structural responses to carbon-pricing or policy interventions.</p>
</section>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review"><strong>Literature Review</strong></h2>
<p><strong>Evolution and Seasonality of Power Generation MixExplanation</strong></p>
<p>Research on renewable generation consistently highlights the dual importance of structural capacity growth and meteorological drivers. Reports from major energy agencies show that wind and solar have become the dominant sources of new generation capacity, with global trends documented extensively in BloombergNEF’s Energy Transition Investment Trends<span class="citation" data-cites="bnef2023"><sup><a href="#ref-bnef2023" role="doc-biblioref">1</a></sup></span>, the IEA Renewables Outlook<span class="citation" data-cites="iea2023"><sup><a href="#ref-iea2023" role="doc-biblioref">2</a></sup></span>, and the Ember Global Electricity Review<span class="citation" data-cites="ember2024"><sup><a href="#ref-ember2024" role="doc-biblioref">3</a></sup></span>. Academic work reinforces these patterns: renewable output reflects long-run technological expansion as well as predictable seasonal cycles. Studies in energy-economics literature demonstrate that SARIMA-type models remain robust baselines for understanding periodicity and structural growth when high-resolution irradiance data are unavailable. This aligns with empirical evidence showing that renewable generation follows strong annual seasonality driven by daylight variation and weather, while long-term increases reflect sustained installation of solar and wind resources.</p>
<p><strong>Price Linkages Across Fossil Fuels and Energy Equities</strong></p>
<p>The relationship between fossil-fuel prices and energy-related equities is well documented. Classic work by Henriques and Sadorsky finds that oil price movements affect alternative-energy stock performance through risk-transmission and substitution channels<span class="citation" data-cites="henriques2008"><sup><a href="#ref-henriques2008" role="doc-biblioref">4</a></sup></span>. Additional evidence from Broadstock et al.&nbsp;shows that commodity shocks propagate into sectoral equity markets, with distinct dynamics between traditional and renewable energy companies<span class="citation" data-cites="broadstock2012"><sup><a href="#ref-broadstock2012" role="doc-biblioref">5</a></sup></span>. More recent global studies highlight increased integration between green finance and clean-energy stocks, particularly after 2020, driven by policy tightening and ESG capital flows<span class="citation" data-cites="zaremba2023"><sup><a href="#ref-zaremba2023" role="doc-biblioref">6</a></sup></span>. VAR-based analyses consistently reveal strong short-run causality among WTI, natural gas prices, and both XLE and clean-energy ETFs, reinforcing the appropriateness of multivariate time-series models for capturing energy-finance linkages.</p>
<p><strong>Volatility and Risk Spillovers in Energy and Financial Markets</strong></p>
<p>Volatility spillovers across energy and financial markets have been extensively examined using GARCH-type and DCC models. Empirical studies show significant bidirectional risk transmission between fossil commodities and clean-energy stocks, with spillovers intensifying during periods of uncertainty<span class="citation" data-cites="mensi2019"><sup><a href="#ref-mensi2019" role="doc-biblioref">7</a></sup></span>. Dynamic-correlation research confirms that oil, gas, and renewable-energy equities exhibit time-varying co-movements that strengthen during crises such as the 2020 pandemic or geopolitical price shocks<span class="citation" data-cites="reboredo2020"><sup><a href="#ref-reboredo2020" role="doc-biblioref">8</a></sup></span>. These findings support incorporating VIX as a measure of market-wide risk aversion and justify using multivariate volatility models to capture clustering, persistence, and cross-market contagion effects within the energy transition context.</p>
<p><strong>Substitution and Decarbonization Dynamics in Power Systems</strong></p>
<p>The substitution dynamics between renewable and fossil-fuel generation are a central focus in the decarbonization literature. Evidence from the U.S. shows that increases in wind and solar generation reduce coal output and, in some cases, natural-gas dispatch—although the magnitude varies by region and policy structure. Fabrizio, Rose, and Wolfram find that renewables measurably displace coal generation in U.S. power markets<span class="citation" data-cites="fabrizio2017"><sup><a href="#ref-fabrizio2017" role="doc-biblioref">9</a></sup></span>. Complementary work by Fell and Linn demonstrates that renewable penetration affects electricity prices, emissions, and fossil-fuel output through both market and policy channels<span class="citation" data-cites="fell2022"><sup><a href="#ref-fell2022" role="doc-biblioref">10</a></sup></span>. Cross-country VAR analyses further show that renewable shocks produce persistent negative responses in coal and gas generation, confirming long-run substitution dynamics consistent with the energy-transition narrative<span class="citation" data-cites="newbery2018 schwarz2021"><sup><a href="#ref-newbery2018" role="doc-biblioref">11</a>,<a href="#ref-schwarz2021" role="doc-biblioref">12</a></sup></span>.</p>
</section>
<section id="guiding-questions" class="level2">
<h2 class="anchored" data-anchor-id="guiding-questions"><strong>Guiding Questions</strong></h2>
<ol type="1">
<li>How has the generation share of renewables changed relative to coal and gas since 2000?</li>
<li>Which energy sources show the strongest seasonality, and has that seasonality intensified or weakened over time?</li>
<li>When controlling for trend and seasonality, are there structural breaks corresponding to policy shifts (e.g., 2015 Paris Agreement, 2020 COVID-19 shock)?</li>
<li>What are the best-fit seasonal models (SARIMA vs.&nbsp;Fourier-based) for different generation types?</li>
<li>How do shocks in fossil fuel prices transmit to renewable-energy equity performance?</li>
<li>ave the price linkages changed in strength or direction after 2020?</li>
<li>Is there evidence of cointegration between fossil energy and clean-energy financial markets? Are volatility shocks from fossil markets transmitted to clean-energy equities?</li>
<li>Do spillovers exhibit asymmetric behavior during price surges versus declines?</li>
<li>How stable are volatility dynamics before and after major policy or geopolitical shocks?</li>
<li>Are the substitution effects symmetric across fuels (gas vs.&nbsp;coal)?</li>
<li>How do these dynamics change around major carbon-pricing or subsidy-policy events?</li>
<li>Does renewable growth contribute to lower overall generation volatility or merely shift it across sources?</li>
</ol>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-bnef2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">BloombergNEF. <em>Energy transition investment trends 2023</em>. <a href="https://about.bnef.com">https://about.bnef.com</a> (2023).</div>
</div>
<div id="ref-iea2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Agency, I. E. <a href="https://www.iea.org/reports/renewables-2023">Renewables 2023: Analysis and forecast to 2028</a>. (2023).</div>
</div>
<div id="ref-ember2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Climate, E. <em>Global electricity review 2024</em>. <a href="https://ember-climate.org">https://ember-climate.org</a> (2024).</div>
</div>
<div id="ref-henriques2008" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Henriques, I. &amp; Sadorsky, P. Oil prices and the stock prices of alternative energy companies. <em>Energy Economics</em> <strong>30</strong>, 998–1010 (2008).</div>
</div>
<div id="ref-broadstock2012" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Broadstock, D. C., Cao, H. &amp; Zhang, D. Oil shocks and their impact on energy related stocks: Evidence from china. <em>Energy Economics</em> <strong>34</strong>, 1888–1895 (2012).</div>
</div>
<div id="ref-zaremba2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Zaremba, A., Umar, Z. &amp; Mikutowski, M. Green finance and clean energy stocks: Global evidence. <em>Journal of Cleaner Production</em> <strong>385</strong>, 135673 (2023).</div>
</div>
<div id="ref-mensi2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Mensi, W., Rehman, M. &amp; Shahzad, S. J. H. Volatility spillovers between energy markets and clean energy stocks. <em>Energy</em> <strong>171</strong>, 89–100 (2019).</div>
</div>
<div id="ref-reboredo2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Reboredo, J., Ugolini, A. &amp; Aiube, F. Dynamic conditional correlations between oil, gas and clean energy. <em>Energy Economics</em> <strong>87</strong>, 104709 (2020).</div>
</div>
<div id="ref-fabrizio2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Fabrizio, K., Rose, N. &amp; Wolfram, C. Do renewables displace coal? Evidence from u.s. Electricity generation. <em>American Economic Journal: Economic Policy</em> <strong>9</strong>, 32–60 (2017).</div>
</div>
<div id="ref-fell2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Fell, H. &amp; Linn, J. The effect of renewable energy on electricity prices, generation, and emissions. <em>Journal of Environmental Economics and Management</em> <strong>111</strong>, 102577 (2022).</div>
</div>
<div id="ref-newbery2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Newbery, D. The value of variable renewables: Impact on markets and grids. <em>Energy Policy</em> <strong>113</strong>, 427–436 (2018).</div>
</div>
<div id="ref-schwarz2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Schwarz, G., Tuerk, A. &amp; Resch, G. Substitution dynamics between renewables and fossil fuels: A VAR analysis. <em>Energy Studies Review</em> <strong>28</strong>, (2021).</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>