<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.21">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Energy Transition: A Time Series Perspective</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assets/gu-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea1d7ac60288e0f1efdbc993fd8432ae.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-870b6070356b2f6ba798b4fc2bd491a6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./introduction.html" aria-current="page"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./source.html"> 
<span class="menu-text">Data Sources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./visualization.html"> 
<span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./EDA.html"> 
<span class="menu-text">Exploratory Data Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./univariate.html"> 
<span class="menu-text">Univariate TS Models (ARIMA/SARIMA)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./multivariate.html"> 
<span class="menu-text">Multivariate TS Models (ARIMAX/SARIMAX/VAR)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./financial.html"> 
<span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DL.html"> 
<span class="menu-text">Deep Learning for TS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./other.html"> 
<span class="menu-text">Other-Interrupted TS/ARFIMA/Spectral Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusion.html"> 
<span class="menu-text">Conclusions</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#topic-explanation" id="toc-topic-explanation" class="nav-link active" data-scroll-target="#topic-explanation"><strong>Topic Explanation</strong></a></li>
  <li><a href="#the-big-picture" id="toc-the-big-picture" class="nav-link" data-scroll-target="#the-big-picture"><strong>The Big Picture</strong></a></li>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link" data-scroll-target="#literature-review"><strong>Literature Review</strong></a></li>
  <li><a href="#guiding-questions" id="toc-guiding-questions" class="nav-link" data-scroll-target="#guiding-questions"><strong>Guiding Questions</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Energy Transition: A Time Series Perspective</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="topic-explanation" class="level2">
<h2 class="anchored" data-anchor-id="topic-explanation"><strong>Topic Explanation</strong></h2>
<p>The world is undergoing a profound transformation in how energy is produced, consumed, and financed. Historically, global economic growth has been tightly coupled with fossil fuels such as oil, coal, and natural gas. However, mounting evidence of climate change, advances in clean technologies, and shifting government policies have accelerated the global transition toward renewable energy. This transition—often described as the “energy transition”—is reshaping markets, altering geopolitical balances, and influencing the financial system.</p>
<p>From a data science perspective, this topic provides a unique opportunity to explore long-term structural trends alongside short-term volatility. Energy data exhibits strong seasonality (e.g., higher natural gas demand in winter, increased electricity demand during summer heat waves), as well as structural breaks (such as the 2015 Paris Agreement or the 2020 oil price crash). It also connects multiple domains: technology costs, consumer behavior, financial market reactions, and environmental policy.</p>
<p>Understanding these dynamics is not just an academic exercise—governments, investors, and industries rely on such analyses to guide decision-making in the face of uncertainty.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/i.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</section>
<section id="the-big-picture" class="level2">
<h2 class="anchored" data-anchor-id="the-big-picture"><strong>The Big Picture</strong></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/big.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
<p>The global shift to clean energy is one of the most significant transformations shaping the 21st-century economy, with implications spanning technology, markets, policy, and finance. This analysis will consider the following five main areas:</p>
<p><strong>Long-Run Evolution of Power Generation Mix:</strong> This theme examines how the composition of electricity generation—wind, solar, natural gas, coal, nuclear, and hydro—has shifted over time. It focuses on long-term decarbonization trends, structural breakpoints, and the growing role of renewables.</p>
<p><strong>Seasonality &amp; Climate Drivers:</strong> This theme investigates seasonal and climatic patterns in different generation sources and how temperature, irradiance, wind patterns, and hydrology influence renewable and fossil-fuel generation.</p>
<p><strong>Linkages and Causality in Energy Prices:</strong> This theme analyzes dynamic interactions among WTI crude oil, Henry Hub natural gas, and energy-related financial indices, focusing on short-run spillovers, long-run cointegration, and causal relationships.</p>
<p><strong>Financial Dynamics of Clean Energy Assets (Return &amp; Volatility Behavior):</strong> This theme focuses on price behavior, return dynamics, volatility clustering, and risk spillovers in clean energy ETFs (ICLE/ICLN), especially relative to traditional energy ETFs such as XLE.</p>
<p><strong>Dynamic Interactions within Multi-Energy Systems (Inter-Energy Dynamics):</strong> This theme analyzes how different energy sources interact in a multi-energy system—whether renewables displace fossil fuels, whether natural gas complements variable renewables, and how shocks propagate through the generation network.</p>
</section>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review"><strong>Literature Review</strong></h2>
<p><strong>Long-Run Evolution of Power Generation Mix</strong></p>
<p>Global studies show that the power sector is undergoing consistent structural decarbonization. Large-scale industry reports, such as BP’s Statistical Review<span class="citation" data-cites="bp2023"><sup><a href="#ref-bp2023" role="doc-biblioref">1</a></sup></span> and the IEA’s World Energy Outlook<span class="citation" data-cites="iea2022"><sup><a href="#ref-iea2022" role="doc-biblioref">2</a></sup></span>, document that renewable generation is expanding faster than fossil fuels.</p>
<p>Academic literature emphasizes that declining technology costs and supportive policies play a major role in accelerating renewable adoption<span class="citation" data-cites="aklin2018"><sup><a href="#ref-aklin2018" role="doc-biblioref">3</a></sup></span>. BloombergNEF identifies several “cost-parity tipping points,” where renewables become cheaper than fossil alternatives<span class="citation" data-cites="bnef2023"><sup><a href="#ref-bnef2023" role="doc-biblioref">4</a></sup></span>, reinforcing long-run structural shifts.</p>
<p><strong>Seasonality and Climate-Driven Dynamics of Energy Supply</strong></p>
<p>Solar power’s strong dependence on irradiance and seasonal temperature cycles has been widely documented<span class="citation" data-cites="gilbert2016"><sup><a href="#ref-gilbert2016" role="doc-biblioref">5</a></sup></span>. Wind power output is shaped by atmospheric circulation patterns, which vary by season and region<span class="citation" data-cites="pryor2020"><sup><a href="#ref-pryor2020" role="doc-biblioref">6</a></sup></span>.</p>
<p>Natural gas generation typically peaks during winter months due to heating demand, as shown in U.S. EIA research<span class="citation" data-cites="eia2021"><sup><a href="#ref-eia2021" role="doc-biblioref">7</a></sup></span>. Hydropower output depends on precipitation and seasonal water availability, and climate variability is increasingly recognized as a source of short-run volatility in renewable generation across multiple studies.</p>
<p><strong>Linkages and Causality in Energy Prices</strong></p>
<p>Oil price shocks affect broader energy markets through production costs and macroeconomic channels<span class="citation" data-cites="hamilton2009"><sup><a href="#ref-hamilton2009" role="doc-biblioref">8</a></sup></span>.</p>
<p>Studies show mixed evidence of integration between oil and natural gas: some periods show price comovement<span class="citation" data-cites="bachmeier2006"><sup><a href="#ref-bachmeier2006" role="doc-biblioref">9</a></sup></span>, while others suggest partial decoupling depending on market structure<span class="citation" data-cites="kilian2014"><sup><a href="#ref-kilian2014" role="doc-biblioref">10</a></sup></span>.</p>
<p>Financial literature further indicates strong causal links between energy prices and sector-level equity indices<span class="citation" data-cites="narayan2010"><sup><a href="#ref-narayan2010" role="doc-biblioref">11</a></sup></span>, with volatility intensifying during crises, as observed in connectedness research<span class="citation" data-cites="diebold2014"><sup><a href="#ref-diebold2014" role="doc-biblioref">12</a></sup></span>.</p>
<p><strong>Financial Dynamics of Clean Energy Assets</strong></p>
<p>Clean energy equities are highly sensitive to fluctuations in oil prices, as shown in early work on alternative energy stocks<span class="citation" data-cites="henriques2008"><sup><a href="#ref-henriques2008" role="doc-biblioref">13</a></sup></span>.</p>
<p>Clean energy assets display strong volatility clustering, making GARCH-family models appropriate for risk analysis<span class="citation" data-cites="sadorsky2012"><sup><a href="#ref-sadorsky2012" role="doc-biblioref">14</a></sup></span>.</p>
<p>More recent work suggests these assets are gradually transitioning from being predominantly policy-driven to more market-driven<span class="citation" data-cites="pham2019"><sup><a href="#ref-pham2019" role="doc-biblioref">15</a></sup></span>, yet they remain exposed to macro-energy shocks.</p>
<p>Cross-asset spillovers—especially during periods of market stress—can be analyzed through the connectedness framework proposed in<span class="citation" data-cites="diebold2014"><sup><a href="#ref-diebold2014" role="doc-biblioref">12</a></sup></span>.</p>
<p><strong>Dynamic Interactions within Multi-Energy Systems</strong></p>
<p>Renewable energy expansion often displaces fossil-fuel generation, consistent with evidence of long-term “crowding out” effects<span class="citation" data-cites="newbery2018"><sup><a href="#ref-newbery2018" role="doc-biblioref">16</a></sup></span>.</p>
<p>Natural gas plays a critical role as a flexible generation source that compensates for wind and solar intermittency<span class="citation" data-cites="stern2012"><sup><a href="#ref-stern2012" role="doc-biblioref">17</a></sup></span>.</p>
<p>Recent system-level analyses highlight that shocks can propagate across coal, gas, and renewable sources through substitution and complementarity channels<span class="citation" data-cites="marques2020"><sup><a href="#ref-marques2020" role="doc-biblioref">18</a></sup></span>.</p>
<p>These dynamic interactions underscore the importance of VAR and structural modeling approaches in understanding modern electricity systems.</p>
</section>
<section id="guiding-questions" class="level2">
<h2 class="anchored" data-anchor-id="guiding-questions"><strong>Guiding Questions</strong></h2>
<ol type="1">
<li>Has the power generation structure (wind, solar, gas, coal, nuclear, hydro) consistently shifted towards clean energy over the past decade? How rapidly has this shift occurred?</li>
<li>Do clean energy sources such as wind, solar, and hydropower exhibit significant and stable seasonal patterns? Is this seasonality changing?</li>
<li>How much does weather (temperature or HDD/CDD) affect solar, wind, and natural gas power generation? Are there any lag effects?</li>
<li>Is there a significant correlation between oil prices (WTI) and natural gas prices (Henry Hub)? Which leads the other?</li>
<li>Does natural gas price (HH) significantly affect natural gas power generation? And does it exhibit different elasticities in winter and summer?</li>
<li>Do changes in fossil fuel prices “squeeze out” or “promote” renewable energy generation (such as solar/wind)?</li>
<li>Is there a spillover effect in returns and volatility between clean energy ETFs (ICLE/ICLN) and traditional energy ETFs (XLE)? 8. Do clean energy ETFs (ICLE/ICLN) exhibit significant volatility clustering (GARCH characteristics)? Are their risk levels higher than those of traditional energy ETFs?</li>
<li>Are there substitution relationships within multi-energy systems (wind/solar/coal/gas/nuclear/hydro)? For example, will wind and solar power displace coal gas?</li>
<li>How do exogenous shocks in the energy market (surges in oil prices, abnormal temperatures) propagate among different energy sources through the VAR system?</li>
</ol>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-bp2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">BP. <em>Statistical review of world energy 2023</em>. <a href="https://www.bp.com">https://www.bp.com</a> (2023).</div>
</div>
<div id="ref-iea2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Agency, I. E. <em>World energy outlook 2022</em>. <a href="https://www.iea.org">https://www.iea.org</a> (2022).</div>
</div>
<div id="ref-aklin2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Aklin, M. &amp; Urpelainen, J. <em>Renewables: The politics of a global energy transition</em>. (MIT Press, 2018).</div>
</div>
<div id="ref-bnef2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">BloombergNEF. <em>Energy transition investment trends 2023</em>. <a href="https://about.bnef.com">https://about.bnef.com</a> (2023).</div>
</div>
<div id="ref-gilbert2016" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Gilbert, A. &amp; James, T. Solar resource variability and electricity generation implications. <em>Renewable Energy</em> <strong>95</strong>, 72–84 (2016).</div>
</div>
<div id="ref-pryor2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Pryor, S. C. &amp; Barthelmie, R. J. Climate change impacts on wind energy. <em>Nature Reviews Earth &amp; Environment</em> <strong>1</strong>, 627–643 (2020).</div>
</div>
<div id="ref-eia2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Administration, U. S. E. I. <em>Short-term energy outlook</em>. <a href="https://www.eia.gov/outlooks/steo/">https://www.eia.gov/outlooks/steo/</a> (2021).</div>
</div>
<div id="ref-hamilton2009" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Hamilton, J. D. Causes and consequences of the oil shock of 2007–08. <em>Brookings Papers on Economic Activity</em> 215–261 (2009).</div>
</div>
<div id="ref-bachmeier2006" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Bachmeier, L. J. &amp; Griffin, J. M. Testing for market integration: Crude oil, coal, and natural gas. <em>The Energy Journal</em> <strong>27</strong>, 55–71 (2006).</div>
</div>
<div id="ref-kilian2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Kilian, L. Oil price shocks: Causes and consequences. <em>Annual Review of Resource Economics</em> <strong>6</strong>, 133–154 (2014).</div>
</div>
<div id="ref-narayan2010" class="csl-entry" role="listitem">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Narayan, P. K. &amp; Narayan, S. Modelling the impact of oil prices on the stock returns of clean energy and technology companies. <em>Energy Policy</em> <strong>38</strong>, 6617–6622 (2010).</div>
</div>
<div id="ref-diebold2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Diebold, F. X. &amp; Yilmaz, K. On the network topology of variance decompositions: Measuring the connectedness of financial firms. <em>Journal of Econometrics</em> <strong>182</strong>, 119–134 (2014).</div>
</div>
<div id="ref-henriques2008" class="csl-entry" role="listitem">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Henriques, I. &amp; Sadorsky, P. Oil prices and the stock prices of alternative energy companies. <em>Energy Economics</em> <strong>30</strong>, 998–1010 (2008).</div>
</div>
<div id="ref-sadorsky2012" class="csl-entry" role="listitem">
<div class="csl-left-margin">14. </div><div class="csl-right-inline">Sadorsky, P. Modelling renewable energy company risk: A GARCH approach. <em>Energy Policy</em> <strong>40</strong>, 71–82 (2012).</div>
</div>
<div id="ref-pham2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">15. </div><div class="csl-right-inline">Pham, L. The transition of renewable energy stocks from policy-driven to market-driven. <em>Journal of Sustainable Finance &amp; Investment</em> <strong>9</strong>, 235–252 (2019).</div>
</div>
<div id="ref-newbery2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">16. </div><div class="csl-right-inline">Newbery, D. The energy transition in europe: Overview of the markets, economics, and policies. <em>Energy Policy</em> <strong>123</strong>, 226–234 (2018).</div>
</div>
<div id="ref-stern2012" class="csl-entry" role="listitem">
<div class="csl-left-margin">17. </div><div class="csl-right-inline">Stern, J. The role of natural gas in supporting renewable energy. <em>Oxford Institute for Energy Studies Working Paper</em> (2012).</div>
</div>
<div id="ref-marques2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">18. </div><div class="csl-right-inline">Marques, A. &amp; Fuinhas, J. Energy transition and the dynamics of renewable and fossil power. <em>Energy</em> <strong>202</strong>, 117–135 (2020).</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>